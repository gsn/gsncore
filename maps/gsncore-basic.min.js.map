{"version":3,"sources":["gsncore-basic.js"],"names":["loadSingleScript","uri","callbackFunc","maybeDone","tag","readyState","indexOf","root","location","protocol","replace","document","createElement","type","src","onload","onreadystatechange","body","appendChild","this","previousGsn","gsn","breaker","ArrayProto","Array","prototype","ObjProto","Object","slice","hasOwnProperty","nativeForEach","forEach","nativeMap","map","nativeSome","some","nativeIndexOf","nativeKeys","keys","obj","_wrapped","exports","module","config","AuthServiceUrl","StoreServiceUrl","ProfileServiceUrl","ShoppingListServiceUrl","ApiUrl","Version","Date","getTime","EmailRegex","ServiceUnavailableMessage","UseLocalStorage","ContentBaseUrl","ChainId","ChainName","GoogleAnalyticAccountId1","RegistrationFromEmailAddress","RegistrationEmailLogo","FacebookAppId","FacebookPermission","Theme","HomePage","StoreList","AllContent","hasStoreCoupon","hasInit","isPrerender","test","navigator","userAgent","identity","value","browser","isIE","ua","msie","trident","parseInt","substring","rv","detectIe","isMobile","isAndroid","isIOS","each","iterator","context","isNull","length","i","call","j","length2","collect","results","index","list","push","extend","arguments","source","v","k","any","predicate","result","contains","include","target","applyConfig","dontUseProxy","parsePartialContentData","siteMenu","SiteMenu","JSON","parse","Position","SubMenu","v2","k2","useProxy","parseFloat","defaultValue","isNaN","sortOn","collection","name","sort","a","b","toLowerCase","cleanKeyword","keyword","groupBy","attribute","postProcessFunction","groups","grouper","item","groupKey","group","key","items","myGroup","$idx","mapObject","e","toString","TypeError","has","del","undefined","getUrl","baseUrl","url","getContentUrl","getThemeUrl","SiteTheme","getContentServiceUrl","getApiUrl","getMetaUrl","meta","metaType","encodeURIComponent","setTheme","theme","goUrl","initAnalytics","$analyticsProvider","settings","trackRelativePath","firstTracker","ga","registerPageTrack","path","registerEventTrack","action","properties","parsed","category","label","nonInteraction","init","$locationProvider","$sceDelegateProvider","$sceProvider","$httpProvider","FacebookProvider","initAngular","globalConfig","data","port","enabled","resourceUrlWhitelist","SceWhiteList","html5Mode","hashPrefix","interceptors","defaults","useXDomain","headers","common","FastClick","attach","facebookVersion","appId","xfbml","version","apiUrl","loadScripts","uris","toProcess","concat","processNext","splice","loadIframe","parentEl","html","iframe","contentWindow","contents","doc","contentDocument","open","write","close","ConfigData","ContentData","ContentList","configData","contentData","Contents","IsMetaData","contentList","angular","provider","$get","serviceId","mygsncore","run","$rootScope","gsnGlobal","gsnApi","$window","myHtml","element","append","getConfig","win","service","$timeout","$q","$http","$location","$localStorage","$sce","setAnonymousToken","token","tk","returnObj","anonymousToken","getAccessToken","profileStorage","accessToken","getAccessTokenPayload","accessTokenData","expires_dt","payload","grant_type","client_id","getChainId","access_type","refresh_token","setAccessToken","profileId","user_id","$broadcast","getAnonymousToken","previousDefer","$api","trustAsResourceUrl","getStoreUrl","method","getSelectedStoreId","contentStart","getDefaultLayout","defaultUrl","DefaultLayout","getShoppingListApiUrl","getProfileApiUrl","getUseLocalStorage","getVersion","isBetween","min","max","getFacebookPermission","getGoogleAnalyticAccountId1","getEmailRegEx","getServiceUnavailableMessage","getChainName","getHomeData","getRegistrationFromEmailAddress","getRegistrationEmailLogo","htmlFind","find","equalsIgnoreCase","val1","val2","lowercase","params","s","modal","top","reload","clearSelection","selected","getBindableItem","newItem","copy","NewQuantity","Quantity","gsnProfile","shoppingList","getShoppingList","getItem","updateBindableItem","ItemId","OldQuantity","syncItem","decodeServerUrl","decodeURIComponent","parseStoreSpecificContent","contentDataResult","possibleResult","myContentData","allStoreCount","storeId","Id","storeIds","StoreIds","Description","v1","k1","maxStoreIdCount","getThemeContent","contentPosition","getThemeConfig","getThemeConfigDescription","resultObj","getFullPath","includePort","normalizedPath","host","getPageCount","pageSize","Math","ceil","setSelectedStoreId","newUrl","timeout","storeIdInt","previousStoreId","newValue","oldValue","getProfileId","getShoppingListId","shoppingListId","setShoppingListId","dontBroadcast","getApiHeaders","X-SITE-ID","X-STORE-ID","X-PROFILE-ID","X-ACCESS-TOKEN","access_token","Content-Type","isAnonymous","isLoggedIn","getUserId","loadImage","cb","container","img","hasSize","imagePath","onHasSize","im","w","naturalWidth","width","h","naturalHeight","height","remove","checkSize","complete","on","attr","appendTo","logOut","previousProfileId","ProfileId","doAuthenticate","username","post","X-SHOPPING-LIST-ID","success","response","expires_in","defer","resolve","error","ExceptionMessage","deferred","accessTokenPayload","promise","http","cacheObject","successHandler","errorHandler","then","get","httpGetOrPostWithCache","isValidCaptcha","challenge","rsp","goBack","history","back","initApp","appState","layoutConfig","layout","defaultLayout","onevent","fn","$on","evt","args","bindMapEvents","scope","eventsStr","googleObject","split","eventName","window","google","maps","event","addListener","triggerHandler","$$phase","$apply","mapOverlayDirective","directiveName","events","app","directive","restrict","link","elm","attrs","$watch","newObject","uiMapConfig","$parse","mapEvents","options","activate","gmap","uiOptions","opts","$eval","Map","uiMap","assign","uiMapInfoWindowConfig","$compile","infoWindowEvents","content","model","uiMapInfoWindow","infoWindow","InfoWindow","replaceWith","_open","a1","a2","a3","a4","a5","a6","$log","callback","loadingScript","create","conf","loadRecaptcha","Recaptcha","should_focus","get_response","get_challenge","destroy","vcRecaptchaService","require","ctrl","response_input","challenge_input","refresh","$setViewValue","val","inputs","bind","$render","$viewValue","tabindex","lang","filter","input","conditional","defaultOrFalseValue","localCondition","currentPage","tel","format","regex","RegExp","text","flag","patt","wordwise","tail","substr","lastspace","lastIndexOf","trustAsHtml","escape","unescape","debounce","gsnStore","shoppingListItemChange","currentListId","ShoppingListId","cat","getCategories","CategoryId","bricktag","addDept","CategoryName","doRefresh","forceRefresh","actionParam","gvm","adsCollapsed","detail","RecipeId","product","ItemTypeId","BrandName","AdCode","addItem","linkData","Url","Target","allItems","categories","idx","newKw","next","currentPath","getProfile","p","setDefault","page","storeid","consumerid","isanon","loyaltyid","ExternalId","evtname","minSecondBetweenRefresh","$route","Facebook","$analytics","gsnAdvertising","$anchorScroll","initProfile","$scope","gsnModalTracking","el","track","actionName","eventTrack","timedload","initialize","currentLayout","notFoundDefaultLayout","notFoundLayout","loginCounter","menuInactive","shoppingListActive","profile","noCircular","reloadOnStoreSelection","currentStore","search","site","facebookReady","currentYear","getFullYear","facebookData","hasJustLoggedIn","loggedInWithFacebook","broadcastEvent","isOnList","getShoppingListCount","$win","seo","newDate","dateArg1","validateRegistration","authResponse","api","user","email","loginFacebook","doFacebookLogin","getLoginStatus","status","login","doIfLoggedIn","doSiteSearch","doItemSearch","logout","logoutWithPrompt","goOutPrompt","logoutWithPromt","goOutPromt","print","setTimeout","getTitle","getSharePath","query","doToggleCartItem","linkedItem","SalePriceMultiple","PriceMultiple","removeItem","Varieties","selectedItem","current","gmodal","hide","hash","href","nxt","routes","friendlyPath","requireLogin","preventDefault","storeRequired","rst","getStore","store","StoreName","StoreNumber","PrimaryStoreId","StoreId","selectStore","isReady","newVal","ExtCategory","coupon","getCoupon","ProductCode","factory","$sessionStorage","betterStorage","processServerItem","serverItem","localItem","getItemKey","Order","$mySavedData","saveListToSession","currentShoppingList","countCache","processShoppingList","hasLoaded","itemIdentity","itemKey","itemToSync","existingItem","itemToPost","BarcodeImageUrl","BottomTagLine","Description1","Description2","Description3","Description4","EndDate","ImageUrl","SmallImageUrl","StartDate","TopTagLine","TotalDownloads","TotalDownloadsAllowed","PageNumber","rect","LinkedItem","hPayload","deferSync","ShoppingListItemId","newQuantity","existingQuantity","IsCoupon","tmpQuantity","addItems","toAdd","inputItem","deferRemove","removeK","itemId","itemTypeId","adCode","brandName","myDescription","myItemKey","isValidItem","itemType","getCount","count","isValid","updateShoppingList","clearItems","saveChanges","Title","getStatus","StatusId","deleteList","savingDeferred","syncitems","setTitle","title","getListData","loadListFromSession","myModule","alert","message","isPhoneGap","notification","show","hideOn","confirm","callbackFn","buttonLabels","prompt","defaultText","answer","buttonIndex","input1","func","wait","immediate","callNow","clearTimeout","apply","parseFeed","maxResult","jsonp","responseError","code","reject","template","elem","update","markers","is","bsDisplayMode","className","stopPropagation","off","ev","scrollTo","countScrollTop","myScrollTop","scrollTop","css","display","offset","stopEvent","gsnList","gsnLoadProfile","$savedData","$profileDefer","registerOrUpdateProfile","isUpdate","Email","UserName","Password","ReceiveEmail","ReceivePostalMail","ReceiveSms","Phone","FirstName","LastName","WelcomeSubject","WelcomeMessage","FacebookUserId","SiteId","FacebookToken","$creatingDefer","allShoppingLists","$profile","createNewShoppingList","pass","password","facebookToken","refreshShoppingLists","slItem","deleteShoppingList","getShoppingLists","reverse","callApi","registerProfile","changePassword","userName","currentPassword","newPassword","NewPassword","recoverPassword","recoverUsername","unsubscribeEmail","updateProfile","refreshingDeferred","getMyRecipes","rateRecipe","recipeId","rating","getMyRecipe","saveRecipe","comment","sendContactUs","sendEmail","sendEmploymentEmail","selectedStoreId","mySavedData","zPriceMultiple","d","values","currentList","createStorage","storageType","currentStorage","_debounce","webStorage","supported","round","random","localStorage","setItem","err","isStorageSupported","warn","fallbackStorage","$storage","$default","isDefined","$reset","storageKey","fromJson","equals","toJson","addEventListener","parseStoreList","storeList","isRaw","stores","Settings","StoreSettings","selectFirstStore","sfs","selectfirststore","storeByNumber","storeById","storenbr","processInstoreCoupon","circular","getCircularData","InstoreCoupons","_lc","_cp","categoryById","storeCouponById","instoreCoupons","processCoupon","processCircularData","circularData","CircularTypes","circularLastUpdate","processingQueue","lastProcessDate","getDate","Departments","circularTypes","circularByTypes","staticCirculars","circulars","Circularz","Circulars","circ","CircularTypeName","CircularTypeId","Name","Pagez","Pages","pages","processCircular","CircularType","itemsById","circularByTypeId","staticCircularById","processWorkQueue","shift","processCompleted","itemCount","circularMaster","CircularPageId","Items","Circular","processCircularPage","x","y","pos","AreaCoordinates","temp","xx","yy","cx","cy","$store","previousGetStore","quickSearchItems","topRecipes","faAskTheChef","faCookingTip","faArticle","faRecipe","faVideo","mealPlanners","states","adPods","specialAttributes","allVideos","getCircular","circularTypeId","refreshCircular","circularIsLoading","searchRecipes","searchTerm","getAvailableVarieties","circularItemId","getQuickSearchItems","getStores","id","getAskTheChef","getFeaturedArticle","getFeaturedVideo","getRecipeVideos","getCookingTip","getTopRecipes","getFeaturedRecipe","couponId","getStates","getInstoreCoupons","getRecipe","getPartial","contentName","today","nocache","getMonth","getHours","getArticle","articleId","getMealPlannerRecipes","hasCompleteCircular","getProcessDate","forProcessing","isApi","rawStoreList","hasNewStoreId","requireRefresh","seconds","myDirectiveName","controller","isFacebook","profileUpdated","hasSubmitted","isValidSubmit","isSubmitting","profileStatus","disableNavigation","myForm","$valid","$filter","vm","digitalCirc","defaultMobileListView","mobileListViewUrl","filteredByStoreCircs","myPageIdx","pg","myCircIdx","c","doSearchInternal","circIdx","pageIdx","sortMe","setPage","pageCount","sorted","circularIndex","pageIndex","CircularDescription","loadMore","cacheItems","itemsToLoad","itemsPerPage","loadAll","last","pageId","sortBy","sortByName","actualSortBy","loadCount","filterBy","q","IsDummyCircular","doAddCircularItem","tempItem","doToggleCircularItem","toggleSort","getIndex","step","newIndex","LinkedItemCount","circularType","result1","brands","$interpolate","storesById","masterVm","doReset","topics","Value","Text","ParentOption","topicsByValue","parentTopics","errorResponse","contactSuccess","captcha","getSubTopics","Topic","getFullStateName","LinkState","FullName","getStoreDisplayName","PrimaryAddress","doSubmit","myContactUsForm","hasReceiveEmail","CaptchaChallenge","CaptchaResponse","Store","EmailMessage","ConfirmEmail","CopyrightYear","FromEmail","Message","EmailFrom","emailShoppingList","fromUrl","processData","partialData","contentNames","contentDetail","subName","notFound","getContentList","Headline","SortBy","getContent","getConfigDescription","doInitializeForSavedLists","listviewList","selectedShoppingListId","hasInitializePrinter","lists","startNewList","previousList","deleteCurrentList","getSelectedShoppingListId","canDeleteList","setSelectedShoppingListId","createDirective","_i","_len","_ref","loadPlugin","FB","XFBML","parent","$templateCache","templateHtml","tileId","gsnAdUnit","templateUrl","cache","addClass","elId","attributes","gsnAddHead","myAttrs","ngModel","slides","selectIndex","blur","wasRunning","isPlaying","stop","focus","play","doIncrement","slideIndex","inc","cancelRefresh","interval","$slideIndex","cancel","prev","currentSlide","currentIndex","addSlide","slide","removeSlide","reverseIndex","checkValue","gsnDigitalCirc","onItemSelect","plug","onCircularDisplaying","plugin","dynamic","dynamicData","Images","RecipeImageUrl","Thumbnail","gsnFtConfig","overwrite","myUpdateWith","offsetWidth","$routeParams","videoTitle","videoName","flowplayer","gsnFlowPlayer","swf","clip","autoPlay","autoBuffering","featuredVideo","click","ratio","style","paddingTop","video","gsnFluidVids","gsnFrame","templateLoader","setAttribute","doDisplay","ppos","getBoundingClientRect","gsnHoverSync","left","removeClass","continousMonitor","gsnHtmlCapture","$element","$attrs","$emit","hideCallback","endTime","property","startTime","hideCb","tplURL","timeoutOfOpen","gsnModal","closeModal","shouldReload","openModal","forceShow","isVisible","$modalElement","cls","closeCls","disableScrollTop","hideModal","showModal","showIf","eventToClose","modelCtrl","$parsers","inputValue","transformedInput","partialContents","pcvm","gsnPartialContent","hasScript","isLoading","tab","hidePopup","slideUp","selector","popover","myHidePopup","mousemove","clientY","clientX","mouseleave","qtip","classes","solo","distance","position","at","setProfileData","gsnProfileInfo","compiledTemplate","hasMobileApp","downloadApp","rejectApp","FeedService","gsnRssFeed","res","responseData","feed","handleShoppingListEvent","mylist","gsnShoppingList","reloadShoppingList","coupons","circularCoupons","addString","pluginItemCount","topitems","totalQuantity","currentDate","shoppinglistsaved","shoppinglistdeleted","shoppinglistcreated","doMassageList","doRefreshList","newTitle","Meta","quantity","prePriceText","description","PriceString","priceText","postPriceText","imageUrl","validFrom","validTo","circCoupon","CouponImageUrl","ItemDescription","Price","toFixed","zIndex","newAllItems","fitems","listSearch","doUpdateQuantity","doAddSelected","doDeleteList","doAddOwnItem","doSaveList","doSelectAll","doItemRemove","doItemAddToCurrentList","anchor","before","bottom","myCheckSticky","screenHeight","anchorTop","elementHeight","isStuck","reloadOnChange","setStoreData","gsnStoreInfo","doLoadImage","gsnSvgImage","svg","setAttributeNS","syncHeight","resizer","actualWidth","newHeight","reAdjust","activeItem","myLoadImage","watch","gsnTextCapture","toId","$setValidity","gsnValidUser","$$timeoutId","$error","modelVal","gsnWatch","ngModifyElementDirective","opt","parentModifierWasEnabled","modifierName","parentModifier","isEnabled","currentModifier","originalValue","currentValue","$observe","set","$that","iw","ih","setPlaceholder","removePlaceholder","copyAttrs","fakePassword","cssClass","excludedAttrs","placeholderText","placeholder","isPassword","$attr","attrName","insertBefore","hasClass","select","trigger","loadDeferred","flags","sdk","ready","setAppId","getAppId","locale","setLocale","getLocale","setStatus","channelUrl","setChannel","channel","getChannel","cookie","setCookie","getCookie","setXfbml","enable","getXfbml","setAuthResponse","getAuthResponse","frictionlessRequests","setFrictionlessRequests","getFrictionlessRequests","hideFlashCallback","setHideFlashCallback","getHideFlashCallback","setInitCustomOption","isString","getInitOption","loadSDK","setLoadSDK","getLoadSDK","initSettings","_loadSDK","isObject","NgFacebook","userFn","userFnIndex","arg","isFunction","isNumber","isUndefined","parseXFBML","subscribe","Event","unsubscribe","fbAsyncInit","auth.login","auth.logout","auth.prompt","auth.sessionChange","auth.statusChange","auth.authResponseChange","xfbml.render","edge.create","edge.remove","comment.create","comment.remove","mapped","fbroot","getElementById","childNodes","script","async","getElementsByTagName","angulartics","waitForVendorCount","waitForVendorApi","f","pageTracking","autoTrackFirstPage","autoTrackVirtualPages","autoBasePath","basePath","eventTracking","bufferFlushDelay","developerMode","g","virtualPageviews","firstPageview","withBase","withAutoBase","l","m","toUpperCase","invoke","pathname","pageTrack","absUrl","$$route","redirectTo","tagName","innerText","analyticsOn","analyticsEvent","eventType","analyticsIf","analyticsProperties","dataLayer","content-name","target-properties","interaction-type","noninteraction","$documentProvider","$document","validateType","clickyApi","log","goalId","revenue","noQueue","goal","validateNumber","number","isFinite","clicky","layer","oldOnClick","trackingClick","trackingClickStart","targetElement","touchStartX","touchStartY","lastTouchIdentifier","touchBoundary","tapDelay","tapTimeout","notNeeded","methods","deviceIsAndroid","onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","stopImmediatePropagation","removeEventListener","capture","rmv","Node","hijacked","adv","propagationStopped","onclick","deviceIsWindowsPhone","deviceIsIOS","deviceIsIOS4","deviceIsIOSWithBadTarget","deviceIsBlackBerry10","needsClick","nodeName","disabled","needsFocus","readOnly","sendClick","clickEvent","touch","activeElement","changedTouches","createEvent","initMouseEvent","determineEventType","screenX","screenY","forwardedTouchEvent","dispatchEvent","setSelectionRange","updateScrollParent","scrollParent","parentElement","fastClickScrollParent","scrollHeight","offsetHeight","fastClickLastScrollTop","getTargetElementFromEventTarget","eventTarget","nodeType","TEXT_NODE","parentNode","selection","targetTouches","getSelection","rangeCount","isCollapsed","identifier","timeStamp","pageX","pageY","lastClickTime","touchHasMoved","boundary","abs","findControl","labelElement","control","htmlFor","querySelector","forElement","targetTagName","cancelNextClick","elementFromPoint","pageXOffset","pageYOffset","cancelable","permitted","metaViewport","chromeVersion","blackberryVersion","ontouchstart","exec","documentElement","scrollWidth","outerWidth","match","msTouchAction","touchAction","define","amd","t","n","r","u","o","cached","latencyThreshold","request","ignoreLoadingBar","start","includeSpinner","includeBar","parentSelector","eq","enter","leave","mod","infiniteScrollDistance","infiniteScrollDisabled","infiniteScroll","infiniteScrollImmediateCheck","uiEvent","$event","$params","isArray","join","terminal","compile","uiInclude","fragment","autoscroll","$destroy","$new","uiIndeterminate","indeterminate","noop","humanize","underscore","variable","uiJq","Error","uiRefresh","8","9","13","27","32","33","34","35","36","37","38","39","40","45","46","charAt","expression","metaKey","ctrlKey","altKey","shiftKey","keyCode","alt","maskDefinitions","A","*","priority","N","P","removeAttr","Q","$modelValue","G","K","H","J","I","maxlength","B","D","O","unbind","F","C","E","R","pop","L","M","which","z","selectionStart","createRange","moveStart","createTextRange","collapse","moveEnd","selectionEnd","$formatters","required","Number","floor","wrap","after","uiReset","uiRoute","ngHref","routeModel","registerFor","setInterval","getComputedStyle","currentStyle","runtimeStyle","pixelLeft","base","padding","border","margin","outer","outerfull","prepend","outerHTML","outerHeight","ownerDocument","defaultView","parentWindow","clientTop","scrollLeft","clientLeft","jQuery","transclude","S","T","ngScroll","bufferSize","localName","overflow-y","paddingHeight","insert","viewport","topPadding","bottomPadding","bottomDataPos","topDataPos","loading","$index","unshift","appended","wrapper","revision","compatMode","uiScrollfix","offsetTop","uiShow","uiHide","uiToggle","uiValidate","validator","$value","uiValidateWatch"],"mappings":"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","file":"../gsncore-basic.min.js","sourcesContent":["/*!\n * gsncore\n * version 1.11.1\n * gsncore repository\n * Build date: Tue Aug 15 2017 00:33:04 GMT-0500 (CDT)\n */\n(function() {\n  'use strict';\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `exports` on the server.\n  var root = this;\n\n  // Save the previous value of the `gsn` variable.\n  var previousGsn = root.gsn;\n\n  // Establish the object that gets returned to break out of a loop iteration.\n  var breaker = {};\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype,\n    ObjProto = Object.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var slice = ArrayProto.slice,\n    hasOwnProperty = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var nativeForEach = ArrayProto.forEach,\n    nativeMap = ArrayProto.map,\n    nativeSome = ArrayProto.some,\n    nativeIndexOf = ArrayProto.indexOf,\n    nativeKeys = Object.keys;\n\n  /* jshint -W055 */\n  // Create a safe reference to the gsn object for use below.\n  var gsn = function(obj) {\n    if (obj instanceof gsn) return obj;\n    if (!(this instanceof gsn)) return new gsn(obj);\n    this._wrapped = obj;\n    return this;\n  };\n\n  // Export the gsn object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = gsn;\n    }\n    exports.gsn = gsn;\n  } else {\n    root.gsn = gsn;\n  }\n  gsn.root = root;\n  gsn.previousGsn = previousGsn;\n\n  // internal config\n  gsn.config = {\n    // url config\n    AuthServiceUrl: '/proxy/auth',\n    StoreServiceUrl: '/proxy/store',\n    ProfileServiceUrl: '/proxy/profile',\n    ShoppingListServiceUrl: '/proxy/shoppinglist',\n    ApiUrl: '',\n\n    // global config\n    Version: new Date().getTime(),\n    EmailRegex: /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,\n    ServiceUnavailableMessage: 'We are unable to process your request at this time.',\n\n    // true to make use of localStorage for better caching of user info across session, useful in a phonegap or mobile site app\n    UseLocalStorage: false,\n\n    // chain specific config\n    ContentBaseUrl: '/asset',\n\n    ChainId: 0,\n    ChainName: 'Brick, Inc.',\n    GoogleAnalyticAccountId1: null,\n    RegistrationFromEmailAddress: 'tech@grocerywebsites.com',\n    RegistrationEmailLogo: null,\n    FacebookAppId: null,\n    FacebookPermission: null,\n    Theme: null,\n    HomePage: null,\n    StoreList: null,\n    AllContent: null,\n    hasStoreCoupon: false,\n    hasInit: false,\n    isPrerender: /Prerender/.test(root.navigator.userAgent)\n  };\n\n  gsn.identity = function(value) {\n    return value;\n  };\n\n  gsn.userAgent = root.navigator.userAgent;\n\n  function detectIe() {\n    var ua = gsn.userAgent;\n    var msie = ua.indexOf('MSIE ');\n    var trident = ua.indexOf('Trident/');\n\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n\n    if (trident > 0) {\n      // IE 11 (or newer) => return version number\n      var rv = ua.indexOf('rv:');\n      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n\n    // other browser\n    return false;\n  };\n\n  gsn.browser = {\n    isIE: detectIe(),\n    userAgent: gsn.userAgent,\n    isMobile: /iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/gi.test(gsn.userAgent),\n    isAndroid: /(android)/gi.test(gsn.userAgent),\n    isIOS: /iP(hone|od|ad)/gi.test(gsn.userAgent)\n  };\n  //#region Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n  // Delegates to **ECMAScript 5**'s native `forEach` if available.\n  var each = gsn.each = gsn.forEach = function(obj, iterator, context) {\n    if (gsn.isNull(obj, null) === null) return;\n    if (nativeForEach && obj.forEach === nativeForEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n      for (var i = 0, length = obj.length; i < length; i++) {\n        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n      }\n    } else {\n      var keys = gsn.keys(obj);\n      for (var j = 0, length2 = keys.length; j < length2; j++) {\n        if (iterator.call(context, obj[keys[j]], keys[j], obj) === breaker) return;\n      }\n    }\n  };\n\n  // Return the results of applying the iterator to each element.\n  // Delegates to **ECMAScript 5**'s native `map` if available.\n  gsn.map = gsn.collect = function(obj, iterator, context) {\n    var results = [];\n    if (gsn.isNull(obj, null) === null) return results;\n    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n    each(obj, function(value, index, list) {\n      results.push(iterator.call(context, value, index, list));\n    });\n    return results;\n  };\n  //#endregion\n\n  //#region methods\n  // --------------------\n  // Extend a given object with all the properties in passed-in object(s).\n  // gsn.extend(destination, *source);\n  gsn.extend = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (typeof(source) !== 'undefined') {\n        gsn.forEach(source, function(v, k) {\n          if (gsn.isNull(v, null) !== null) {\n            obj[k] = v;\n          }\n        });\n      }\n    });\n    return obj;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Delegates to **ECMAScript 5**'s native `some` if available.\n  // Aliased as `any`.\n  var any = gsn.some = gsn.any = function(obj, predicate, context) {\n    predicate = predicate || gsn.identity;\n    var result = false;\n    if (gsn.isNull(obj, null) === null) return result;\n    if (nativeSome && obj.some === nativeSome) return obj.some(predicate, context);\n    each(obj, function(value, index, list) {\n      if (result || (result = predicate.call(context, value, index, list))) return breaker;\n      return null;\n    });\n    return !!result;\n  };\n\n  // Determine if the array or object contains a given value (using `===`).\n  // Aliased as `include`.\n  gsn.contains = gsn.include = function(obj, target) {\n    if (gsn.isNull(obj, null) === null) return false;\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) !== -1;\n    return any(obj, function(value) {\n      return value === target;\n    });\n  };\n\n  // extend the current config\n  gsn.applyConfig = function(config, dontUseProxy) {\n    if (!gsn.config.hasInit) {\n      gsn.config.hasInit = true;\n      gsn.extend(gsn.config, config);\n      gsn.config.HomePage = gsn.parsePartialContentData(gsn.config.HomePage);\n      var siteMenu = gsn.config.SiteMenu || '';\n      if (typeof(siteMenu) === 'string') {\n        gsn.config.SiteMenu = siteMenu.length > 10 ? JSON.parse(siteMenu) : [];\n        gsn.forEach(gsn.config.SiteMenu, function(v, k) {\n          v.Position = parseInt(v.Position);\n          gsn.forEach(v.SubMenu, function(v2, k2) {\n            v2.Position = parseInt(v2.Position);\n          });\n        });\n      }\n    }\n\n    // determine if proxy should be replace with direct url to api\n    var useProxy = !gsn.isNull(dontUseProxy, gsn.config.dontUseProxy);\n\n    // use proxy and older android, then it must use proxy\n    if (useProxy && gsn.browser.isAndroid) {\n      var ua = gsn.browser.userAgent;\n      var androidversion = parseFloat(ua.slice(ua.indexOf('Android\"') + 8));\n\n      if (androidversion > 4) {\n        return;\n      }\n\n      useProxy = false;\n    }\n\n    // if not useProxy, replace proxy with valid api url\n    if (!useProxy) {\n      gsn.forEach(gsn.config, function(v, k) {\n        if (typeof(v) !== 'string' || v === 'ApiUrl') return;\n        if (v.indexOf('/proxy/') >= 0) {\n          gsn.config[k] = v.replace('/proxy/', gsn.config.ApiUrl + '/');\n        }\n      });\n    }\n\n    config.useProxy = useProxy;\n  };\n\n  // return defaultValue if null\n  gsn.isNull = function(obj, defaultValue) {\n    return (typeof(obj) === 'undefined' || obj === null) ? defaultValue : obj;\n  };\n\n  // return defaultValue if NaN\n  gsn.isNaN = function(obj, defaultValue) {\n    return (isNaN(obj)) ? defaultValue : obj;\n  };\n\n  // sort a collection base on a field name\n  gsn.sortOn = function(collection, name) {\n    if (gsn.isNull(collection, null) === null) return null;\n    if (collection.length <= 0) return [];\n\n    // detect attribute type, problem is if your first object is null or not string then this breaks\n    if (typeof(collection[0][name]) === 'string') {\n      collection.sort(function(a, b) {\n        if ((a[name] && a[name].toLowerCase()) < (b[name] && b[name].toLowerCase())) return -1;\n        if ((a[name] && a[name].toLowerCase()) > (b[name] && b[name].toLowerCase())) return 1;\n        return 0;\n      });\n    } else {\n      collection.sort(function(a, b) {\n        if (a[name] < b[name]) return -1;\n        if (a[name] > b[name]) return 1;\n        return 0;\n      });\n    }\n\n    return collection;\n  };\n\n  // clean keyword - for support of sending keyword to google dfp\n  gsn.cleanKeyword = function(keyword) {\n    var result = keyword.replace(/[^a-zA-Z0-9]+/gi, '_').replace(/^[_]+/gi, '');\n    if (gsn.isNull(result.toLowerCase, null) !== null) {\n      result = result.toLowerCase();\n    }\n    return result;\n  };\n\n  // group a list by a field name/attribute and execute post process function\n  gsn.groupBy = function(list, attribute, postProcessFunction) {\n    if (gsn.isNull(list, null) === null) return [];\n\n    // First, reset declare result.\n    var groups = [];\n    var grouper = {};\n\n    // this make sure all elements are correctly sorted\n    gsn.forEach(list, function(item) {\n      var groupKey = item[attribute];\n      var group = grouper[groupKey];\n      if (gsn.isNull(group, null) === null) {\n        group = {\n          key: groupKey,\n          items: []\n        };\n        grouper[groupKey] = group;\n      }\n      group.items.push(item);\n    });\n\n    // finally, sort on group\n    var i = 0;\n    gsn.forEach(grouper, function(myGroup) {\n      myGroup.$idx = i++;\n      groups.push(myGroup);\n\n      if (postProcessFunction) postProcessFunction(myGroup);\n    });\n\n    return gsn.sortOn(groups, 'key');\n  };\n\n  // map a list to object, todo: there is this better array map some where\n  gsn.mapObject = function(list, attribute) {\n    var obj = {};\n    if (list) {\n      if (gsn.isNull(list.length, -1) < 0) {\n        obj[list[attribute]] = list;\n      } else {\n        gsn.map(list, function(item, i) {\n          var k = item[attribute];\n          var e = obj[k];\n          if (e) {\n            if (Object.prototype.toString.call(e) !== '[object Array]') {\n              e = [e];\n            }\n            e.push(item);\n          } else {\n            e = item;\n          }\n          obj[k] = e;\n        });\n      }\n    }\n    return obj;\n  };\n\n  // Retrieve the names of an object's properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  gsn.keys = nativeKeys || function(obj) {\n    if (obj !== Object(obj))\n      throw new TypeError('Invalid object');\n    var keys = [];\n    for (var key in obj)\n      if (gsn.has(obj, key)) keys.push(key);\n    return keys;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  gsn.has = function(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  // allow for IE compatible delete\n  gsn.del = function(obj, key) {\n    obj[key] = undefined;\n    try {\n      delete obj[key];\n    } catch (e) {\n      var items = {};\n      gsn.each(obj, function(v, k) {\n        if (k !== key)\n          items[k] = v;\n      });\n\n      return items;\n    }\n    return obj;\n  };\n\n  gsn.getUrl = function(baseUrl, url) {\n    url = gsn.isNull(url, '');\n    var data = ((url.indexOf('?') > 0) ? '&' : '?') + 'nocache=' + gsn.config.Version;\n    return (baseUrl + url + data).replace(/(\\\\\\\\)+/gi, '\\\\');\n  };\n\n  // get the content url\n  gsn.getContentUrl = function(url) {\n    return gsn.getUrl(gsn.config.ContentBaseUrl, url);\n  };\n\n  gsn.getThemeUrl = function(url) {\n    var baseUrl = gsn.config.ContentBaseUrl;\n\n    if (gsn.isNull(gsn.config.SiteTheme, '').length > 0) {\n      baseUrl = baseUrl.replace('/' + gsn.config.ChainId, '/' + gsn.config.SiteTheme);\n    }\n\n    return gsn.getUrl(baseUrl, url);\n  };\n\n  gsn.getContentServiceUrl = function(url) {\n    return gsn.getApiUrl() + '/Content' + gsn.isNull(url, '');\n  };\n\n  gsn.getApiUrl = function() {\n    return gsn.config.ApiUrl !== '' ? gsn.config.ApiUrl : '/proxy';\n  };\n\n  gsn.getMetaUrl = function(meta, metaType) {\n    return gsn.getApiUrl() + '/Content/meta/' + gsn.config.ChainId + '/?name=home page&meta=' + encodeURIComponent(meta) + '&type=' + (metaType || 'text/html') + '&nocache=' + gsn.config.Version;\n  };\n\n  gsn.setTheme = function(theme) {\n    gsn.config.SiteTheme = theme;\n  };\n\n  gsn.goUrl = function(url, target) {\n    // do nothing, dummy function to be polyfill later\n  };\n\n  gsn.initAnalytics = function($analyticsProvider) {\n    if (gsn.config.isPrerender) return;\n\n    // GA already supports buffered invocations so we don't need\n    // to wrap these inside angulartics.waitForVendorApi\n    if ($analyticsProvider.settings) {\n      $analyticsProvider.settings.trackRelativePath = true;\n    }\n\n    var firstTracker = (gsn.isNull(gsn.config.GoogleAnalyticAccountId1, '').length > 0);\n\n    if (root.ga) {\n      // creating google analytic object\n      if (firstTracker) {\n        root.ga('create', gsn.config.GoogleAnalyticAccountId1, 'auto');\n\n      }\n\n      // enable demographic\n      root.ga('require', 'displayfeatures');\n    }\n\n    // GA already supports buffered invocations so we don't need\n    // to wrap these inside angulartics.waitForVendorApi\n\n    $analyticsProvider.registerPageTrack(function(path) {\n      // begin tracking\n      if (root.ga) {\n        root.ga('send', 'pageview', path);\n      }\n    });\n\n    /**\n     * Track Event in GA\n     * @name eventTrack\n     *\n     * @param {string} action Required 'action' (string) associated with the event\n     * @param {object} properties Comprised of the mandatory field 'category' (string) and optional  fields 'label' (string), 'value' (integer) and 'noninteraction' (boolean)\n     *\n     * @link https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide#SettingUpEventTracking\n     *\n     * @link https://developers.google.com/analytics/devguides/collection/analyticsjs/events\n     */\n    $analyticsProvider.registerEventTrack(function(action, properties) {\n      // GA requires that eventValue be an integer, see:\n      // https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#eventValue\n      // https://github.com/luisfarzati/angulartics/issues/81\n      if (properties.value) {\n        var parsed = parseInt(properties.value, 10);\n        properties.value = isNaN(parsed) ? 0 : parsed;\n      }\n\n      if (root.ga) {\n        root.ga('send', 'event', properties.category, action, properties.label, properties.value, {\n          nonInteraction: 1\n        });\n      }\n    });\n  };\n\n  gsn.init = function($locationProvider, $sceDelegateProvider, $sceProvider, $httpProvider, FacebookProvider, $analyticsProvider) {\n    gsn.initAngular($sceProvider, $sceDelegateProvider, $locationProvider, $httpProvider, FacebookProvider);\n    gsn.initAnalytics($analyticsProvider);\n  };\n\n  // support angular initialization\n  gsn.initAngular = function($sceProvider, $sceDelegateProvider, $locationProvider, $httpProvider, FacebookProvider) {\n    gsn.applyConfig(root.globalConfig.data || {});\n    gsn.config.ContentBaseUrl = root.location.port > 1000 && root.location.port < 5000 ? '/asset/' + gsn.config.ChainId : gsn.config.ContentBaseUrl;\n    if (gsn.config.Theme) {\n      gsn.setTheme(gsn.config.Theme);\n    }\n\n    //#region security config\n    // For security reason, please do not disable $sce\n    // instead, please use trustHtml filter with data-ng-bind-html for specific trust\n    $sceProvider.enabled(!gsn.browser.isIE && root.location.protocol.indexOf('http') >= 0);\n\n    $sceDelegateProvider.resourceUrlWhitelist(gsn.config.SceWhiteList || [\n      'self',\n      'http://*.gsn2.com/**',\n      'http://*.*.gsn2.com/**',\n      'https://*.gsn2.com/**',\n      'http://*.gsngrocers.com/**',\n      'https://*.gsngrocers.com/**',\n      'http://*.trybrick.com/**',\n      'https://*.trybrick.com/**',\n      'http://*.gsnretailer.com/**',\n      'https://*.gsnretailer.com/**',\n      'http://*.brickinc.net/**',\n      'https://*.brickinc.net/**',\n      'http://localhost:*/**',\n      'file:///**'\n    ]);\n\n\n    //gets rid of the /#/ in the url and allows things like 'bootstrap collapse' to function\n    if (typeof($locationProvider) !== 'undefined') {\n      $locationProvider.html5Mode(true).hashPrefix('!');\n    }\n\n    if (typeof($httpProvider) !== 'undefined') {\n      $httpProvider.interceptors.push('gsnAuthenticationHandler');\n\n      // Enable cross domain calls\n      $httpProvider.defaults.useXDomain = true;\n\n      // Remove the header used to identify ajax call  that would prevent CORS from working\n      $httpProvider.defaults.headers.common['X-Requested-With'] = null;\n    }\n\n    if (typeof(root.FastClick) !== 'undefined') {\n      root.FastClick.attach(document.body);\n    }\n\n    if (typeof(FacebookProvider) !== 'undefined') {\n      if (gsn.config.FacebookAppId) {\n        if (gsn.config.facebookVersion) {\n          FacebookProvider.init({\n            appId: gsn.config.FacebookAppId,\n            xfbml: true,\n            version: gsn.config.facebookVersion\n          });\n        } else {\n          FacebookProvider.init(gsn.config.FacebookAppId);\n        }\n      } else {\n        FacebookProvider.init(gsn.config.FacebookAppId, false);\n      }\n    }\n  };\n  //#endregion\n\n  if (root.globalConfig) {\n    gsn.config.ApiUrl = gsn.isNull(root.globalConfig.apiUrl, '').replace(/\\/+$/g, '');\n    if (gsn.config.ApiUrl === '') {\n      gsn.config.ApiUrl = '/proxy';\n    }\n  }\n\n  //#region dynamic script loader\n  function loadSingleScript(uri, callbackFunc) {\n    if (uri.indexOf('//') < 0) {\n      uri = 'http:' + uri;\n    }\n\n    // Prefix protocol\n    if ((root.location || {}).protocol === 'file') {\n      uri = uri.replace('https://', 'http://');\n    }\n\n    var tag = document.createElement('script');\n    tag.type = 'text/javascript';\n    tag.src = uri;\n\n    function maybeDone() {\n      if (typeof(tag.readyState) === 'undefined' || tag.readyState === 'complete') {\n        // Pull the tags out based on the actual element in case IE ever\n        // intermingles the onload and onreadystatechange handlers for the same\n        // script block before notifying for another one.\n        if (typeof(callbackFunc) === 'function') callbackFunc();\n      }\n    }\n\n    if (callbackFunc) {\n      tag.onload = maybeDone;\n      tag.onreadystatechange = maybeDone; // For IE8-\n    }\n\n    document.body.appendChild(tag);\n  }\n\n  gsn.loadScripts = function(uris, callbackFunc) {\n    if (gsn.isNull(uris.length, 0) <= 0) {\n      if (typeof(callbackFunc) === 'function') {\n        callbackFunc();\n      }\n    } else {\n      if (typeof(uris) === 'string') {\n        uris = [uris];\n      }\n\n      var toProcess = [].concat(uris);\n\n      var processNext = function() {\n        if (toProcess.length <= 0) {\n          if (typeof(callbackFunc) === 'function') {\n            callbackFunc();\n          }\n        } else {\n          var item = toProcess[0];\n          toProcess.splice(0, 1);\n          loadSingleScript(item, processNext);\n        }\n      };\n\n      processNext();\n    }\n  };\n\n  gsn.loadIframe = function(parentEl, html) {\n    var iframe = document.createElement('iframe');\n    parentEl[0].appendChild(iframe);\n\n    /* jshint -W107 */\n    if (iframe.contentWindow) {\n      iframe.contentWindow.contents = html;\n      iframe.src = 'javascript:window[\"contents\"]';\n    } else {\n      var doc = iframe.document;\n      if (iframe.contentDocument)\n        doc = iframe.contentDocument;\n      doc.open();\n      doc.write(html);\n      doc.close();\n    }\n    /* jshint +W107 */\n\n    return iframe;\n  };\n  //#endregion\n\n  gsn.parsePartialContentData = function(data) {\n    if (gsn.isNull(data, null) === null || data === 'null') {\n      data = {\n        ConfigData: {},\n        ContentData: {},\n        ContentList: []\n      };\n    }\n\n    var result = data;\n    if (result.ConfigData) {\n      return result;\n    }\n\n    var configData = [];\n    var contentData = [];\n\n    // parse home config\n    if (result.Contents) {\n      gsn.forEach(result.Contents, function(v, k) {\n        if (v.IsMetaData) configData.push(v);\n        else contentData.push(v);\n      });\n\n      result.Contents = null;\n      result.ConfigData = gsn.mapObject(configData, 'Headline') || {};\n      result.ContentData = gsn.mapObject(contentData, 'SortBy') || {};\n      var contentList = [];\n      for (var i = 0; i < contentData.length; i++) {\n        contentList.push(contentData[i]);\n      }\n\n      if (contentList.length > 0) {\n        result.ContentList = gsn.sortOn(contentList, 'SortBy');\n      }\n    }\n\n    result.ConfigData = result.ConfigData || {};\n    result.ContentData = result.ContentData || {};\n    result.ContentList = result.ContentList || [];\n\n    return result;\n  };\n}).call(this);\n\n(function(gsn, angular, undefined) {\n  'use strict';\n\n  /* fake definition of angular-facebook if there is none */\n  angular.module('facebook', []).provider('Facebook', function test() {\n    return {\n      init: function() {},\n      $get: function() {\n        return {};\n      }\n    };\n  });\n  angular.module('ui.map', []);\n  angular.module('ui.event', []);\n  angular.module('ui.utils', []);\n  angular.module('ui.keypress', []);\n  angular.module('chieffancypants.loadingBar', []);\n\n  var serviceId = 'gsnApi';\n  var mygsncore = angular.module('gsn.core', ['ngRoute', 'ngSanitize', 'facebook', 'angulartics', 'ui.event']);\n\n  mygsncore.config(['$locationProvider', '$sceDelegateProvider', '$sceProvider', '$httpProvider', 'FacebookProvider', '$analyticsProvider',\n      function($locationProvider, $sceDelegateProvider, $sceProvider, $httpProvider, FacebookProvider, $analyticsProvider) {\n        gsn.init($locationProvider, $sceDelegateProvider, $sceProvider, $httpProvider, FacebookProvider, $analyticsProvider);\n      }\n    ])\n    .run(['$rootScope', 'gsnGlobal', 'gsnApi', '$window', function($rootScope, gsnGlobal, gsnApi, $window) {\n      if (gsn.browser.isIE) {\n        var head = angular.element('head');\n        var myHtml = '<!--[if lt IE 10]>\\n' +\n          '<script src=\"https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js\"></script>' +\n          '<script src=\"https://cdnjs.cloudflare.com/ajax/libs/es5-shim/2.2.0/es5-shim.min.js\"></script>' +\n          '<script src=\"https://cdnjs.cloudflare.com/ajax/libs/json2/20130526/json2.min.js\"></script>' +\n          '\\n<![endif]-->';\n        myHtml += '\\n<link href=\"//cdn.brickinc.net/asset/common/styles/print.css\" rel=\"stylesheet\" type=\"text/css\" media=\"print\">';\n        head.append(myHtml);\n      }\n\n      $rootScope.siteMenu = gsnApi.getConfig().SiteMenu;\n      $rootScope.win = $window;\n      gsnGlobal.init(true);\n    }]);\n\n  function myGsnApi($rootScope, $window, $timeout, $q, $http, $location, $localStorage, $sce) {\n    var returnObj = {\n      previousDefer: null\n    };\n    var profileStorage = $localStorage;\n\n    // #region Internal Methods\n    function setAnonymousToken(token) {\n      var tk = returnObj.isNull(token, {});\n\n      $localStorage.anonymousToken = tk;\n    }\n\n    function getAccessToken() {\n      return returnObj.isNull(profileStorage.accessToken, {});\n    }\n\n    function getAccessTokenPayload() {\n      var accessTokenData = getAccessToken();\n      var hasValidAccessToken = (returnObj.isNull(accessTokenData.expires_dt, 0) > 0 && accessTokenData.expires_dt > new Date().getTime());\n\n      if (hasValidAccessToken) {\n        return null;\n      }\n\n      // payload default to anonymous authentication\n      var payload = {\n        grant_type: 'anonymous',\n        client_id: returnObj.getChainId(),\n        access_type: 'offline'\n      };\n\n      // if previous accessToken as refresh_token capability, then try to refresh\n      if (typeof(accessTokenData.refresh_token) !== 'undefined') {\n        payload.grant_type = 'refresh_token';\n        payload.refresh_token = accessTokenData.refresh_token;\n      }\n\n      return payload;\n    }\n\n\n    function setAccessToken(data) {\n      profileStorage.accessToken = data || {};\n\n      if (data) {\n        var profileId = parseInt(returnObj.isNull(data.user_id, 0));\n        if (returnObj.isNaN(profileId, 0) > 0) {\n          $rootScope.$broadcast('gsnevent:profile-setid', profileId);\n        }\n\n        // finally store anonymous token\n        if (data.grant_type === 'anonymous') {\n          setAnonymousToken(data);\n        }\n      }\n    }\n\n    function getAnonymousToken() {\n      return returnObj.isNull($localStorage.anonymousToken, {});\n    }\n\n    // #endregion\n\n    $rootScope[serviceId] = returnObj;\n    // #region gsn pass-through methods\n    returnObj.gsn = gsn;\n    gsn.$api = returnObj;\n\n    // return defaultValue if null - isNull(val, defaultIfNull)\n    returnObj.isNull = gsn.isNull;\n\n    // return defaultValue if NaN - isNaN(val, defaultIfNaN)\n    returnObj.isNaN = gsn.isNaN;\n\n    // sort a collection base on a field name - sortOn(list, 'field')\n    returnObj.sortOn = gsn.sortOn;\n\n    // group a list by a field name/attribute - groupBy(list, 'key') - result array with (key, items) property\n    returnObj.groupBy = gsn.groupBy;\n\n    // map a list to object, similar to reduce method - mapObject(list, 'key') - result object by key as id\n    returnObj.mapObject = gsn.mapObject;\n\n    // iterator method - forEach(list, function(v,k,list));\n    returnObj.forEach = angular.forEach;\n\n    // shallow extend method - extend(dest, src)\n    returnObj.extend = gsn.extend;\n\n    returnObj.keys = gsn.keys;\n\n    returnObj.getContentUrl = function(url) {\n      return $sce.trustAsResourceUrl(gsn.getContentUrl(url));\n    };\n\n    returnObj.getThemeUrl = function(url) {\n      return $sce.trustAsResourceUrl(gsn.getThemeUrl(url));\n    };\n\n    returnObj.cleanKeyword = gsn.cleanKeyword;\n\n    returnObj.loadIframe = gsn.loadIframe;\n\n    returnObj.loadScripts = gsn.loadScripts;\n\n    returnObj.userAgent = gsn.userAgent;\n\n    returnObj.browser = gsn.browser;\n\n    returnObj.parsePartialContentData = gsn.parsePartialContentData;\n\n    returnObj.del = gsn.del;\n\n    returnObj.getMetaUrl = gsn.getMetaUrl;\n    //#endregion\n\n    //#region gsn.config pass-through\n    returnObj.getConfig = function() {\n      return gsn.config;\n    };\n\n    returnObj.getApiUrl = gsn.getApiUrl;\n\n    returnObj.getStoreUrl = function() {\n      return gsn.config.StoreServiceUrl;\n    };\n\n    returnObj.getContentServiceUrl = function(method) {\n      var url = gsn.getContentServiceUrl('/' + method + '/' + returnObj.getChainId() + '/' + returnObj.isNull(returnObj.getSelectedStoreId(), '0') + '/');\n      if (gsn.config.useProxy) {\n        var contentStart = url.indexOf('/api/v1');\n        url = url.substring(contentStart + 7);\n        url = '/proxy' + url;\n        return url;\n      }\n\n      return url.replace('http://', '//');\n    };\n\n    returnObj.getDefaultLayout = function(defaultUrl) {\n      if (gsn.config.DefaultLayout) {\n        return $sce.trustAsResourceUrl(gsn.config.DefaultLayout);\n      }\n      return defaultUrl;\n    };\n\n    returnObj.getShoppingListApiUrl = function() {\n      return gsn.config.ShoppingListServiceUrl;\n    };\n\n    returnObj.getProfileApiUrl = function() {\n      return gsn.config.ProfileServiceUrl;\n    };\n\n    returnObj.getUseLocalStorage = function() {\n      return returnObj.isNull(gsn.config.UseLocalStorage, false);\n    };\n\n    returnObj.getVersion = function() {\n      /// <summary>Get the application version</summary>\n\n      return gsn.config.Version;\n    };\n\n    returnObj.isBetween = function(value, min, max) {\n      return value > min && value < max;\n    };\n\n    returnObj.getFacebookPermission = function() {\n      // if empty, get at least email permission\n      return returnObj.isNull(gsn.config.FacebookPermission, 'email');\n    };\n\n    returnObj.getGoogleAnalyticAccountId1 = function() {\n      return returnObj.isNull(gsn.config.GoogleAnalyticAccountId1, '');\n    };\n\n    returnObj.getEmailRegEx = function() {\n      return gsn.config.EmailRegex;\n    };\n\n    returnObj.getServiceUnavailableMessage = function() {\n      return gsn.config.ServiceUnavailableMessage;\n    };\n\n    returnObj.getChainId = function() {\n      return gsn.config.ChainId;\n    };\n\n    returnObj.getChainName = function() {\n      return gsn.config.ChainName;\n    };\n\n    returnObj.getHomeData = function() {\n      return gsn.config.HomePage;\n    };\n\n    returnObj.getRegistrationFromEmailAddress = function() {\n      return gsn.config.RegistrationFromEmailAddress;\n    };\n\n    returnObj.getRegistrationEmailLogo = function() {\n      return gsn.config.RegistrationEmailLogo;\n    };\n\n    returnObj.htmlFind = function(html, find) {\n      return angular.element('<div>' + html + '</div>').find(find).length;\n    };\n\n    returnObj.equalsIgnoreCase = function(val1, val2) {\n      return angular.lowercase(val1) === angular.lowercase(val2);\n    };\n\n    returnObj.toLowerCase = angular.lowercase;\n\n    returnObj.params = function(obj) {\n      var k = gsn.keys(obj);\n      var s = '';\n      for (var i = 0; i < k.length; i++) {\n        s += k[i] + '=' + encodeURIComponent(obj[k[i]]);\n        if (i !== k.length - 1)\n          s += '&';\n      }\n      return s;\n    };\n\n    returnObj.goUrl = function(url, target) {\n      /// <summary>go to url</summary>\n\n      try {\n        // attempt to hide any modal\n        angular.element('.modal').modal('hide');\n      } catch (e) {}\n\n      target = returnObj.isNull(target, '');\n\n      if (target === '_blank') {\n        $window.open(url, '');\n        return;\n      } else if (target === '_reload' || target === '_self') {\n        if ($window.top) {\n          try {\n            $window.top.location = url;\n          } catch (e) {\n            $window.location = url;\n          }\n        } else {\n          $window.location = url;\n        }\n\n        return;\n      }\n\n      $timeout(function() {\n        // allow external call to be in scope apply\n        $location.url(url);\n      }, 5);\n    };\n\n    returnObj.reload = function() {\n      returnObj.goUrl($location.url(), '_reload');\n    };\n\n    // allow external code to change the url of angular app\n    gsn.goUrl = returnObj.goUrl;\n    //#endregion\n\n    returnObj.clearSelection = function(items) {\n      angular.forEach(items, function(item) {\n        item.selected = false;\n      });\n    };\n\n    returnObj.getBindableItem = function(newItem) {\n      var item = angular.copy(newItem);\n      item.NewQuantity = item.Quantity || 1;\n      if ($rootScope.gsnProfile) {\n        var shoppingList = $rootScope.gsnProfile.getShoppingList();\n        if (shoppingList) {\n          var result = shoppingList.getItem(item);\n          if (result)\n            result.NewQuantity = result.Quantity || 1;\n          return result || item;\n        }\n      }\n\n      return item;\n    };\n\n    returnObj.updateBindableItem = function(item) {\n      if (item.ItemId) {\n        if ($rootScope.gsnProfile) {\n          var shoppingList = $rootScope.gsnProfile.getShoppingList();\n          if (shoppingList) {\n            item.OldQuantity = item.Quantity;\n            item.Quantity = parseInt(item.NewQuantity);\n            shoppingList.syncItem(item);\n          }\n        }\n      }\n    };\n\n    returnObj.decodeServerUrl = function(url) {\n      /// <summary>decode url path returned by our server</summary>\n      /// <param name=\"url\" type=\"Object\"></param>\n\n      return decodeURIComponent((url + '').replace(/\\s+$/, '').replace(/\\s+/gi, '-').replace(/(.aspx)$/, ''));\n    };\n\n    returnObj.parseStoreSpecificContent = function(contentData) {\n      var contentDataResult = {};\n      var possibleResult = [];\n      var myContentData = contentData;\n      var allStoreCount = gsn.config.StoreList.length;\n      var storeId = returnObj.isNull(returnObj.getSelectedStoreId(), 0);\n\n      // determine if contentData is array\n      if (contentData && contentData.Id) {\n        myContentData = [contentData];\n      }\n\n      var i = 0;\n      angular.forEach(myContentData, function(v, k) {\n        var storeIds = returnObj.isNull(v.StoreIds, []);\n\n        // get first content as default or value content without storeids\n        if ((i <= 0 || !contentDataResult.Description) && storeIds.length <= 0) {\n          contentDataResult = v;\n        }\n        i++;\n\n        if (storeId <= 0) {\n          if (allStoreCount === v.StoreIds.length) {\n            contentDataResult = v;\n          }\n\n          return;\n        }\n\n        angular.forEach(storeIds, function(v1, k1) {\n          if (storeId === v1) {\n            contentDataResult = v;\n            possibleResult.push(v);\n          }\n        });\n      });\n\n      var maxStoreIdCount = allStoreCount;\n      if (possibleResult.length > 1) {\n        // use result with least number of stores\n        angular.forEach(possibleResult, function(v, k) {\n          if (v.StoreIds.length > 1 && v.StoreIds.length < maxStoreIdCount) {\n            maxStoreIdCount = v.StoreIds.length;\n            contentDataResult = v;\n          }\n        });\n      }\n\n      return contentDataResult;\n    };\n\n    returnObj.getThemeContent = function(contentPosition) {\n      return returnObj.parseStoreSpecificContent(returnObj.getHomeData().ContentData[contentPosition]);\n    };\n\n    returnObj.getThemeConfig = function(name) {\n      return returnObj.parseStoreSpecificContent(returnObj.getHomeData().ConfigData[name]);\n    };\n\n    returnObj.getThemeConfigDescription = function(name, defaultValue) {\n      var resultObj = returnObj.getThemeConfig(name).Description;\n      return returnObj.isNull(resultObj, defaultValue);\n    };\n\n    returnObj.getFullPath = function(path, includePort) {\n      var normalizedPath = (returnObj.isNull(path, '') + '').replace(/$\\/+/gi, '');\n      if (normalizedPath.indexOf('http') > -1) {\n        return path;\n      }\n      if ($location.host() === 'localhost') {\n        includePort = true;\n      }\n\n      normalizedPath = ($location.protocol() + '://' + $location.host() + (includePort ? ':' + $location.port() : '') + ('/' + normalizedPath).replace(/(\\/\\/)+/gi, '\\/'));\n      return normalizedPath;\n    };\n\n    returnObj.getPageCount = function(data, pageSize) {\n      data = data || [];\n      return (Math.ceil(data.length / pageSize) || 1);\n    };\n\n    //#region storeId, shoppingListId, anonymousToken, etc...\n    returnObj.getSelectedStoreId = function() {\n      return profileStorage.storeId || 0;\n    };\n\n    returnObj.setSelectedStoreId = function(storeId, newUrl, timeout) {\n      // make sure we don't set a bad store id\n      var storeIdInt = parseInt(storeId);\n      if (returnObj.isNaN(storeIdInt, 0) <= 0) {\n        storeId = null;\n      }\n\n      var previousStoreId = profileStorage.storeId;\n      profileStorage.storeId = storeId;\n      $rootScope.$broadcast('gsnevent:store-setid', {\n        newValue: storeId,\n        oldValue: previousStoreId\n      });\n      if (newUrl) {\n        $timeout(function() {\n          returnObj.goUrl(newUrl, '_reload');\n        }, timeout || 500);\n      }\n    };\n\n    returnObj.getProfileId = function() {\n      var accessToken = getAccessToken();\n      return returnObj.isNaN(parseInt(returnObj.isNull(accessToken.user_id, 0)), 0);\n    };\n\n    returnObj.getShoppingListId = function() {\n      return returnObj.isNull(profileStorage.shoppingListId, 0);\n    };\n\n    returnObj.setShoppingListId = function(shoppingListId, dontBroadcast) {\n      profileStorage.shoppingListId = returnObj.isNull(shoppingListId, 0);\n\n      if (dontBroadcast) return;\n\n      $rootScope.$broadcast('gsnevent:shoppinglist-setid', shoppingListId);\n    };\n    //#endregion\n\n    returnObj.getApiHeaders = function() {\n      // assume access token data is available at this point\n      var accessTokenData = getAccessToken();\n      var payload = {\n        'X-SITE-ID': returnObj.getChainId(),\n        'X-STORE-ID': returnObj.getSelectedStoreId(),\n        'X-PROFILE-ID': returnObj.getProfileId(),\n        'X-ACCESS-TOKEN': accessTokenData.access_token,\n        'Content-Type': 'application/json'\n      };\n\n      return payload;\n    };\n\n    returnObj.isAnonymous = function() {\n      /// <summary>Determine if a user is logged in.</summary>\n\n      var accessTokenData = getAccessToken();\n\n      return returnObj.isNull(accessTokenData.grant_type, '') === 'anonymous';\n    };\n\n    returnObj.isLoggedIn = function() {\n      /// <summary>Determine if a user is logged in.</summary>\n\n      var accessTokenData = getAccessToken();\n\n      return returnObj.isNull(accessTokenData.grant_type, '') === 'password';\n    };\n\n    gsn.isLoggedIn = returnObj.isLoggedIn;\n    gsn.getUserId = returnObj.getProfileId;\n\n    returnObj.loadImage = function(src, cb, container) {\n      var imagePath = src,\n        img,\n        hasSize,\n        onHasSize = function() {\n          if (hasSize) return;\n          var im = img[0] || img;\n          var w = im.naturalWidth || im.width || img.width();\n          var h = im.naturalHeight || im.height || img.height();\n          img.remove();\n          hasSize = true;\n          cb({\n            w: w,\n            h: h\n          });\n        },\n        onLoaded = function() {\n          onHasSize();\n        },\n        onError = function() {\n          onHasSize();\n        },\n        checkSize = function() {\n          if (img.complete) {\n            onHasSize();\n            return;\n          }\n\n          var im = img[0] || img;\n          var w = im.naturalWidth || im.width || img.width();\n\n          if (w > 50) {\n            onHasSize();\n            return;\n          }\n\n          $timeout(checkSize, 100);\n        };\n\n      img = angular.element('<img style=\"position:absolute; top: -9999; z-index: -9999; height: auto; width: auto; max-width: 100%;\" />')\n        .on('load', onLoaded)\n        .on('error', onError)\n        .attr('src', imagePath)\n        .appendTo(container || angular.element('body')[0]);\n\n      checkSize();\n    };\n\n    returnObj.logOut = function() {\n      /// <summary>Log a user out.</summary>\n\n      // attempt to reset to anonymous token\n      var previousProfileId = returnObj.getProfileId();\n      var data = getAnonymousToken();\n      setAccessToken(data);\n\n      // if invalid anonymous token, cause a login\n      if (returnObj.isNull(data.expires_dt, 0) <= 0) {\n\n        // TODO: rethink this as it may cause infinit loop on browser if server is down\n        returnObj.getAccessToken();\n      }\n\n      $rootScope.$broadcast('gsnevent:logout', {\n        ProfileId: previousProfileId\n      });\n    };\n\n    returnObj.doAuthenticate = function(payload) {\n      if (payload) {\n        if (!payload.username) {\n          payload.username = returnObj.getProfileId();\n        }\n      }\n\n      // make the auth call\n      $http.post(gsn.config.AuthServiceUrl + '/Token2', payload, {\n          headers: {\n            'Content-Type': 'application/json',\n            'X-SHOPPING-LIST-ID': returnObj.getShoppingListId()\n          }\n        })\n        .success(function(response) {\n          // Since server automatically send grant_type ('anonymous'/'password') for refresh payload\n          // DO NOT SET: response.grant_type = payload.grant_type;\n          response.expires_dt = (new Date().getTime()) + 1000 * response.expires_in;\n\n          setAccessToken(response);\n          var defer = returnObj.previousDefer;\n          if (defer) {\n            returnObj.previousDefer = null;\n            defer.resolve(response);\n          }\n\n          $rootScope.$broadcast('gsnevent:login-success', {\n            success: true,\n            payload: payload,\n            response: response\n          });\n        }).error(function(response) {\n          var refreshTokenFailed = (payload.grant_type === 'refresh_token' && returnObj.isNull(response.ExceptionMessage, '').indexOf('expired') > 0);\n\n          // if refresh failed, it is being handled in 'gsnevent:auth-invalidrefresh'\n          if (!refreshTokenFailed) {\n            // if anonymous login failed, something must be wrong with the server\n            // a message should be display on the UI side?\n            $rootScope.$broadcast('gsnevent:login-failed', {\n              success: true,\n              payload: payload,\n              response: response\n            });\n          }\n        });\n    };\n\n    returnObj.setAccessToken = setAccessToken;\n\n    returnObj.getAccessToken = function() {\n      var deferred = returnObj.isNull(returnObj.previousDefer, null) === null ? $q.defer() : returnObj.previousDefer;\n\n      // check access token\n      var accessTokenPayload = getAccessTokenPayload();\n\n      // if valid token, resolve\n      if (returnObj.isNull(accessTokenPayload, null) === null) {\n        returnObj.previousDefer = null;\n        $timeout(function() {\n          deferred.resolve({\n            success: true,\n            response: getAccessToken()\n          });\n        }, 10);\n\n        return deferred.promise;\n      } else {\n\n        // do not proceed if a defer is going on\n        if (returnObj.isNull(returnObj.previousDefer, null) !== null) {\n          return returnObj.previousDefer.promise;\n        }\n\n        returnObj.previousDefer = deferred;\n        returnObj.doAuthenticate(accessTokenPayload);\n      }\n\n      return deferred.promise;\n    };\n\n    // when it doesn't have defer\n    //  -- it will create a defer and return promise\n    //  -- it will make http request and call defer resolve on success\n    // when it has defer or data, it will return the promise\n    returnObj.http = function(cacheObject, url, payload) {\n      // when it has data, it will simulate resolve and return promise\n      // when it doesn't have defer, it will create a defer and trigger request\n      // otherwise, just return the promise\n      if (cacheObject.response) {\n        // small timeout to simulate async\n        $timeout(function() {\n          cacheObject.deferred.resolve(cacheObject.response);\n        }, 50);\n      } else if (returnObj.isNull(cacheObject.deferred, null) === null) {\n        cacheObject.deferred = $q.defer();\n        var successHandler = function(response) {\n          cacheObject.response = {\n            success: true,\n            response: response\n          };\n          cacheObject.deferred.resolve(cacheObject.response);\n        };\n        var errorHandler = function(response) {\n          cacheObject.response = {\n            success: false,\n            response: response\n          };\n          cacheObject.deferred.resolve(cacheObject.response);\n        };\n\n        if (url.indexOf('/undefined') > 0) {\n          errorHandler('Client error: invalid request.');\n        } else {\n          returnObj.getAccessToken().then(function() {\n            cacheObject.url = url;\n            if (payload) {\n              $http.post(url, payload, {\n                headers: returnObj.getApiHeaders()\n              }).success(successHandler).error(errorHandler);\n            } else {\n              $http.get(url, {\n                headers: returnObj.getApiHeaders()\n              }).success(successHandler).error(errorHandler);\n            }\n          });\n        }\n      }\n\n      return cacheObject.deferred.promise;\n    };\n\n    returnObj.httpGetOrPostWithCache = returnObj.http;\n\n    returnObj.isValidCaptcha = function(challenge, response) {\n      var defer = $q.defer();\n      $http.post(gsn.config.AuthServiceUrl + '/ValidateCaptcha', {\n          challenge: challenge,\n          response: response\n        }, {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        })\n        .success(function(rsp) {\n          defer.resolve((rsp === 'true'));\n        }).error(function(rsp) {\n          defer.resolve(false);\n        });\n      return defer.promise;\n    };\n\n    returnObj.goBack = function() {\n      $timeout(function() {\n        $window.history.back();\n      }, 10);\n    };\n\n    returnObj.initApp = function() {\n      $rootScope.appState = 'initializing';\n\n      // injecting getContentUrl and getThemeUrl for css\n      $rootScope.getContentUrl = returnObj.getContentUrl;\n      $rootScope.getThemeUrl = returnObj.getThemeUrl;\n      $rootScope.getContentServiceUrl = returnObj.getContentServiceUrl;\n\n      // setting the default layout\n      var configData = returnObj.getHomeData().ConfigData;\n      if (configData) {\n        var layoutConfig = configData.layout;\n        if (layoutConfig) {\n          $rootScope.defaultLayout = gsn.getThemeUrl('/views/layout' + layoutConfig.Description + '/layout.html');\n        }\n      }\n\n      var accessTokenData = getAccessToken();\n      var hasValidAccessToken = (returnObj.isNull(accessTokenData.expires_dt, 0) > 0 && accessTokenData.expires_dt > new Date().getTime());\n\n      if (!hasValidAccessToken) {\n        // get and set to anonymous\n        var anonymousTokenData = getAnonymousToken();\n        setAccessToken(anonymousTokenData);\n      }\n\n      // give the UI 2/10 of a second to be ready\n      $timeout(function() {\n        $rootScope.win.appState = 'ready';\n      }, 200);\n    };\n\n    returnObj.onevent = function(fn) {\n      $rootScope.$on('gsnevent:*', fn);\n    };\n\n    //#region authentication event handling\n    $rootScope.$on('gsnevent:auth-expired', function(evt, args) {\n      var accessTokenData = getAccessToken();\n\n      // invalidate the token\n      if (accessTokenData.access_token) {\n        accessTokenData.expires_dt = 0;\n        setAccessToken(accessTokenData);\n      }\n\n      // trigger authentication after token invalidation\n      returnObj.getAccessToken();\n    });\n\n    $rootScope.$on('gsnevent:auth-invalidrefresh', function(evt, args) {\n      var accessTokenData = getAccessToken();\n      if (accessTokenData.grant_type === 'anonymous') {\n        // anonymous refresh expired so clear anonymous token\n        setAnonymousToken();\n      } else {\n        // non-anonymous refresh expired, reset current credential to anonymous\n      }\n\n      returnObj.logOut();\n      returnObj.reload();\n    });\n    //#endregion\n\n    return returnObj;\n\n  }\n\n  mygsncore.service(serviceId, ['$rootScope', '$window', '$timeout', '$q', '$http', '$location', '$localStorage', '$sce', myGsnApi]);\n\n})(gsn, angular);\n\n'use strict';\n\n(function() {\n  var app = angular.module('gsn.core');\n\n  //Setup map events from a google map object to trigger on a given element too,\n  //then we just use ui-event to catch events from an element\n  function bindMapEvents(scope, eventsStr, googleObject, element) {\n    angular.forEach(eventsStr.split(' '), function(eventName) {\n      //Prefix all googlemap events with 'map-', so eg 'click'\n      //for the googlemap doesn't interfere with a normal 'click' event\n      window.google.maps.event.addListener(googleObject, eventName, function(event) {\n        element.triggerHandler('map-' + eventName, event);\n        //We create an $apply if it isn't happening. we need better support for this\n        //We don't want to use timeout because tons of these events fire at once,\n        //and we only need one $apply\n        if (!scope.$$phase) {\n          scope.$apply();\n        }\n      });\n    });\n  }\n\n  app.value('uiMapConfig', {}).directive('uiMap', ['uiMapConfig', '$parse', '$timeout', 'gsnApi', function(uiMapConfig, $parse, $timeout, gsnApi) {\n\n    var mapEvents = 'bounds_changed center_changed click dblclick drag dragend ' +\n      'dragstart heading_changed idle maptypeid_changed mousemove mouseout ' +\n      'mouseover projection_changed resize rightclick tilesloaded tilt_changed ' +\n      'zoom_changed';\n    var options = uiMapConfig || {};\n\n    return {\n      restrict: 'A',\n      //doesn't work as E for unknown reason\n      link: function(scope, elm, attrs) {\n        function activate() {\n\n          var gmap = (window.google || {}).maps || {};\n          if ((typeof(gmap.Geocoder) === 'undefined') || (typeof(gmap.InfoWindow) === 'undefined') || (typeof(gmap.Map) === 'undefined')) {\n            // wait until it is defined\n            $timeout(activate, 100);\n            return;\n          }\n\n          // wait for uiOptions\n          if (!attrs.uiOptions) {\n            $timeout(activate, 100);\n            return;\n          }\n\n          var opts = angular.extend({}, options, scope.$eval(attrs.uiOptions));\n          var map = new window.google.maps.Map(elm[0], opts);\n          var model = $parse(attrs.uiMap);\n\n          //Set scope variable for the map\n          model.assign(scope, map);\n\n          bindMapEvents(scope, mapEvents, map, elm);\n        }\n\n        activate();\n      }\n    };\n  }]);\n\n  app.value('uiMapInfoWindowConfig', {}).directive('uiMapInfoWindow', ['uiMapInfoWindowConfig', '$parse', '$compile', '$timeout', function(uiMapInfoWindowConfig, $parse, $compile, $timeout) {\n\n    var infoWindowEvents = 'closeclick content_change domready ' +\n      'position_changed zindex_changed';\n    var options = uiMapInfoWindowConfig || {};\n\n    return {\n      link: function(scope, elm, attrs) {\n        function activate() {\n          var gmap = (window.google || {}).maps || {};\n          if ((typeof(gmap.Geocoder) === 'undefined') ||\n            (typeof(gmap.InfoWindow) === 'undefined') ||\n            (typeof(gmap.Map) === 'undefined')) {\n            // wait until it is defined\n            $timeout(activate, 100);\n            return;\n          }\n\n          var opts = angular.extend({}, options, scope.$eval(attrs.uiOptions));\n          opts.content = elm[0];\n          var model = $parse(attrs.uiMapInfoWindow);\n          var infoWindow = model(scope);\n\n          if (!infoWindow) {\n            infoWindow = new window.google.maps.InfoWindow(opts);\n            model.assign(scope, infoWindow);\n          }\n\n          bindMapEvents(scope, infoWindowEvents, infoWindow, elm);\n\n          /* The info window's contents dont' need to be on the dom anymore,\n           google maps has them stored.  So we just replace the infowindow element\n           with an empty div. (we don't just straight remove it from the dom because\n           straight removing things from the dom can mess up angular) */\n          elm.replaceWith('<div></div>');\n\n          //Decorate infoWindow.open to $compile contents before opening\n          var _open = infoWindow.open;\n          infoWindow.open = function open(a1, a2, a3, a4, a5, a6) {\n            $compile(elm.contents())(scope);\n            _open.call(infoWindow, a1, a2, a3, a4, a5, a6);\n          };\n        }\n\n        activate();\n      }\n    };\n  }]);\n\n  /*\n   * Map overlay directives all work the same. Take map marker for example\n   * <ui-map-marker=\"myMarker\"> will $watch 'myMarker' and each time it changes,\n   * it will hook up myMarker's events to the directive dom element.  Then\n   * ui-event will be able to catch all of myMarker's events. Super simple.\n   */\n  function mapOverlayDirective(directiveName, events) {\n    app.directive(directiveName, [function() {\n      return {\n        restrict: 'A',\n        link: function(scope, elm, attrs) {\n          scope.$watch(attrs[directiveName], function(newObject) {\n            if (newObject) {\n              bindMapEvents(scope, events, newObject, elm);\n            }\n          });\n        }\n      };\n    }]);\n  }\n\n  mapOverlayDirective('uiMapMarker',\n    'animation_changed click clickable_changed cursor_changed ' +\n    'dblclick drag dragend draggable_changed dragstart flat_changed icon_changed ' +\n    'mousedown mouseout mouseover mouseup position_changed rightclick ' +\n    'shadow_changed shape_changed title_changed visible_changed zindex_changed');\n\n  mapOverlayDirective('uiMapPolyline',\n    'click dblclick mousedown mousemove mouseout mouseover mouseup rightclick');\n\n  mapOverlayDirective('uiMapPolygon',\n    'click dblclick mousedown mousemove mouseout mouseover mouseup rightclick');\n\n  mapOverlayDirective('uiMapRectangle',\n    'bounds_changed click dblclick mousedown mousemove mouseout mouseover ' +\n    'mouseup rightclick');\n\n  mapOverlayDirective('uiMapCircle',\n    'center_changed click dblclick mousedown mousemove ' +\n    'mouseout mouseover mouseup radius_changed rightclick');\n\n  mapOverlayDirective('uiMapGroundOverlay',\n    'click dblclick');\n\n})();\n\n/**\n * angular-recaptcha build:2013-10-17\n * https://github.com/vividcortex/angular-recaptcha\n * Copyright (c) 2013 VividCortex\n **/\n\n/**\n * Modified by Tom Nguyen\n * For lazy loading of google recaptcha library\n **/\n/*global angular, Recaptcha */\n(function(angular, undefined) {\n  'use strict';\n\n  var app = angular.module('gsn.core');\n\n  /**\n   * An angular service to wrap the reCaptcha API\n   */\n  app.service('vcRecaptchaService', ['$timeout', '$log', '$q', '$window', 'gsnApi', function($timeout, $log, $q, $window, gsnApi) {\n\n    /**\n     * The reCaptcha callback\n     */\n    var callback, loadingScript;\n\n    return {\n\n      /**\n       * Creates a new reCaptcha object\n       *\n       * @param elm  the DOM element where to put the captcha\n       * @param key  the recaptcha public key (refer to the README file if you don't know what this is)\n       * @param fn   a callback function to call when the captcha is resolved\n       * @param conf the captcha object configuration\n       */\n      create: function(elm, key, fn, conf) {\n        callback = fn;\n        conf.callback = fn;\n\n        function loadRecaptcha() {\n          Recaptcha.create(\n            key,\n            elm,\n            conf\n          );\n        }\n\n        if (typeof(Recaptcha) === 'undefined') {\n          $timeout(loadRecaptcha, 500);\n\n          if (loadingScript) return;\n          loadingScript = true;\n\n          // dynamically load google\n          var src = '//www.google.com/recaptcha/api/js/recaptcha_ajax.js';\n          gsnApi.loadScripts([src], loadRecaptcha);\n          return;\n        }\n\n        loadRecaptcha();\n      },\n\n      /**\n       * Reloads the captcha (updates the challenge)\n       *\n       * @param should_focus pass TRUE if the recaptcha should gain the focus after reloading\n       */\n      reload: function(should_focus) {\n\n        // $log.info('Reloading captcha');\n        Recaptcha.reload(should_focus && 't');\n\n        /**\n         * Since the previous call is asynch, we need again the same hack. See directive code.\n         * @TODO Investigate another way to know when the new captcha is loaded\n         * @see https://github.com/VividCortex/angular-recaptcha/issues/4\n         * @see https://groups.google.com/forum/#!topic/recaptcha/6b7k866qzD0\n         */\n        $timeout(callback, 1000);\n      },\n\n      data: function() {\n        return {\n          response: Recaptcha.get_response(),\n          challenge: Recaptcha.get_challenge()\n        };\n      },\n\n      destroy: function() {\n        Recaptcha.destroy();\n      }\n    };\n\n  }]);\n\n}(angular));\n\n/*global angular, Recaptcha */\n(function(angular) {\n  'use strict';\n\n  var app = angular.module('gsn.core');\n\n  app.directive('vcRecaptcha', ['$log', '$timeout', 'vcRecaptchaService', function($log, $timeout, vcRecaptchaService) {\n\n    return {\n      restrict: 'A',\n      require: '?ngModel',\n      link: function(scope, elm, attrs, ctrl) {\n\n        // $log.info(\"Creating recaptcha with theme=%s and key=%s\", attrs.theme, attrs.key);\n\n        if (!attrs.hasOwnProperty('key') || attrs.key.length !== 40) {\n          throw 'You need to set the \"key\" attribute to your public reCaptcha key. If you don\\'t have a key, please get one from https://www.google.com/recaptcha/admin/create';\n        }\n\n        var\n          response_input, challenge_input,\n          refresh = function() {\n            if (ctrl) {\n              ctrl.$setViewValue({\n                response: response_input.val(),\n                challenge: challenge_input.val()\n              });\n            }\n          },\n          reload = function() {\n            var inputs = elm.find('input');\n            challenge_input = angular.element(inputs[0]); // #recaptcha_challenge_field\n            response_input = angular.element(inputs[1]); // #recaptcha_response_field\n            refresh();\n          },\n          callback = function() {\n            // $log.info('Captcha rendered');\n\n            reload();\n\n            response_input.bind('keyup', function() {\n              scope.$apply(refresh);\n            });\n\n            // model -> view\n            if (ctrl) {\n              ctrl.$render = function() {\n                response_input.val(ctrl.$viewValue.response);\n                challenge_input.val(ctrl.$viewValue.challenge);\n              };\n            }\n\n            // Capture the click even when the user requests for a new captcha\n            // We give some time for the new captcha to render\n            // This is kind of a hack, we should think on a better way to do this\n            // Probably checking for the image to change and if not, trigger the timeout again\n            elm.bind('click', function() {\n              // $log.info('clicked');\n              $timeout(function() {\n                scope.$apply(reload);\n              }, 1000);\n            });\n          };\n\n        vcRecaptchaService.create(\n          elm[0],\n          attrs.key,\n          callback, {\n            tabindex: attrs.tabindex,\n            theme: attrs.theme,\n            lang: attrs.lang || null\n          }\n        );\n      }\n    };\n  }]);\n\n}(angular));\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('defaultIf', ['gsnApi', function(gsnApi) {\n    // Usage: testValue | defaultIf:testValue == 'test'\n    //    or: testValue | defaultIf:someTest():defaultValue\n    //\n\n    return function(input, conditional, defaultOrFalseValue) {\n      var localCondition = conditional;\n      if (typeof(conditional) === 'function') {\n        localCondition = conditional();\n      }\n      return localCondition ? defaultOrFalseValue : input;\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('groupBy', ['gsnApi', function(gsnApi) {\n    // Usage: for doing grouping\n    //\n\n    return function(input, attribute) {\n      return gsnApi.groupBy(input, attribute);\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('pagingFilter', function() {\n    // Usage: for doing paging, item in list | pagingFilter:2:1\n    //\n\n    return function(input, pageSize, currentPage) {\n      return input ? input.slice(currentPage * pageSize, (currentPage + 1) * pageSize) : [];\n    };\n  });\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('tel', function() {\n    // Usage: phone number formating phoneNumber | tel\n    //\n    return function(tel, format, regex) {\n      if (!tel) return '';\n\n      regex = regex ? new RegExp(regex) : /(\\d{3})(\\d{3})(\\d{4})/;\n      var value = ('' + tel).replace(/\\D/g, '');\n\n      return value.replace(regex, format || '$1-$2-$3');\n    };\n  });\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  /**\n   * This directive help dynamically create a list of numbers.\n   * usage: data-ng-repeat=\"n in [] | range:1:5\"\n   * @directive range\n   */\n  myModule.filter('range', [function() {\n    return function(input, min, max) {\n      min = parseInt(min); //Make string input int\n      max = parseInt(max);\n      for (var i = min; i < max; i++) {\n        input.push(i);\n      }\n\n      return input;\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('removeAspx', ['gsnApi', function(gsnApi) {\n    // Usage: for removing aspx\n    //\n\n    return function(text) {\n      return gsnApi.isNull(text, '').replace(/(.aspx\\\"|.gsn\\\")+/gi, '\"');\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('replaceWith', function() {\n    // Usage: testValue | replaceWith:'\\\\s+':'gi':' '\n    //\n    return function(input, regex, flag, replaceWith) {\n      var patt = new RegExp(regex, flag);\n\n      return input.replace(patt, replaceWith);\n    };\n  });\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('truncate', [function() {\n    /**\n     * {{some_text | truncate:true:100:' ...'}}\n     * @param  {string}  value    the original text\n     * @param  {boolean} wordwise true to split by word\n     * @param  {integer} max      max character or word\n     * @param  {string}  tail     ending characters\n     * @return {string}\n     */\n    return function(value, wordwise, max, tail) {\n      if (!value) return '';\n\n      max = parseInt(max, 10);\n      if (!max) return value;\n      if (value.length <= max) return value;\n\n      value = value.substr(0, max);\n      if (wordwise) {\n        var lastspace = value.lastIndexOf(' ');\n        if (lastspace !== -1) {\n          value = value.substr(0, lastspace);\n        }\n      }\n\n      return value + (tail || ' …');\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('trustedHtml', ['gsnApi', '$sce', function(gsnApi, $sce) {\n    // Usage: allow for binding html\n    //\n    return function(text) {\n      return $sce.trustAsHtml(text);\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.filter('unescapeHtml', [function() {\n    // Usage: allow for escaping html\n    //\n    return function(text, escape) {\n      return escape ? escape(text) : unescape(text);\n    };\n  }]);\n\n})(angular);\n\n// bridging between Digital Store, ExpressLane, and Advertisment\n(function(angular, undefined) {\n  'use strict';\n  var serviceId = 'gsnAdvertising';\n  angular.module('gsn.core').service(serviceId, ['$timeout', '$location', 'gsnProfile', 'gsnApi', '$window', 'debounce', '$rootScope', 'gsnStore', gsnAdvertising]);\n\n  function gsnAdvertising($timeout, $location, gsnProfile, gsnApi, $window, debounce, $rootScope, gsnStore) {\n    var service = {\n      forceRefresh: true,\n      actionParam: null,\n      doRefresh: debounce(doRefresh, 500)\n    };\n    var bricktag = $window.bricktag;\n\n    if (!bricktag) return service;\n\n    if (gsnApi.getConfig().isPrerender) return;\n\n    bricktag.on('clickRecipe', function(data) {\n      $timeout(function() {\n        $location.url('/recipe/' + data.detail.RecipeId);\n      });\n    });\n\n    bricktag.on('clickProduct', function(data) {\n      $timeout(function() {\n        var product = data.detail;\n        if (product) {\n          var item = {\n            Quantity: gsnApi.isNaN(parseInt(product.Quantity), 1),\n            ItemTypeId: 7,\n            Description: gsnApi.isNull(product.Description, '').replace(/^\\s+/gi, ''),\n            CategoryId: product.CategoryId,\n            BrandName: product.BrandName,\n            AdCode: product.AdCode\n          };\n\n          gsnProfile.addItem(item);\n        }\n      });\n    });\n\n    bricktag.on('clickLink', function(data) {\n      $timeout(function() {\n        var linkData = data.detail;\n        if (linkData) {\n          var url = gsnApi.isNull(linkData.Url, '');\n          var target = gsnApi.isNull(linkData.Target, '');\n          if (target === '_blank') {\n            // this is a link out to open in new window\n            // $window.open(url, '');\n            // commented out because it is not possible to open with interaction\n            // it must be done on the ads itself\n          } else {\n            // assume this is an internal redirect\n            if (url.indexOf('/') < 0) {\n              url = '/' + url;\n            }\n\n            $location.url(url);\n          }\n        }\n      });\n    });\n\n    function shoppingListItemChange(event, shoppingList, item) {\n      var currentListId = gsnApi.getShoppingListId();\n      if (shoppingList.ShoppingListId === currentListId) {\n        var cat = gsnStore.getCategories()[item.CategoryId];\n        bricktag.addDept(cat.CategoryName);\n        // service.actionParam = {evtname: event.name, dept: cat.CategoryName, pdesc: item.Description, pcode: item.Id, brand: item.BrandName};\n        service.doRefresh();\n      }\n    }\n\n    $rootScope.$on('gsnevent:shoppinglistitem-updating', shoppingListItemChange);\n    $rootScope.$on('gsnevent:shoppinglistitem-removing', shoppingListItemChange);\n    $rootScope.$on('gsnevent:shoppinglist-loaded', function(event, shoppingList, item) {\n      var list = gsnProfile.getShoppingList();\n      if (list) {\n        // load all the ad depts\n        var items = gsnProfile.getShoppingList().allItems();\n        var categories = gsnStore.getCategories();\n\n        angular.forEach(items, function(item, idx) {\n          if (gsnApi.isNull(item.CategoryId, null) === null) return;\n\n          if (categories[item.CategoryId]) {\n            var newKw = categories[item.CategoryId].CategoryName;\n            bricktag.addDept(newKw);\n          }\n        });\n\n        // service.actionParam = {evtname: event.name, evtcategory: gsnProfile.getShoppingListId() };\n      }\n    });\n\n    $rootScope.$on('$locationChangeSuccess', function(event, next) {\n      var currentPath = angular.lowercase(gsnApi.isNull($location.path(), ''));\n      gsnProfile.getProfile().then(function(p) {\n        var isLoggedIn = gsnApi.isLoggedIn();\n\n        bricktag.setDefault({\n          page: currentPath,\n          storeid: gsnApi.getSelectedStoreId(),\n          consumerid: gsnProfile.getProfileId(),\n          isanon: !isLoggedIn,\n          loyaltyid: p.response.ExternalId\n        });\n      });\n      service.forceRefresh = true;\n      service.doRefresh();\n    });\n\n    $rootScope.$on('gsnevent:loadads', function(event, next) {\n      service.actionParam = {\n        evtname: event.name\n      };\n      service.doRefresh();\n    });\n\n    $rootScope.$on('gsnevent:digitalcircular-pagechanging', function(event, data) {\n      // service.actionParam = {evtname: event.name, evtcategory: data.circularIndex, pdesc: data.pageIndex};\n      service.doRefresh();\n    });\n\n    init();\n\n    // initialization\n    function init() {\n      if (service.isIE) {\n        bricktag.minSecondBetweenRefresh = 15;\n      }\n    }\n\n    // refresh method\n    function doRefresh() {\n      ($rootScope.gvm || {}).adsCollapsed = false;\n      bricktag.refresh(service.actionParam, service.forceRefresh);\n      service.forceRefresh = false;\n    }\n\n    return service;\n  }\n})(angular);\n\n// for handling everything globally\n(function(angular, undefined) {\n  'use strict';\n  var serviceId = 'gsnGlobal';\n  angular.module('gsn.core').service(serviceId, ['$window', '$location', '$timeout', '$route', 'gsnApi', 'gsnProfile', 'gsnStore', '$rootScope', 'Facebook', '$analytics', 'gsnAdvertising', '$anchorScroll', gsnGlobal]);\n\n  function gsnGlobal($window, $location, $timeout, $route, gsnApi, gsnProfile, gsnStore, $rootScope, Facebook, $analytics, gsnAdvertising, $anchorScroll) {\n    var returnObj = {\n      init: init,\n      hasInit: false\n    };\n    return returnObj;\n\n    function init(initProfile, $scope) {\n      // prevent mulitple init\n      if (returnObj.hasInit) {\n        return returnObj;\n      }\n      returnObj.hasInit = true;\n      if (initProfile) {\n        gsnProfile.initialize();\n      }\n      gsnApi.gsn.$rootScope = $rootScope;\n      $scope = $scope || $rootScope;\n      $scope.defaultLayout = gsnApi.getDefaultLayout(gsnApi.getThemeUrl('/views/layout.html'));\n      $scope.currentLayout = $scope.defaultLayout;\n      $scope.currentPath = '/';\n      $scope.notFoundDefaultLayout = gsnApi.getThemeUrl('/views/404.html');\n      $scope.notFoundLayout = $scope.notFoundDefaultLayout;\n      $scope.gvm = {\n        loginCounter: 0,\n        menuInactive: false,\n        shoppingListActive: false,\n        profile: {},\n        noCircular: true,\n        reloadOnStoreSelection: false,\n        currentStore: {},\n        adsCollapsed: false\n      };\n      $scope.search = {\n        site: '',\n        item: ''\n      };\n      $scope.facebookReady = false;\n      $scope.currentYear = new Date().getFullYear();\n      $scope.facebookData = {};\n      $scope.hasJustLoggedIn = false;\n      $scope.loggedInWithFacebook = false;\n      $scope.ChainName = gsnApi.getChainName();\n      $scope.isLoggedIn = gsnApi.isLoggedIn();\n      $scope.reload = gsnApi.reload;\n      $scope.broadcastEvent = $rootScope.$broadcast;\n      $scope.goUrl = gsnApi.goUrl;\n      $scope.encodeURIComponent = encodeURIComponent;\n      $scope.isOnList = gsnProfile.isOnList;\n      $scope.getShoppingListCount = gsnProfile.getShoppingListCount;\n      $scope.$win = $window;\n      $scope.seo = {};\n      // $scope._tk = $window._tk;\n      $scope.newDate = function(dateArg1) {\n        return dateArg1 ? new Date(dateArg1) : new Date();\n      };\n      $scope.validateRegistration = function(rsp) {\n        // attempt to authenticate user with facebook\n        // get token\n        $scope.facebookData.accessToken = rsp.authResponse.accessToken;\n        // get email\n        Facebook.api('/me?fields=id,name,email', function(response) {\n          $scope.facebookData.user = response;\n          if (response.email) {\n            // if user is already logged in, don't do it again\n            if (gsnApi.isLoggedIn()) return;\n            // attempt to authenticate\n            gsnProfile.loginFacebook(response.email, $scope.facebookData.accessToken);\n          }\n        });\n      };\n      $scope.doFacebookLogin = function() {\n        Facebook.getLoginStatus(function(response) {\n          if (response.status === 'connected' && response.authResponse.accessToken) {\n            $scope.validateRegistration(response);\n          } else {\n            Facebook.login(function(rsp) {\n              if (rsp.authResponse) {\n                $scope.validateRegistration(rsp);\n              }\n            }, {\n              scope: gsnApi.getFacebookPermission()\n            });\n          }\n        });\n      };\n      $scope.doIfLoggedIn = function(callbackFunc) {\n        if ($scope.isLoggedIn) {\n          callbackFunc();\n        } else {\n          $scope.gvm.loginCounter++;\n        }\n      };\n      $scope.clearSelection = gsnApi.clearSelection;\n      $scope.getBindableItem = gsnApi.getBindableItem;\n      $scope.updateBindableItem = gsnApi.getBindableItem;\n      $scope.doSiteSearch = function() {\n        $scope.goUrl('/search?q=' + encodeURIComponent($scope.search.site));\n      };\n      $scope.doItemSearch = function() {\n        $scope.goUrl('/product/search?q=' + encodeURIComponent($scope.search.item));\n      };\n      $scope.getPageCount = gsnApi.getPageCount;\n      $scope.getFullPath = gsnApi.getFullPath;\n      $scope.decodeServerUrl = gsnApi.decodeServerUrl;\n      $scope.goBack = function() {\n        /// <summary>Cause browser to go back.</summary>\n        if ($scope.currentPath !== '/') {\n          gsnApi.goBack();\n        }\n      };\n      $scope.logout = function() {\n        gsnProfile.logOut();\n        $scope.isLoggedIn = gsnApi.isLoggedIn();\n        if ($scope.loggedInWithFacebook) {\n          $scope.loggedInWithFacebook = false;\n          Facebook.logout();\n        }\n        // allow time to logout\n        $timeout(function() {\n          // reload the page to refresh page status on logout\n          if ($scope.currentPath === '/') {\n            gsnApi.reload();\n          } else {\n            $scope.goUrl('/');\n          }\n        }, 500);\n      };\n      $scope.logoutWithPrompt = function() {\n        try {\n          $scope.goOutPrompt(null, '/', $scope.logout, true);\n        } catch (e) {\n          $scope.logout();\n        }\n      };\n      $scope.logoutWithPromt = $scope.logoutWithPrompt;\n      $scope.goOutPromt = $scope.goOutPrompt;\n      $scope.print = function(timeout) {\n        setTimeout($window.print, timeout || 5000);\n      };\n      $scope.getTitle = function() {\n        return angular.element('title').text();\n      };\n      $scope.getSharePath = function(params) {\n        var query = $location.search();\n        params = params || {};\n        angular.copy(query, params);\n        return gsnApi.getFullPath($scope.currentPath + '?' + gsnApi.params(params));\n      };\n      $scope.doToggleCartItem = function(evt, item, linkedItem) {\n        /// <summary>Toggle the shoping list item checked state</summary>\n        /// <param name=\"evt\" type=\"Object\">for passing in angular $event</param>\n        /// <param name=\"item\" type=\"Object\">shopping list item</param>\n        if (item.ItemTypeId === 3) {\n          item.Quantity = gsnApi.isNaN(parseInt(item.SalePriceMultiple || item.PriceMultiple || 1), 1);\n        }\n        if (gsnProfile.isOnList(item)) {\n          gsnProfile.removeItem(item);\n        } else {\n          if (linkedItem) {\n            item.OldQuantity = item.Quantity;\n            item.Quantity = linkedItem.NewQuantity;\n          }\n          gsnProfile.addItem(item);\n          if (item.ItemTypeId === 8) {\n            if (gsnApi.isNull(item.Varieties, null) === null) {\n              item.Varieties = [];\n            }\n            $scope.gvm.selectedItem = item;\n          }\n        }\n        $rootScope.$broadcast('gsnevent:shoppinglist-toggle-item', item);\n      };\n      $scope.$on('$routeChangeSuccess', function(evt, next, current) {\n        if (typeof gmodal !== 'undefined') {\n          $timeout(function() {\n            gmodal.hide();\n          }, 50);\n        }\n        if ($location.hash()) {\n          $timeout(function() {\n            $anchorScroll();\n          }, 1000);\n        }\n        var url = $window.location.href;\n        url = url.replace('sfs=true', '')\n          .replace('siteid=' + gsnApi.getChainId(), '')\n          .replace(/cb\\=\\d+/gi, '')\n          .replace(/(\\&amp\\;)+/gi, '&')\n          .replace(/(\\&\\&)+/gi, '&')\n          .replace(/\\&+$/gi, '')\n          .replace(/\\?+$/gi, '');\n        angular.element('head > [itemprop=\"url\"]').attr('content', url);\n      });\n      // events handling\n      $scope.$on('$locationChangeStart', function(evt, nxt, current) {\n        /// <summary>Listen to location change</summary>\n        /// <param name=\"evt\" type=\"Object\">Event object</param>\n        /// <param name=\"nxt\" type=\"String\">next location</param>\n        /// <param name=\"current\" type=\"String\">current location</param>\n        var next = $route.routes[$location.path()];\n        if (!next) next = {};\n        // store the new route location\n        $scope.seo = next.seo || {};\n        $scope.currentPath = angular.lowercase(gsnApi.isNull($location.path(), ''));\n        $scope.friendlyPath = $scope.currentPath.replace('/', '').replace(/\\/+/gi, '-');\n        $scope.gvm.search = $location.search();\n        $scope.gvm.menuInactive = false;\n        $scope.gvm.shoppingListActive = false;\n        if (next.requireLogin && !$scope.isLoggedIn) {\n          evt.preventDefault();\n          $scope.goUrl('/signin?fromUrl=' + encodeURIComponent($location.url()));\n          return;\n        }\n        // handle storeRequired attribute\n        if (next.storeRequired) {\n          if (gsnApi.isNull(gsnApi.getSelectedStoreId(), 0) <= 0) {\n            $scope.goUrl('/storelocator?fromUrl=' + encodeURIComponent($location.url()));\n            return;\n          }\n        }\n\n        $scope.currentLayout = $scope.defaultLayout;\n        if (gsnApi.isNull(next.layout, '').length > 0) {\n          $scope.currentLayout = next.layout;\n        }\n\n        $scope.notFoundLayout = $scope.notFoundDefaultLayout;\n        if (gsnApi.isNull(next.notFoundLayout, '').length > 0) {\n          $scope.notFoundLayout = next.notFoundLayout;\n        }\n\n        $scope.gvm.selectedItem = null;\n      });\n      $scope.$on('gsnevent:profile-load-success', function(event, result) {\n        if (result.success) {\n          $scope.hasJustLoggedIn = false;\n          gsnProfile.getProfile().then(function(rst) {\n            if (rst.success) {\n              $scope.gvm.profile = rst.response;\n            }\n          });\n        }\n      });\n      $scope.$on('gsnevent:login-success', function(event, result) {\n        $scope.isLoggedIn = gsnApi.isLoggedIn();\n        $analytics.eventTrack('SigninSuccess', {\n          category: result.payload.grant_type,\n          label: result.response.user_id\n        });\n        $scope.hasJustLoggedIn = true;\n        $scope.loggedInWithFacebook = (result.payload.grant_type === 'facebook');\n      });\n      $scope.$on('gsnevent:login-failed', function(event, result) {\n        if (result.payload.grant_type === 'facebook') {\n          if (gsnApi.isLoggedIn()) return;\n          $scope.goUrl('/registration/facebook');\n          $analytics.eventTrack('SigninFailed', {\n            category: result.payload.grant_type,\n            label: gsnApi.getProfileId()\n          });\n        }\n      });\n      $scope.$on('gsnevent:store-setid', function(event, result) {\n        gsnStore.getStore().then(function(store) {\n          $analytics.eventTrack('StoreSelected', {\n            category: store.StoreName,\n            label: store.StoreNumber + ''\n          });\n          $scope.gvm.currentStore = store;\n          gsnProfile.getProfile().then(function(rst) {\n            if (rst.success) {\n              if (rst.response.PrimaryStoreId !== store.StoreId) {\n                // save selected store\n                gsnProfile.selectStore(store.StoreId).then(function() {\n                  // broadcast persisted on server response\n                  $rootScope.$broadcast('gsnevent:store-persisted', store);\n                });\n              }\n            }\n          });\n        });\n      });\n      $scope.$on('gsnevent:circular-loading', function(event, data) {\n        $scope.gvm.noCircular = true;\n      });\n      $scope.$on('gsnevent:circular-loaded', function(event, data) {\n        $scope.gvm.noCircular = !data.success;\n      });\n      // trigger facebook init if there is appId\n      if (typeof(Facebook.isReady) !== 'undefined' && gsnApi.getConfig().FacebookAppId) {\n        $scope.$watch(function() {\n          return Facebook.isReady(); // This is for convenience, to notify if Facebook is loaded and ready to go.\n        }, function(newVal) {\n          $scope.facebookReady = true; // You might want to use this to disable/show/hide buttons and else\n          if (gsnApi.isLoggedIn()) return;\n          // attempt to auto login facebook user\n          Facebook.getLoginStatus(function(response) {\n            // only auto login for connected status\n            if (response.status === 'connected') {\n              $scope.validateRegistration(response);\n            }\n          });\n        });\n      }\n      $scope.$on('gsnevent:closemodal', function() {\n        if (typeof gmodal !== 'undefined') {\n          gmodal.hide();\n        }\n      });\n      //#region analytics\n      $scope.$on('gsnevent:shoppinglistitem-updating', function(event, shoppingList, item) {\n        var currentListId = gsnApi.getShoppingListId();\n        if (shoppingList.ShoppingListId === currentListId) {\n          try {\n            var cat = gsnStore.getCategories()[item.CategoryId];\n            var evt = 'MiscItemAddUpdate';\n            if (item.ItemTypeId === 8) {\n              evt = 'CircularItemAddUpdate';\n            } else if (item.ItemTypeId === 3) {\n              evt = 'ProductAddUpdate';\n            } else if (item.ItemTypeId === 5) {\n              evt = 'RecipeIngredientAddUpdate';\n            } else if (item.ItemTypeId === 6) {\n              evt = 'OwnItemAddUpdate';\n            } else if (item.ItemTypeId === 10) {\n              evt = 'StoreCouponAddUpdate';\n            }\n            $analytics.eventTrack(evt, {\n              category: (item.ItemTypeId === 13) ? item.ExtCategory : cat.CategoryName,\n              label: item.Description,\n              item: item\n            });\n          } catch (e) {}\n        }\n      });\n      $scope.$on('gsnevent:shoppinglistitem-removing', function(event, shoppingList, item) {\n        var currentListId = gsnApi.getShoppingListId();\n        if (shoppingList.ShoppingListId === currentListId) {\n          try {\n            var cat = gsnStore.getCategories()[item.CategoryId],\n              coupon = null,\n              itemId = item.ItemId;\n            if (item.ItemTypeId === 8) {\n              $analytics.eventTrack('CircularItemRemove', {\n                category: cat.CategoryName,\n                label: item.Description,\n                item: item\n              });\n            } else if (item.ItemTypeId === 3) {\n              $analytics.eventTrack('ProductRemove', {\n                category: cat.CategoryName,\n                label: item.Description,\n                item: item\n              });\n            } else if (item.ItemTypeId === 5) {\n              $analytics.eventTrack('RecipeIngredientRemove', {\n                category: cat.CategoryName,\n                label: item.Description,\n                item: item\n              });\n            } else if (item.ItemTypeId === 6) {\n              $analytics.eventTrack('OwnItemRemove', {\n                label: item.Description\n              });\n            } else if (item.ItemTypeId === 10) {\n              coupon = gsnStore.getCoupon(item.ItemId, 10);\n              if (coupon) {\n                item = coupon;\n                if (gsnApi.isNull(item.ProductCode, '').length > 0) {\n                  itemId = item.ProductCode;\n                }\n              }\n              $analytics.eventTrack('StoreCouponRemove', {\n                category: cat.CategoryName,\n                label: item.Description,\n                item: item\n              });\n            } else {\n              $analytics.eventTrack('MiscItemRemove', {\n                category: cat.CategoryName,\n                label: item.Description,\n                item: item\n              });\n            }\n          } catch (e) {}\n        }\n      });\n\n      function gsnModalTracking(evt, el, track) {\n        var actionName = evt.name.replace('gsnevent:', '-');\n        if (track) {\n          $analytics.eventTrack(gsnApi.isNull(track.action, '') + actionName, track);\n          if (track.timedload) {\n            // trigger load ads event\n            $timeout(function() {\n              $rootScope.$broadcast('gsnevent:loadads');\n            }, parseInt(track.timedload));\n          }\n        }\n      }\n      $scope.$on('gsnevent:gsnmodal-hide', gsnModalTracking);\n      $scope.$on('gsnevent:gsnmodal-show', gsnModalTracking);\n      //#endregion\n    } // init\n  }\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var serviceId = 'gsnList';\n  angular.module('gsn.core').factory(serviceId, ['$rootScope', '$http', 'gsnApi', '$q', '$sessionStorage', gsnList]);\n\n  function gsnList($rootScope, $http, gsnApi, $q, $sessionStorage) {\n\n    var betterStorage = $sessionStorage;\n\n    // just a shopping list object\n    function myShoppingList(shoppingListId, shoppingList) {\n      var returnObj = {\n        ShoppingListId: shoppingListId\n      };\n      var $mySavedData = {\n        list: shoppingList,\n        items: {},\n        hasLoaded: false,\n        countCache: 0,\n        itemIdentity: 1\n      };\n\n      returnObj.getItemKey = function(item) {\n        var itemKey = item.ItemTypeId;\n        if (item.ItemTypeId === 7 || item.AdCode) {\n          itemKey = item.AdCode + gsnApi.isNull(item.BrandName, '') + gsnApi.isNull(item.Description, '');\n        }\n\n        return itemKey + '_' + item.ItemId;\n      };\n\n      // replace local item with server item\n      function processServerItem(serverItem, localItem) {\n        if (serverItem) {\n          var itemKey = returnObj.getItemKey(localItem);\n\n          // set new server item order\n          serverItem.Order = localItem.Order;\n\n          // remove existing item locally if new id has been detected\n          if (serverItem.ItemId !== localItem.ItemId) {\n            returnObj.removeItem(localItem, true);\n          }\n\n          // Add the new server item.\n          $mySavedData.items[returnObj.getItemKey(serverItem)] = serverItem;\n          saveListToSession();\n        }\n      }\n\n      returnObj.syncItem = function(itemToSync) {\n        var existingItem = returnObj.getItem(itemToSync.ItemId, itemToSync.ItemTypeId) || itemToSync;\n        if (existingItem !== itemToSync) {\n          existingItem.Quantity = itemToSync.Quantity;\n        }\n\n        if (parseInt(existingItem.Quantity) > 0) {\n          // build new item to make sure posting of only required fields\n          var itemToPost = angular.copy(existingItem);\n\n          itemToPost.BarcodeImageUrl = undefined;\n          itemToPost.BottomTagLine = undefined;\n          itemToPost.Description1 = undefined;\n          itemToPost.Description2 = undefined;\n          itemToPost.Description3 = undefined;\n          itemToPost.Description4 = undefined;\n          itemToPost.EndDate = undefined;\n          itemToPost.ImageUrl = undefined;\n          itemToPost.SmallImageUrl = undefined;\n          itemToPost.StartDate = undefined;\n          itemToPost.TopTagLine = undefined;\n          itemToPost.TotalDownloads = undefined;\n          itemToPost.TotalDownloadsAllowed = undefined;\n          itemToPost.Varieties = undefined;\n          itemToPost.PageNumber = undefined;\n          itemToPost.rect = undefined;\n          itemToPost.LinkedItem = undefined;\n\n          $rootScope.$broadcast('gsnevent:shoppinglistitem-updating', returnObj, existingItem, $mySavedData);\n\n          gsnApi.getAccessToken().then(function() {\n\n            var url = gsnApi.getShoppingListApiUrl() + '/UpdateItem/' + returnObj.ShoppingListId;\n            var hPayload = gsnApi.getApiHeaders();\n            hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n            $http.post(url, itemToPost, {\n              headers: hPayload\n            }).success(function(response) {\n              if (response.Id) {\n                processServerItem(response, existingItem);\n              }\n\n              $rootScope.$broadcast('gsnevent:shoppinglist-changed', returnObj);\n              saveListToSession();\n            }).error(function() {\n              // reset to previous quantity on failure\n              if (existingItem.OldQuantity) {\n                existingItem.NewQuantity = existingItem.OldQuantity;\n                existingItem.Quantity = existingItem.OldQuantity;\n                saveListToSession();\n              }\n            });\n          });\n        } else {\n          returnObj.removeItem(existingItem);\n        }\n\n        saveListToSession();\n        $rootScope.$broadcast('gsnevent:shoppinglist-changed', returnObj);\n      };\n\n      // add item to list\n      returnObj.addItem = function(item, deferSync) {\n        if (gsnApi.isNull(item.ItemId, 0) <= 0) {\n\n          // this is to help with getItemKey?\n          item.ItemId = ($mySavedData.itemIdentity++);\n        }\n\n        $mySavedData.countCache = 0;\n        var existingItem = $mySavedData.items[returnObj.getItemKey(item)];\n\n        if (gsn.isNull(existingItem, null) === null) {\n          // remove any ties to existing shopping list\n          item.Id = undefined;\n          item.ShoppingListItemId = undefined;\n          item.ShoppingListId = returnObj.ShoppingListId;\n          item.CategoryId = item.CategoryId || -1;\n\n          existingItem = item;\n          $mySavedData.items[returnObj.getItemKey(existingItem)] = existingItem;\n        } else { // update existing item\n\n          var newQuantity = gsnApi.isNaN(parseInt(item.Quantity), 1);\n          var existingQuantity = gsnApi.isNaN(parseInt(existingItem.Quantity), 1);\n          if (newQuantity > existingQuantity) {\n            existingItem.Quantity = newQuantity;\n          } else {\n            existingItem.Quantity = existingQuantity + newQuantity;\n          }\n        }\n\n        if (existingItem.IsCoupon) {\n\n          // Get the temp quantity.\n          var tmpQuantity = gsnApi.isNaN(parseInt(existingItem.Quantity), 0);\n\n          // Now, assign the quantity.\n          existingItem.Quantity = (tmpQuantity > 0) ? tmpQuantity : 1;\n        }\n\n        existingItem.Order = ($mySavedData.itemIdentity++);\n\n        if (!gsnApi.isNull(deferSync, false)) {\n          returnObj.syncItem(existingItem);\n        } else {\n          saveListToSession();\n        }\n\n        return existingItem;\n      };\n\n      returnObj.addItems = function(items) {\n        var deferred = $q.defer();\n        var toAdd = [];\n        angular.forEach(items, function(v, k) {\n          var rst = angular.copy(returnObj.addItem(v, true));\n          toAdd.push(rst);\n        });\n\n        $rootScope.$broadcast('gsnevent:shoppinglistitems-updating', returnObj);\n        saveListToSession();\n\n        gsnApi.getAccessToken().then(function() {\n\n          var url = gsnApi.getShoppingListApiUrl() + '/SaveItems/' + returnObj.ShoppingListId;\n          var hPayload = gsnApi.getApiHeaders();\n          hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n          $http.post(url, toAdd, {\n            headers: hPayload\n          }).success(function(response) {\n            $rootScope.$broadcast('gsnevent:shoppinglist-changed', returnObj);\n            deferred.resolve({\n              success: true,\n              response: response\n            });\n            saveListToSession();\n          }).error(function() {\n            deferred.resolve({\n              success: false\n            });\n          });\n        });\n\n        return deferred.promise;\n      };\n\n      // remove item from list\n      returnObj.removeItem = function(inputItem, deferRemove) {\n        var item = returnObj.getItem(inputItem);\n        if (item) {\n          item.Quantity = 0;\n\n          // stupid ie8, can't simply delete\n          var removeK = returnObj.getItemKey(item);\n          try {\n            delete $mySavedData.items[removeK];\n          } catch (e) {\n\n            var items = {};\n            angular.forEach($mySavedData.items, function(v, k) {\n              if (k !== removeK)\n                items[k] = v;\n            });\n\n            $mySavedData.items = items;\n          }\n\n          saveListToSession();\n\n          if (deferRemove) return returnObj;\n          gsnApi.getAccessToken().then(function() {\n            $rootScope.$broadcast('gsnevent:shoppinglistitem-removing', returnObj, item);\n\n            var url = gsnApi.getShoppingListApiUrl() + '/DeleteItems/' + returnObj.ShoppingListId;\n            var hPayload = gsnApi.getApiHeaders();\n            hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n            $http.post(url, [item.Id || item.ItemId], {\n              headers: hPayload\n            }).success(function(response) {\n              $rootScope.$broadcast('gsnevent:shoppinglist-changed', returnObj);\n              saveListToSession();\n            });\n          });\n        }\n\n        return returnObj;\n      };\n\n      // get item by object or id\n      returnObj.getItem = function(itemId, itemTypeId) {\n        // just return whatever found, no need to validate item\n        // it's up to the user to call isValidItem to validate\n        var adCode, brandName, myDescription;\n        if (typeof(itemId) === 'object') {\n          adCode = itemId.AdCode;\n          brandName = itemId.BrandName;\n          myDescription = itemId.Description;\n          itemTypeId = itemId.ItemTypeId;\n          itemId = itemId.ItemId;\n        }\n\n        var myItemKey = returnObj.getItemKey({\n          ItemId: itemId,\n          ItemTypeId: gsnApi.isNull(itemTypeId, 8),\n          AdCode: adCode,\n          BrandName: brandName,\n          Description: myDescription\n        });\n        return $mySavedData.items[myItemKey];\n      };\n\n      returnObj.isValidItem = function(item) {\n        var itemType = typeof(item);\n\n        if (itemType !== 'undefined' && itemType !== 'function') {\n          return (item.Quantity > 0);\n        }\n\n        return false;\n      };\n\n      // return all items\n      returnObj.allItems = function() {\n        var result = [];\n        var items = $mySavedData.items;\n        angular.forEach(items, function(item, index) {\n          if (returnObj.isValidItem(item)) {\n            result.push(item);\n          }\n        });\n\n        return result;\n      };\n\n      // get count of items\n      returnObj.getCount = function() {\n        if ($mySavedData.countCache > 0) return $mySavedData.countCache;\n\n        var count = 0;\n        var items = $mySavedData.items;\n        var isValid = true;\n        angular.forEach(items, function(item, index) {\n          if (!item) {\n            isValid = false;\n            return;\n          }\n\n          if (returnObj.isValidItem(item)) {\n            count += gsnApi.isNaN(parseInt(item.Quantity), 0);\n          }\n        });\n\n        if (!isValid) {\n          $mySavedData.items = {};\n          $mySavedData.hasLoaded = false;\n          returnObj.updateShoppingList();\n        }\n\n        $mySavedData.countCache = count;\n        return count;\n      };\n\n      // clear items\n      returnObj.clearItems = function() {\n        // clear the items\n        $mySavedData.items = {};\n        returnObj.saveChanges();\n      };\n\n      returnObj.getTitle = function() {\n        return ($mySavedData.list) ? $mySavedData.list.Title : '';\n      };\n\n      returnObj.getStatus = function() {\n        return ($mySavedData.list) ? $mySavedData.list.StatusId : 1;\n      };\n\n      // cause shopping list delete\n      returnObj.deleteList = function() {\n        // call DeleteShoppingList\n\n        $mySavedData.countCache = 0;\n        gsnApi.getAccessToken().then(function() {\n\n          var url = gsnApi.getShoppingListApiUrl() + '/Delete/' + returnObj.ShoppingListId;\n          var hPayload = gsnApi.getApiHeaders();\n          hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n          $http.post(url, {}, {\n            headers: hPayload\n          }).success(function(response) {\n            // do nothing\n            $rootScope.$broadcast('gsnevent:shoppinglist-deleted', returnObj);\n            saveListToSession();\n          });\n        });\n\n        return returnObj;\n      };\n\n      // save changes\n      returnObj.saveChanges = function() {\n        if (returnObj.savingDeferred) return returnObj.savingDeferred.promise;\n        var deferred = $q.defer();\n        returnObj.savingDeferred = deferred;\n\n        $mySavedData.countCache = 0;\n        var syncitems = [];\n\n        // since we immediately update item with server as it get added to list\n        // all we need is to send back the item id to tell server item still on list\n        // this is also how we mass delete items\n        var items = returnObj.allItems();\n        angular.forEach(items, function(item) {\n          syncitems.push(item.ItemId);\n        });\n\n        saveListToSession();\n\n        gsnApi.getAccessToken().then(function() {\n\n          var url = gsnApi.getShoppingListApiUrl() + '/DeleteOtherItems/' + returnObj.ShoppingListId;\n          var hPayload = gsnApi.getApiHeaders();\n          hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n          $http.post(url, syncitems, {\n            headers: hPayload\n          }).success(function(response) {\n            deferred.resolve({\n              success: true,\n              response: returnObj\n            });\n            returnObj.savingDeferred = null;\n\n            $rootScope.$broadcast('gsnevent:shoppinglist-changed', returnObj);\n            saveListToSession();\n          }).error(function(response) {\n            deferred.resolve({\n              success: false,\n              response: response\n            });\n            returnObj.savingDeferred = null;\n          });\n        });\n\n        return deferred.promise;\n      };\n\n      // cause change to shopping list title\n      returnObj.setTitle = function(title) {\n        var deferred = $q.defer();\n\n        $mySavedData.countCache = 0;\n        gsnApi.getAccessToken().then(function() {\n\n          var url = gsnApi.getShoppingListApiUrl() + '/Update/' + returnObj.ShoppingListId + '?title=' + encodeURIComponent(title);\n          var hPayload = gsnApi.getApiHeaders();\n          hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n          $http.post(url, {}, {\n            headers: hPayload\n          }).success(function(response) {\n            deferred.resolve({\n              success: true,\n              response: returnObj\n            });\n            $mySavedData.list.Title = title;\n\n            // Send these two broadcast messages.\n            $rootScope.$broadcast('gsnevent:shopping-list-saved');\n            $rootScope.$broadcast('gsnevent:shoppinglist-changed', returnObj);\n            saveListToSession();\n          }).error(function(response) {\n            // console.log( returnObj.ShoppingListId + ' setTitle error: ' + response );\n            deferred.resolve({\n              success: false,\n              response: response\n            });\n          });\n        });\n\n        return deferred.promise;\n      };\n\n      returnObj.hasLoaded = function() {\n        return $mySavedData.hasLoaded;\n      };\n\n      returnObj.getListData = function() {\n        return angular.copy($mySavedData.list);\n      };\n\n      function saveListToSession() {\n        betterStorage.currentShoppingList = $mySavedData;\n\n        // Since we are chainging the saved data, the count is suspect.\n        $mySavedData.countCache = 0;\n      }\n\n      function loadListFromSession() {\n        var list = betterStorage.currentShoppingList;\n        if (list && list.list && list.list.Id === shoppingListId) {\n          var isValid = true;\n          angular.forEach(list.items, function(v, k) {\n            if (gsnApi.isNull(v)) {\n              isValid = false;\n            }\n          });\n\n          if (isValid) {\n            $mySavedData.hasLoaded = list.hasLoaded;\n            $mySavedData.items = list.items;\n            $mySavedData.itemIdentity = list.itemIdentity;\n            $mySavedData.countCache = list.countCache;\n          } else {\n            $mySavedData.hasLoaded = false;\n            returnObj.updateShoppingList();\n          }\n        }\n      }\n\n\n      function processShoppingList(result) {\n        $mySavedData.items = {};\n\n        angular.forEach(result, function(item, index) {\n          item.Order = index;\n          $mySavedData.items[returnObj.getItemKey(item)] = item;\n        });\n\n        $mySavedData.hasLoaded = true;\n        $mySavedData.itemIdentity = result.length + 1;\n        $rootScope.$broadcast('gsnevent:shoppinglist-loaded', returnObj, result);\n        saveListToSession();\n      }\n\n      returnObj.updateShoppingList = function() {\n        if (returnObj.deferred) return returnObj.deferred.promise;\n\n        var deferred = $q.defer();\n        returnObj.deferred = deferred;\n\n        if (returnObj.ShoppingListId > 0) {\n          if ($mySavedData.hasLoaded) {\n            $rootScope.$broadcast('gsnevent:shoppinglist-loaded', returnObj, $mySavedData.items);\n            deferred.resolve({\n              success: true,\n              response: returnObj\n            });\n            returnObj.deferred = null;\n          } else {\n\n            $mySavedData.items = {};\n            $mySavedData.countCache = 0;\n\n            gsnApi.getAccessToken().then(function() {\n              // call GetShoppingList(int shoppinglistid, int profileid)\n              var url = gsnApi.getShoppingListApiUrl() + '/ItemsBy/' + returnObj.ShoppingListId + '?nocache=' + (new Date()).getTime();\n\n              var hPayload = gsnApi.getApiHeaders();\n              hPayload['X-SHOPPING-LIST-ID'] = returnObj.ShoppingListId;\n              $http.get(url, {\n                headers: hPayload\n              }).success(function(response) {\n                processShoppingList(response);\n                $rootScope.$broadcast('gsnevent:shoppinglist-loaded', returnObj, $mySavedData.items);\n                deferred.resolve({\n                  success: true,\n                  response: returnObj\n                });\n                returnObj.deferred = null;\n              }).error(function(response) {\n                $rootScope.$broadcast('gsnevent:shoppinglist-loadfail', response);\n                deferred.resolve({\n                  success: false,\n                  response: response\n                });\n                returnObj.deferred = null;\n              });\n            });\n          }\n        }\n\n        return deferred.promise;\n      };\n\n      loadListFromSession();\n\n      return returnObj;\n    }\n\n    return myShoppingList;\n  }\n})(angular);\n\n// collection of misc service and factory\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n  /**\n   * allow for cross platform notification\n   */\n  myModule.service('$notification', ['$rootScope', '$window', function($rootScope, $window) {\n    var service = {\n      alert: function(message) {\n        if (!$window.isPhoneGap) {\n          gmodal.show({\n            content: '<div class=\"myModalForm\" style=\"display: block\"><div class=\"modal-dialog\"><div class=\"modal-content\"><div class=\"modal-body\">' + message + '<br /><br/><button class=\"btn btn-default gmodal-close pull-right\" style=\"width: 80px\" data-ng-click=\"closeModal()\">OK</button><br /></div></div></div></div>',\n            hideOn: 'click,esc,tap'\n          });\n          return;\n        }\n        navigator.notification.alert(message, null, '', 'OK');\n      },\n      confirm: function(message, callbackFn, title, buttonLabels) {\n        if (gsn.isNull(buttonLabels, null) === null) {\n          buttonLabels = 'OK,Cancel';\n        }\n        if (!$window.isPhoneGap) {\n          callbackFn($window.confirm(message) ? 1 : 2);\n          return;\n        }\n        navigator.notification.confirm(message, // message\n          callbackFn, // callback to invoke with index of button pressed\n          title, // title\n          buttonLabels.split(',') // buttonLabels\n        );\n      },\n      prompt: function(message, callbackFn, title, defaultText, buttonLabels) {\n        if (gsn.isNull(buttonLabels, null) === null) {\n          buttonLabels = 'OK,Cancel';\n        }\n        if (gsn.isNull(defaultText, null) === null) {\n          defaultText = '';\n        }\n        if (!$window.isPhoneGap) {\n          var answer = $window.prompt(message, defaultText);\n          callbackFn({\n            buttonIndex: (answer ? 1 : 2),\n            input1: answer\n          });\n          return;\n        }\n        navigator.notification.prompt(message, // message\n          callbackFn, // callback to invoke\n          title, // title\n          buttonLabels.split(','), defaultText);\n      }\n    };\n    return service;\n  }]);\n  // debounce: for performance\n  myModule.factory('debounce', ['$timeout', function($timeout) {\n    // The service is actually this function, which we call with the func\n    // that should be debounced and how long to wait in between calls\n    return function debounce(func, wait, immediate) {\n      var timeout;\n      return function() {\n        var context = this,\n          args = arguments;\n        var later = function() {\n          timeout = null;\n          if (!immediate) func.apply(context, args);\n        };\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) func.apply(context, args);\n      };\n    };\n  }]);\n  // FeedService: google feed\n  myModule.factory('FeedService', ['$http', 'gsnApi', function($http, gsnApi) {\n    return {\n      parseFeed: function(url, maxResult) {\n        return $http.jsonp('//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=' + gsnApi.isNull(maxResult, 50) + '&callback=JSON_CALLBACK&q=' + encodeURIComponent(url));\n      }\n    };\n  }]);\n  // gsnAuthenticationHandler to handle expired refresh token\n  myModule.factory('gsnAuthenticationHandler', ['$rootScope', '$q', function($rootScope, $q) {\n    var service = {\n      responseError: function(response, code) {\n        // intercept 401\n        if (response.status === 401) {\n          $rootScope.$broadcast('gsnevent:auth-expired', arguments);\n        } else if (response.status === 400) {\n          if (response.data && typeof response.data === 'string') {\n            if ((response.data.indexOf('refresh_token is invalid or has expired') > -1) || (response.data.indexOf('Illegal attempt to refresh an anonymous token for user that is no longer anonymous.') > -1)) {\n              $rootScope.$broadcast('gsnevent:auth-invalidrefresh', arguments);\n            }\n          }\n        }\n        // do something on error\n        return $q.reject(response);\n      }\n    };\n    return service;\n    //#region Internal Methods\n    //#endregion\n  }]);\n  /**\n   * Detect display mode\n   */\n  myModule.directive('bsDisplayMode', ['$window', '$timeout', function($window, $timeout) {\n    return {\n      template: '<div class=\"visible-xs\"></div><div class=\"visible-sm\"></div><div class=\"visible-md\"></div><div class=\"visible-lg\"></div>',\n      restrict: 'EA',\n      replace: false,\n      link: function(scope, elem, attrs) {\n        var markers = elem.find('div');\n\n        function update() {\n          angular.forEach(markers, function(element) {\n            if (angular.element(element).is(':visible')) {\n              scope[attrs.bsDisplayMode] = element.className;\n            }\n          });\n        }\n        angular.element($window).bind('resize', function() {\n          // use timeout to overcome scope apply\n          $timeout(update, 300);\n        });\n        update();\n      }\n    };\n  }]);\n  /**\n   * bind scrollTo event on click\n   */\n  myModule.directive('scrollTo', ['$location', '$anchorScroll', function($location, $anchorScroll) {\n    return function(scope, element, attrs) {\n      element.bind('click', function(event) {\n        event.stopPropagation();\n        var off = scope.$on('$locationChangeStart', function(ev) {\n          off();\n          ev.preventDefault();\n        });\n        var location = attrs.scrollTo;\n        $location.hash(location);\n        $anchorScroll();\n      });\n    };\n  }]);\n  /**\n   * create scrollTop marker\n   */\n  myModule.directive('ngScrollTop', ['$window', '$timeout', 'debounce', function($window, $timeout, debounce) {\n    var directive = {\n      link: link,\n      restrict: 'A',\n    };\n    // if more than 1 scrollTop on page - disable show/hide of element\n    var countScrollTop = 0;\n    return directive;\n\n    function link(scope, element, attrs) {\n      countScrollTop++;\n      var myScrollTop = debounce(function() {\n        scope.scrollTop = angular.element($window).scrollTop();\n        element.css({\n          'display': ((scope.scrollTop > parseInt(attrs.offset)) && countScrollTop === 1) ? 'block' : ''\n        });\n      }, 300);\n      angular.element($window).on('scroll', myScrollTop);\n      element.on('click', function() {\n        angular.element($window).scrollTop(0);\n      });\n      scope.$on('$destroy', function() {\n        countScrollTop--;\n      });\n    }\n  }]);\n  /**\n   * stop event probagation\n   */\n  myModule.directive('stopEvent', function() {\n    return {\n      restrict: 'A',\n      link: function(scope, element, attr) {\n        element.bind(attr.stopEvent, function(e) {\n          e.stopPropagation();\n        });\n      }\n    };\n  });\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var serviceId = 'gsnProfile';\n  angular.module('gsn.core').service(serviceId, ['$rootScope', '$http', 'gsnApi', '$q', 'gsnList', 'gsnStore', '$location', '$timeout', '$localStorage', gsnProfile]);\n\n  function gsnProfile($rootScope, $http, gsnApi, $q, gsnList, gsnStore, $location, $timeout, $localStorage) {\n    var returnObj = {},\n      previousProfileId = gsnApi.getProfileId(),\n      $profileDefer = null,\n      $creatingDefer = null,\n      $savedData = {\n        allShoppingLists: {},\n        profile: null\n      };\n\n    $rootScope[serviceId] = returnObj;\n    gsnApi.gsn.$profile = returnObj;\n    returnObj.getShoppingListId = gsnApi.getShoppingListId;\n\n    returnObj.getProfileId = gsnApi.getProfileId;\n\n    returnObj.createNewShoppingList = function() {\n      /// <summary>Create a new shopping list.</summary>\n\n      if ($creatingDefer) return $creatingDefer.promise;\n\n      $creatingDefer = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getShoppingListApiUrl() + '/Create/' + gsnApi.getProfileId();\n        $http.post(url, {}, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          var result = response;\n          $savedData.allShoppingLists[result.Id] = gsnList(result.Id, result);\n          gsnApi.setShoppingListId(result.Id);\n          $rootScope.$broadcast('gsnevent:shoppinglist-created', $savedData.allShoppingLists[result.Id]);\n          $creatingDefer.resolve({\n            success: true,\n            response: $savedData.allShoppingLists[result.Id]\n          });\n          $creatingDefer = null;\n        }).error(function(response) {\n          $creatingDefer.resolve({\n            success: false,\n            response: response\n          });\n          $creatingDefer = null;\n        });\n      });\n\n      return $creatingDefer.promise;\n    };\n\n    returnObj.login = function(user, pass) {\n      var payload = {\n        grant_type: 'password',\n        client_id: gsnApi.getChainId(),\n        access_type: 'offline',\n        username: user,\n        password: pass\n      };\n\n      gsnApi.doAuthenticate(payload);\n    };\n\n    returnObj.loginFacebook = function(user, facebookToken) {\n      if (!gsnApi.getConfig().FacebookAppId) {\n        return;\n      }\n\n      var payload = {\n        grant_type: 'facebook',\n        client_id: gsnApi.getChainId(),\n        access_type: 'offline',\n        username: user,\n        password: facebookToken\n      };\n\n      gsnApi.doAuthenticate(payload);\n    };\n\n    // when initialize\n    // if no profile id, it should create a shopping list to get a new profile id and set to current\n    returnObj.initialize = function() {\n      // get profile\n      var profileId = parseInt(gsnApi.isNull(returnObj.getProfileId(), 0));\n      if (profileId > 0) {\n        returnObj.getProfile(true);\n      }\n\n      $timeout(function() {\n        if (!returnObj.getShoppingList()) {\n          // load shopping lists\n          returnObj.refreshShoppingLists();\n        }\n\n      }, 200);\n      gsnStore.initialize();\n    };\n\n    // when user log out\n    // it should reset shopping list\n    returnObj.logOut = function() {\n      gsnApi.logOut();\n    };\n\n    // proxy method to add item to current shopping list\n    returnObj.addItem = function(item) {\n      var shoppingList = returnObj.getShoppingList();\n      if (shoppingList) {\n        if (gsnApi.isNull(item.ItemTypeId, -1) < 0) {\n          item.ItemTypeId = 6; // Misc or Own Item type\n        }\n\n        shoppingList.addItem(item);\n      }\n    };\n\n    // proxy method to add items to current shopping list\n    returnObj.addItems = function(item) {\n      var shoppingList = returnObj.getShoppingList();\n\n      // TODO: throw error for no current shopping list?\n      return shoppingList.addItems(item);\n    };\n\n    returnObj.isOnList = function(item) {\n      var shoppingList = returnObj.getShoppingList();\n      if (shoppingList) {\n        var slItem = shoppingList.getItem(item.ItemId, item.ItemTypeId);\n        return gsnApi.isNull(slItem, null) !== null;\n      }\n\n      return false;\n    };\n\n    // proxy method to remove item of current shopping list\n    returnObj.removeItem = function(item) {\n      var shoppingList = returnObj.getShoppingList();\n      if (shoppingList) {\n        shoppingList.removeItem(item);\n      }\n    };\n\n    // delete shopping list provided id\n    returnObj.deleteShoppingList = function(list) {\n      list.deleteList();\n      $savedData.allShoppingLists[list.ShoppingListId] = null;\n    };\n\n    // get shopping list provided id\n    returnObj.getShoppingList = function(shoppingListId) {\n      if (gsnApi.isNull(shoppingListId, null) === null) {\n        shoppingListId = returnObj.getShoppingListId();\n      }\n\n      var result = $savedData.allShoppingLists[shoppingListId];\n      return result;\n    };\n\n    // get all shopping lists\n    returnObj.getShoppingLists = function() {\n      var result = [];\n      angular.forEach($savedData.allShoppingLists, function(v, k) {\n        result.push(v);\n      });\n\n      gsnApi.sortOn(result, 'ShoppingListId');\n      result.reverse();\n      return result;\n    };\n\n    // get count of current shopping list\n    returnObj.getShoppingListCount = function() {\n      var list = returnObj.getShoppingList();\n      return list ? list.getCount() : 0;\n    };\n\n    // get the profile object\n    returnObj.getProfile = function(callApi) {\n      if ($profileDefer) return $profileDefer.promise;\n\n      $profileDefer = $q.defer();\n      if (gsnApi.isNull($savedData.profile, null) === null || callApi) {\n        // at this point, we already got the id so proceed to reset other data\n        $timeout(function() {\n          // reset other data\n          $savedData = {\n            allShoppingLists: {},\n            profile: null\n          };\n          returnObj.refreshShoppingLists();\n        }, 5);\n\n\n        gsnApi.getAccessToken().then(function() {\n\n          // don't need to load profile if anonymous\n          if (gsnApi.isAnonymous()) {\n            $savedData.profile = {\n              Id: returnObj.getProfileId(),\n              SiteId: gsnApi.getChainId(),\n              PrimaryStoreId: gsnApi.getSelectedStoreId()\n            };\n\n            $rootScope.$broadcast('gsnevent:profile-load-success', {\n              success: true,\n              response: $savedData.profile\n            });\n            $profileDefer.resolve({\n              success: true,\n              response: $savedData.profile\n            });\n            $profileDefer = null;\n          } else {\n            gsnLoadProfile();\n          }\n        });\n\n      } else {\n        $timeout(function() {\n          $profileDefer.resolve({\n            success: true,\n            response: $savedData.profile\n          });\n          $profileDefer = null;\n        }, 10);\n      }\n\n      return $profileDefer.promise;\n    };\n\n    function gsnLoadProfile() {\n      var url = gsnApi.getProfileApiUrl() + '/By/' + returnObj.getProfileId();\n      $http.get(url, {\n        headers: gsnApi.getApiHeaders()\n      }).success(function(response) {\n        $savedData.profile = response;\n        $rootScope.$broadcast('gsnevent:profile-load-success', {\n          success: true,\n          response: $savedData.profile\n        });\n        $profileDefer.resolve({\n          success: true,\n          response: $savedData.profile\n        });\n        $profileDefer = null;\n      }).error(function(response) {\n        $rootScope.$broadcast('gsnevent:profile-load-failed', {\n          success: false,\n          response: response\n        });\n        $profileDefer.resolve({\n          success: false,\n          response: response\n        });\n        $profileDefer = null;\n      });\n    }\n\n    // when user register\n    // it should convert anonymous profile to perm\n    returnObj.registerProfile = function(p) {\n      return registerOrUpdateProfile(p, false);\n    };\n\n    returnObj.changePassword = function(userName, currentPassword, newPassword) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/ChangePassword';\n        $http.post(url, {\n          UserName: userName,\n          Password: currentPassword,\n          NewPassword: newPassword\n        }, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          deferred.resolve({\n            success: (response === 'true'),\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    // when user recover password\n    // it should call api and return server result\n    returnObj.recoverPassword = function(payload) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/RecoverPassword';\n        $http.post(url, payload, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          deferred.resolve({\n            success: (response === 'true'),\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    returnObj.recoverUsername = function(payload) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/RecoverUsername';\n        $http.post(url, payload, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          deferred.resolve({\n            success: (response === 'true'),\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    returnObj.unsubscribeEmail = function(email) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/Unsubscribe/?email=' + encodeURIComponent(email);\n        $http.post(url, {\n          email: email\n        }, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          deferred.resolve({\n            success: true,\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    // when user update profile\n    // it should restore user old password if none is provided\n    returnObj.updateProfile = function(p) {\n      return registerOrUpdateProfile(p, true);\n    };\n\n    // when user is a registered user\n    // allow for shopping lists refresh\n    returnObj.refreshShoppingLists = function() {\n      if (returnObj.refreshingDeferred) return returnObj.refreshingDeferred.promise;\n\n      // determine if logged in\n      // sync list\n      var deferred = $q.defer();\n      returnObj.refreshingDeferred = deferred;\n      $savedData.allShoppingLists = {};\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getShoppingListApiUrl() + '/List/' + gsnApi.getProfileId();\n        $http.get(url, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          if (response.length > 0) {\n            for (var i = 0; i < response.length; i++) {\n              var list = response[i];\n              list.ShoppingListId = list.Id;\n              var shoppingList = gsnList(list.ShoppingListId, list);\n              $savedData.allShoppingLists[list.ShoppingListId] = shoppingList;\n\n              // grab the first shopping list and make it current list id\n              if (i === 0) {\n                // ajax load first shopping list\n                shoppingList.updateShoppingList();\n\n                gsnApi.setShoppingListId(list.ShoppingListId);\n              }\n            }\n          } else {\n            returnObj.createNewShoppingList();\n          }\n\n          returnObj.refreshingDeferred = null;\n\n          $rootScope.$broadcast('gsnevent:shoppinglists-loaded', {\n            success: true,\n            response: response\n          });\n          deferred.resolve({\n            success: true,\n            response: response\n          });\n        }).error(function(response) {\n\n          returnObj.refreshingDeferred = null;\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    returnObj.getMyRecipes = function() {\n      var url = gsnApi.getProfileApiUrl() + '/GetSavedRecipes/' + gsnApi.getProfileId();\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.rateRecipe = function(recipeId, rating) {\n      var url = gsnApi.getProfileApiUrl() + '/RateRecipe/' + recipeId + '/' + gsnApi.getProfileId() + '/' + rating;\n      return gsnApi.http({}, url, {});\n    };\n\n    returnObj.getMyRecipe = function(recipeId) {\n      var url = gsnApi.getProfileApiUrl() + '/GetSavedRecipe/' + gsnApi.getProfileId() + '/' + recipeId;\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.saveRecipe = function(recipeId, comment) {\n      var url = gsnApi.getProfileApiUrl() + '/SaveRecipe/' + recipeId + '/' + gsnApi.getProfileId() + '?comment=' + encodeURIComponent(comment);\n      return gsnApi.http({}, url, {});\n    };\n\n    returnObj.selectStore = function(storeId) {\n      var url = gsnApi.getProfileApiUrl() + '/SelectStore/' + gsnApi.getProfileId() + '/' + storeId;\n      return gsnApi.http({}, url, {});\n    };\n\n    returnObj.sendContactUs = function(payload) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/SendContactUs';\n\n        $http.post(url, payload, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          deferred.resolve({\n            success: true,\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    returnObj.sendEmail = function(payload) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/SendEmail';\n\n        $http.post(url, payload, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          deferred.resolve({\n            success: true,\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    returnObj.sendEmploymentEmail = function(payload, selectedStoreId) {\n      var deferred = $q.defer();\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + '/SendEmployment/' + selectedStoreId;\n\n        $http.post(url, payload, {\n          headers: gsnApi.getApiHeaders(),\n        }).success(function(response) {\n          deferred.resolve({\n            success: true,\n            response: response\n          });\n        }).error(function(response) {\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    };\n\n    //#region Events Handling\n    $rootScope.$on('gsnevent:shoppinglist-item-response', function(event, args) {\n      var response = args[1],\n        existingItem = args[2],\n        mySavedData = args[3];\n\n      // only process server response if logged in\n      if (gsnApi.isLoggedIn()) {\n\n        if (existingItem.ItemId !== response.ItemId) {\n          mySavedData.items[existingItem.ItemId] = null;\n          existingItem.ItemId = response.ItemId;\n        }\n\n        // retain order\n        if (existingItem.zPriceMultiple) {\n          response.PriceMultiple = existingItem.zPriceMultiple;\n        }\n\n        response.Order = existingItem.Order;\n        mySavedData.items[existingItem.ItemId] = response.d;\n      }\n    });\n\n    $rootScope.$on('gsnevent:profile-setid', function(event, profileId) {\n      // attempt to load profile\n      if (previousProfileId !== profileId) {\n        previousProfileId = profileId;\n        returnObj.getProfile(true);\n      }\n    });\n\n    $rootScope.$on('gsnevent:profile-load-success', function(event, result) {\n      // attempt to set store id\n      if (gsnApi.isNull(result.response.PrimaryStoreId, 0) > 0) {\n        gsnApi.setSelectedStoreId(result.response.PrimaryStoreId);\n      }\n    });\n\n    $rootScope.$on('gsnevent:store-setid', function(event, values) {\n      if (values.newValue !== values.oldValue) {\n        // must check for null because it could be that user just\n        // logged in and he/she would no longer have the anonymous shopping list\n        var currentList = returnObj.getShoppingList();\n        if (currentList) {\n          currentList.updateShoppingList();\n        }\n      }\n    });\n\n    //#endregion\n\n    //#region helper methods\n    function registerOrUpdateProfile(profile, isUpdate) {\n      /// <summary>Helper method for registering or update profile</summary>\n\n      var deferred = $q.defer();\n\n      // clean up model before proceeding\n      // there should not be any space in email or username\n      var email = gsnApi.isNull(profile.Email, '').replace(/\\s+/gi, '');\n      var username = gsnApi.isNull(profile.UserName, '').replace(/\\s+/gi, '');\n      if (username.length <= 0) {\n        username = email;\n      }\n\n      // set empty to prevent update\n      if (email.length <= 0) {\n        email = null;\n      }\n      if (username.length <= 0) {\n        username = null;\n      }\n\n      // setting up the payload, should we also add another level of validation here?\n      var payload = {\n        Email: email,\n        UserName: username,\n        Password: gsnApi.isNull(profile.Password, ''),\n        ReceiveEmail: gsnApi.isNull(profile.ReceiveEmail, false),\n        ReceivePostalMail: gsnApi.isNull(profile.ReceivePostalMail, false),\n        ReceiveSms: gsnApi.isNull(profile.ReceiveSms, true),\n        Phone: gsnApi.isNull(profile.Phone, '').replace(/[^0-9]+/gi, ''),\n        PrimaryStoreId: gsnApi.isNull(profile.PrimaryStoreId, gsnApi.getSelectedStoreId()),\n        FirstName: gsnApi.isNull(profile.FirstName, '').replace(/[`]+/gi, '\\''),\n        LastName: gsnApi.isNull(profile.LastName, '').replace(/[`]+/gi, '\\''),\n        ExternalId: profile.ExternalId,\n        WelcomeSubject: profile.WelcomeSubject,\n        WelcomeMessage: profile.WelcomeMessage,\n        FacebookUserId: profile.FacebookUserId,\n        SiteId: gsnApi.getChainId(),\n        Id: gsnApi.getProfileId()\n      };\n\n      // set empty to prevent update\n      if (payload.Password === '') {\n        payload.Password = null;\n      }\n      if (payload.LastName === '') {\n        payload.LastName = null;\n      }\n      if (payload.FirstName === '') {\n        payload.FirstName = null;\n      }\n      if (gsnApi.isNull(payload.PrimaryStoreId, 0) <= 0) {\n        payload.PrimaryStoreId = null;\n      }\n      if (gsnApi.isNull(profile.ExternalId, '').length <= 0) {\n        profile.ExternalId = null;\n      }\n      if (gsnApi.isNull(profile.FacebookUserId, '').length <= 0) {\n        profile.FacebookUserId = null;\n      }\n\n      if (payload.UserName.length < 3) {\n        deferred.resolve({\n          success: false,\n          response: 'Email/UserName must be at least 3 characters.'\n        });\n        return deferred.promise;\n      }\n\n      if (!isUpdate && (gsnApi.isNull(profile.FacebookToken, '').length <= 0)) {\n        if (gsnApi.isNull(payload.Password, '').length < 6) {\n          deferred.resolve({\n            success: false,\n            response: 'Password must be at least 6 characters.'\n          });\n          return deferred.promise;\n        }\n      }\n\n      if (!gsnApi.getEmailRegEx().test(payload.Email)) {\n        deferred.resolve({\n          success: false,\n          response: 'Email is invalid.'\n        });\n        return deferred.promise;\n      }\n\n      gsnApi.getAccessToken().then(function() {\n        var url = gsnApi.getProfileApiUrl() + (isUpdate ? '/Update' : '/Register');\n        if (gsnApi.isNull(profile.FacebookToken, '').length > 1) {\n          url += 'Facebook';\n          payload.Password = profile.FacebookToken;\n        }\n\n        $http.post(url, payload, {\n          headers: gsnApi.getApiHeaders()\n        }).success(function(response) {\n          // set current profile to response\n          $savedData.profile = response;\n          deferred.resolve({\n            success: true,\n            response: response\n          });\n        }).error(function(response) {\n\n          deferred.resolve({\n            success: false,\n            response: response\n          });\n        });\n      });\n\n      return deferred.promise;\n    }\n    //#endregion\n\n    return returnObj;\n  }\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var storageKey = 'gsnStorage-';\n  var fallbackStorage = {};\n\n  /*jshint -W030 */\n  angular.module('gsn.core').\n  factory('$localStorage', createStorage('localStorage')).\n  factory('$sessionStorage', createStorage('sessionStorage'));\n\n  function createStorage(storageType) {\n    return [\n      '$rootScope',\n      '$window',\n      '$log',\n\n      function(\n        $rootScope,\n        $window,\n        $log\n      ) {\n        function isStorageSupported(storageType) {\n          var supported = $window[storageType];\n\n          // When Safari (OS X or iOS) is in private browsing mode, it appears as though localStorage\n          // is available, but trying to call .setItem throws an exception below:\n          // \"QUOTA_EXCEEDED_ERR: DOM Exception 22: An attempt was made to add something to storage that exceeded the quota.\"\n          if (supported && storageType === 'localStorage') {\n            var key = '__' + Math.round(Math.random() * 1e7);\n\n            try {\n              localStorage.setItem(key, key);\n              localStorage.removeItem(key);\n            } catch (err) {\n              supported = false;\n            }\n          }\n\n          return supported;\n        }\n\n        // #9: Assign a placeholder object if Web Storage is unavailable to prevent breaking the entire AngularJS app\n        var webStorage = isStorageSupported(storageType) || ($log.warn('This browser does not support Web Storage!'), fallbackStorage),\n          $storage = {\n            $default: function(items) {\n              for (var k in items) {\n                angular.isDefined($storage[k]) || ($storage[k] = items[k]);\n              }\n\n              return $storage;\n            },\n            $reset: function(items) {\n              for (var k in $storage) {\n                '$' === k[0] || delete $storage[k];\n              }\n\n              return $storage.$default(items);\n            }\n          },\n          currentStorage,\n          _debounce;\n\n        for (var i = 0, k; i < webStorage.length; i++) {\n          // #8, #10: `webStorage.key(i)` may be an empty string (or throw an exception in IE9 if `webStorage` is empty)\n          (k = webStorage.key(i)) && storageKey === k.slice(0, storageKey.length) && ($storage[k.slice(storageKey.length)] = angular.fromJson(webStorage.getItem(k)));\n        }\n\n        currentStorage = angular.copy($storage);\n\n        $rootScope.$watch(function() {\n          _debounce || (_debounce = setTimeout(function() {\n            _debounce = null;\n\n            if (!angular.equals($storage, currentStorage)) {\n              angular.forEach($storage, function(v, k) {\n                angular.isDefined(v) && '$' !== k[0] && webStorage.setItem(storageKey + k, angular.toJson(v));\n\n                delete currentStorage[k];\n              });\n\n              for (var k in currentStorage) {\n                webStorage.removeItem(storageKey + k);\n              }\n\n              currentStorage = angular.copy($storage);\n            }\n          }, 100));\n        });\n\n        // #6: Use `$window.addEventListener` instead of `angular.element` to avoid the jQuery-specific `event.originalEvent`\n        'localStorage' === storageType && $window.addEventListener && $window.addEventListener('storage', function(event) {\n          if (storageKey === event.key.slice(0, storageKey.length)) {\n            // hack to support older safari (iPad1 or when browsing in private mode)\n            // this assume that gsnStorage should never set anything to null.  Empty object yes, no null.\n            if (typeof(event.newValue) === 'undefined') return;\n\n            event.newValue ? $storage[event.key.slice(storageKey.length)] = angular.fromJson(event.newValue) : delete $storage[event.key.slice(storageKey.length)];\n\n            currentStorage = angular.copy($storage);\n\n            $rootScope.$apply();\n          }\n        });\n\n        return $storage;\n      }\n    ];\n  }\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var serviceId = 'gsnStore';\n  angular.module('gsn.core').service(serviceId, ['$rootScope', '$http', 'gsnApi', '$q', '$timeout', '$location', gsnStore]);\n\n  function gsnStore($rootScope, $http, gsnApi, $q, $timeout, $location) {\n    var returnObj = {};\n\n    $rootScope[serviceId] = returnObj;\n    gsnApi.gsn.$store = returnObj;\n\n    // cache current user selection\n    var _lc = {\n      previousGetStore: null,\n      instoreCoupons: {},\n      quickSearchItems: {},\n      topRecipes: {},\n      faAskTheChef: {},\n      faCookingTip: {},\n      faArticle: {},\n      faRecipe: {},\n      faVideo: {},\n      mealPlanners: {},\n      states: {},\n      adPods: {},\n      specialAttributes: {},\n      circular: null,\n      allVideos: []\n    };\n\n    var betterStorage = {};\n\n    // cache current processed circular data\n    var _cp = {\n      circularByTypeId: {},\n      categoryById: {},\n      itemsById: {},\n      staticCircularById: {},\n      storeCouponById: {},\n      processCompleted: 0, // process completed date\n      lastProcessDate: 0 // number represent a date in month\n    };\n\n    var processingQueue = [];\n\n    // get circular by type id\n    returnObj.getCircular = function(circularTypeId) {\n      var result = _cp.circularByTypeId[circularTypeId];\n      return result;\n    };\n\n    // get all categories\n    returnObj.getCategories = function() {\n      return _cp.categoryById;\n    };\n\n    // refresh current store circular\n    returnObj.refreshCircular = function() {\n      if (_lc.circularIsLoading) return;\n      var config = gsnApi.getConfig();\n      if (config.AllContent) {\n        _lc.circularIsLoading = true;\n        processCircularData(function() {\n          _lc.circularIsLoading = false;\n        });\n        return;\n      }\n\n      _lc.storeId = gsnApi.getSelectedStoreId();\n      if (_lc.storeId <= 0) return;\n\n      _lc.circular = {};\n      _lc.circularIsLoading = true;\n      $rootScope.$broadcast('gsnevent:circular-loading');\n\n      var url = gsnApi.getStoreUrl() + '/AllContent/' + _lc.storeId;\n      gsnApi.http({}, url).then(function(rst) {\n        if (rst.success) {\n          _lc.circular = rst.response;\n          betterStorage.circular = rst.response;\n\n          // resolve is done inside of method below\n          processCircularData();\n          _lc.circularIsLoading = false;\n        } else {\n          _lc.circularIsLoading = false;\n          $rootScope.$broadcast('gsnevent:circular-failed', rst);\n        }\n      });\n    };\n\n    returnObj.searchRecipes = function(searchTerm) {\n      var url = gsnApi.getStoreUrl() + '/SearchRecipe/' + gsnApi.getChainId() + '?q=' + encodeURIComponent(searchTerm);\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.getAvailableVarieties = function(circularItemId) {\n      var url = gsnApi.getStoreUrl() + '/GetAvailableVarieties/' + circularItemId;\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.getQuickSearchItems = function() {\n      var url = gsnApi.getStoreUrl() + '/GetQuickSearchItems/' + gsnApi.getChainId();\n      return gsnApi.http(_lc.quickSearchItems, url);\n    };\n\n    // get all stores from cache\n    returnObj.getStores = function() {\n      var deferred = $q.defer();\n      if (gsnApi.isNull(_lc.previousGetStore, null) !== null) {\n        return _lc.previousGetStore.promise;\n      }\n\n      _lc.previousGetStore = deferred;\n      var storeList = betterStorage.storeList;\n      if (gsnApi.isNull(storeList, []).length > 0) {\n        $timeout(function() {\n          _lc.previousGetStore = null;\n          parseStoreList(storeList);\n          deferred.resolve({\n            success: true,\n            response: storeList\n          });\n        }, 10);\n      } else {\n        $rootScope.$broadcast('gsnevent:storelist-loading');\n        gsnApi.getAccessToken().then(function() {\n          var url = gsnApi.getStoreUrl() + '/List/' + gsnApi.getChainId();\n          $http.get(url, {\n            headers: gsnApi.getApiHeaders()\n          }).success(function(response) {\n            _lc.previousGetStore = null;\n            var stores = response;\n            parseStoreList(stores, true);\n            deferred.resolve({\n              success: true,\n              response: stores\n            });\n            if (stores.length > 0) {\n              $rootScope.$broadcast('gsnevent:storelist-loaded');\n            }\n          });\n        });\n      }\n\n      return deferred.promise;\n    };\n\n    // get the current store\n    returnObj.getStore = function() {\n      var deferred = $q.defer();\n      returnObj.getStores().then(function(rsp) {\n        var data = gsnApi.mapObject(rsp.response, 'StoreId');\n        var result = data[gsnApi.getSelectedStoreId()];\n        deferred.resolve(result);\n      });\n\n      return deferred.promise;\n    };\n\n    // get item by id\n    returnObj.getItem = function(id) {\n      var result = _cp.itemsById[id];\n      return (gsn.isNull(result, null) !== null) ? result : null;\n    };\n\n    returnObj.getAskTheChef = function() {\n      var url = gsnApi.getStoreUrl() + '/FeaturedArticle/' + gsnApi.getChainId() + '/1';\n      return gsnApi.http(_lc.faAskTheChef, url);\n    };\n\n    returnObj.getFeaturedArticle = function() {\n      var url = gsnApi.getStoreUrl() + '/FeaturedArticle/' + gsnApi.getChainId() + '/2';\n      return gsnApi.http(_lc.faArticle, url);\n    };\n\n    returnObj.getFeaturedVideo = function() {\n      var url = gsnApi.getStoreUrl() + '/FeaturedVideo/' + gsnApi.getChainId();\n      return gsnApi.http(_lc.faVideo, url);\n    };\n\n    returnObj.getRecipeVideos = function() {\n      var url = gsnApi.getStoreUrl() + '/RecipeVideos/' + gsnApi.getChainId();\n      return gsnApi.http(_lc.allVideos, url);\n    };\n\n    returnObj.getCookingTip = function() {\n      var url = gsnApi.getStoreUrl() + '/FeaturedArticle/' + gsnApi.getChainId() + '/3';\n      return gsnApi.http(_lc.faCookingTip, url);\n    };\n\n    returnObj.getTopRecipes = function() {\n      var url = gsnApi.getStoreUrl() + '/TopRecipes/' + gsnApi.getChainId() + '/' + 50;\n      return gsnApi.http(_lc.topRecipes, url);\n    };\n\n    returnObj.getFeaturedRecipe = function() {\n      var url = gsnApi.getStoreUrl() + '/FeaturedRecipe/' + gsnApi.getChainId();\n      return gsnApi.http(_lc.faRecipe, url);\n    };\n\n    returnObj.getCoupon = function(couponId) {\n      return _cp.storeCouponById[couponId];\n    };\n\n    returnObj.getStates = function() {\n      var url = gsnApi.getStoreUrl() + '/GetStates';\n      return gsnApi.http(_lc.states, url);\n    };\n\n    returnObj.getInstoreCoupons = function() {\n      return _lc.instoreCoupons;\n    };\n\n    returnObj.getRecipe = function(recipeId) {\n      var url = gsnApi.getStoreUrl() + '/RecipeBy/' + recipeId;\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.getPartial = function(contentName) {\n      if (!contentName) {\n        contentName = 'Home Page';\n      }\n\n      var url = gsnApi.getContentServiceUrl('GetPartial');\n      var today = new Date();\n      var nocache = today.getFullYear() + '' + today.getMonth() + '' + today.getDate() + '' + today.getHours();\n      url += '?name=' + encodeURIComponent(contentName) + '&nocache=' + nocache;\n\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.getArticle = function(articleId) {\n      var url = gsnApi.getStoreUrl() + '/ArticleBy/' + articleId;\n      return gsnApi.http({}, url);\n    };\n\n    returnObj.getMealPlannerRecipes = function() {\n      var url = gsnApi.getStoreUrl() + '/GetMealPlannerRecipes/' + gsnApi.getChainId();\n      return gsnApi.http(_lc.mealPlanners, url);\n    };\n\n    returnObj.hasCompleteCircular = function() {\n      var circ = returnObj.getCircularData();\n      var result = false;\n\n      if (circ) {\n        result = gsnApi.isNull(circ.Circulars, false);\n      }\n\n      if (!result && (gsnApi.isNull(gsnApi.getSelectedStoreId(), 0) > 0)) {\n        returnObj.refreshCircular();\n        result = false;\n      }\n\n      return returnObj.getProcessDate() ? result : null;\n    };\n\n    returnObj.getProcessDate = function() {\n      return _cp.processCompleted;\n    };\n\n    returnObj.getCircularData = function(forProcessing) {\n      if (!_lc.circular) {\n        _lc.circular = betterStorage.circular;\n        if (!forProcessing) {\n          processCircularData();\n        }\n      }\n\n      return _lc.circular;\n    };\n\n    returnObj.initialize = function(isApi) {\n      /// <summary>Initialze store data. this method should be\n      /// written such that, it should do a server retrieval when parameter is null.\n      /// </summary>\n\n      gsnApi.initApp();\n\n      // call api to get stores\n      var config = gsnApi.getConfig();\n      var rawStoreList = config.StoreList;\n      if (rawStoreList) {\n        parseStoreList(rawStoreList, true);\n      }\n\n      returnObj.getStores();\n      if (config.AllContent) {\n        config.AllContent.Circularz = config.AllContent.Circulars;\n        config.AllContent.Circulars = [];\n        angular.forEach(config.AllContent.Circularz, function(circ) {\n          circ.Pagez = circ.Pages;\n          circ.Pages = [];\n        });\n\n        betterStorage.circular = config.AllContent;\n      }\n\n      if (returnObj.hasCompleteCircular()) {\n        // async init data\n        $timeout(processCircularData, 0);\n      }\n    };\n\n    $rootScope.$on('gsnevent:store-setid', function(event, values) {\n      var storeId = values.newValue;\n      var config = gsnApi.getConfig();\n      var hasNewStoreId = (gsnApi.isNull(_lc.storeId, 0) !== storeId);\n      var requireRefresh = hasNewStoreId && !config.AllContent;\n\n      // attempt to load circular\n      if (hasNewStoreId) {\n        _lc.storeId = storeId;\n        _lc.circularIsLoading = false;\n      }\n\n      // always call update circular on set storeId or if it has been more than 20 minutes\n      var currentTime = new Date().getTime();\n      var seconds = (currentTime - gsnApi.isNull(betterStorage.circularLastUpdate, 0)) / 1000;\n      if ((requireRefresh && !_lc.circularIsLoading) || (seconds > 1200)) {\n        returnObj.refreshCircular();\n      } else if (hasNewStoreId) {\n        processCircularData();\n      }\n    });\n\n    return returnObj;\n\n    //#region helper methods\n    function parseStoreList(storeList, isRaw) {\n      if (isRaw) {\n        var stores = storeList;\n        if (typeof(stores) !== 'string') {\n          angular.forEach(stores, function(store) {\n            store.Settings = gsnApi.mapObject(store.StoreSettings, 'StoreSettingId');\n          });\n\n          betterStorage.storeList = stores;\n        }\n      }\n      var search = $location.search();\n      var selectFirstStore = gsnApi.getConfig().isPrerender || search.sfs || search.selectFirstStore || search.selectfirststore;\n      storeList = gsnApi.isNull(storeList, []);\n      var storeByNumber = gsnApi.mapObject(storeList, 'StoreNumber');\n      if (storeList.length === 1 || selectFirstStore) {\n        if (storeList[0].StoreId !== gsnApi.isNull(gsnApi.getSelectedStoreId(), 0)) {\n          gsnApi.setSelectedStoreId(storeList[0].StoreId);\n        }\n      } else if (search.storeid) {\n        var storeById = gsnApi.mapObject(storeList, 'StoreId');\n        gsnApi.setSelectedStoreId(storeById[search.storeid].StoreId);\n      } else if (search.storenbr) {\n        gsnApi.setSelectedStoreId(storeByNumber[search.storenbr].StoreId);\n      } else if (search.store) {\n        var storeByUrl = gsnApi.mapObject(storeList, 'StoreUrl');\n        if (storeByNumber[search.store]) {\n          gsnApi.setSelectedStoreId(storeByNumber[search.store].StoreId);\n        }\n      }\n    }\n\n    function processInstoreCoupon() {\n      var circular = returnObj.getCircularData();\n      // process in-store coupon\n      var items = [];\n      angular.forEach(circular.InstoreCoupons, function(item) {\n        if (item.StoreIds.length <= 0 || item.StoreIds.indexOf(_lc.storeId) >= 0) {\n          item.CategoryName = gsnApi.isNull(_cp.categoryById[item.CategoryId], {\n            CategoryName: ''\n          }).CategoryName;\n          _cp.storeCouponById[item.ItemId] = item;\n          items.push(item);\n        }\n      });\n\n      gsnApi.getConfig().hasStoreCoupon = items.length > 0;\n\n      _lc.instoreCoupons.items = items;\n    }\n\n    function processCoupon() {\n      if (_cp) {\n        $timeout(processInstoreCoupon, 50);\n      }\n    }\n\n    function processCircularData(cb) {\n      var circularData = returnObj.getCircularData(true);\n      if (!circularData) return;\n      if (!circularData.CircularTypes) return;\n\n      betterStorage.circularLastUpdate = new Date().getTime();\n      _lc.storeId = gsnApi.getSelectedStoreId();\n      processingQueue.length = 0;\n\n      // process category into key value pair\n      processingQueue.push(function() {\n        if (_cp.lastProcessDate === (new Date().getDate()) && _cp.categoryById[-1]) return;\n\n        var categoryById = gsnApi.mapObject(circularData.Departments, 'CategoryId');\n\n        categoryById[null] = {\n          CategoryId: null,\n          CategoryName: ''\n        };\n        categoryById[-1] = {\n          CategoryId: -1,\n          CategoryName: 'Misc. Items'\n        };\n        categoryById[-2] = {\n          CategoryId: -2,\n          CategoryName: 'Ingredients'\n        };\n        _cp.categoryById = categoryById;\n\n        return;\n      });\n\n      var circularTypes = gsnApi.mapObject(circularData.CircularTypes, 'Code');\n      var circularByTypes = [];\n      var staticCirculars = [];\n      var items = [];\n      var circulars = gsnApi.isNull(circularData.Circularz, circularData.Circulars);\n      circularData.Circulars = [];\n\n      // foreach Circular\n      angular.forEach(circulars, function(circ) {\n        circ.StoreIds = circ.StoreIds || [];\n        circ.CircularTypeName = (circularTypes[circ.CircularTypeId] || {}).Name;\n        if (circ.StoreIds.length <= 0 || circ.StoreIds.indexOf(_lc.storeId) >= 0) {\n          circularData.Circulars.push(circ);\n          if (!circ.Pagez) {\n            circ.Pagez = circ.Pages;\n          }\n\n          var pages = circ.Pagez;\n          circ.Pages = [];\n\n          angular.forEach(pages, function(page) {\n            if (page.StoreIds.length <= 0 || page.StoreIds.indexOf(_lc.storeId) >= 0) {\n              circ.Pages.push(page);\n            }\n          });\n\n          processCircular(circ, items, circularTypes, staticCirculars, circularByTypes);\n        }\n      });\n\n      processingQueue.push(function() {\n        // set all items\n        circularByTypes.push({\n          CircularTypeId: 99,\n          CircularType: 'All Circulars',\n          items: items\n        });\n\n        // sort by circulartypeid\n        gsnApi.sortOn(circularData.Circulars, 'CircularTypeId');\n        return;\n      });\n\n      // set result\n      processingQueue.push(function() {\n        _cp.itemsById = gsnApi.mapObject(items, 'ItemId');\n        return;\n      });\n\n      processingQueue.push(function() {\n        _cp.circularByTypeId = gsnApi.mapObject(circularByTypes, 'CircularTypeId');\n        return;\n      });\n\n      processingQueue.push(function() {\n        _cp.staticCircularById = gsnApi.mapObject(staticCirculars, 'CircularTypeId');\n        return;\n      });\n\n      processingQueue.push(processCoupon);\n\n      processingQueue.push(function() {\n        if (cb) cb();\n        _cp.lastProcessDate = new Date().getDate();\n        $rootScope.$broadcast('gsnevent:circular-loaded', {\n          success: true,\n          response: circularData\n        });\n        return;\n      });\n\n      processWorkQueue();\n    }\n\n    function processWorkQueue() {\n      if (processingQueue.length > 0) {\n        // this make sure that work get executed in sequential order\n        processingQueue.shift()();\n\n        $timeout(processWorkQueue, 50);\n        return;\n      }\n      _cp.processCompleted = new Date();\n      $rootScope.$broadcast('gsnevent:circular-processed');\n    }\n\n    function processCircular(circ, items, circularTypes, staticCirculars, circularByTypes) {\n      // process pages\n      var pages = circ.Pages;\n      var itemCount = 0;\n      gsnApi.sortOn(pages, 'PageNumber');\n      circ.pages = pages;\n      circ.CircularType = circularTypes[circ.CircularTypeId].Name;\n      circ.ImageUrl = gsnApi.isNull(circ.ImageUrl, {}).replace('http://', '//');\n      var circularMaster = {\n        CircularPageId: pages[0].CircularPageId,\n        CircularType: circ.CircularType,\n        CircularTypeId: circ.CircularTypeId,\n        ImageUrl: pages[0].ImageUrl.replace('http://', '//'),\n        SmallImageUrl: pages[0].SmallImageUrl.replace('http://', '//'),\n        items: []\n      };\n\n      // foreach Page in Circular\n      angular.forEach(pages, function(page) {\n        //var pageCopy = {};\n        //angular.extend(pageCopy, page);\n        //pageCopy.Items = [];\n        itemCount += page.Items.length;\n        page.Circular = circ;\n        page.ImageUrl = page.ImageUrl.replace('http://', '//');\n        page.SmallImageUrl = page.SmallImageUrl.replace('http://', '//');\n\n        processingQueue.push(function() {\n          processCircularPage(items, circularMaster, page);\n        });\n      });\n\n      processingQueue.push(function() {\n        if (gsnApi.isNull(itemCount, 0) > 0) {\n          circularByTypes.push(circularMaster);\n        } else {\n          circularMaster.items = pages;\n          staticCirculars.push(circularMaster);\n        }\n      });\n    }\n\n    function processCircularPage(items, circularMaster, page) {\n      angular.forEach(page.Items, function(item) {\n        item.PageNumber = parseInt(page.PageNumber);\n        item.rect = {\n          x: 0,\n          y: 0\n        };\n        var pos = (item.AreaCoordinates + '').split(',');\n        if (pos.length > 2) {\n          var temp = 0;\n          for (var i = 0; i < 4; i++) {\n            pos[i] = parseInt(pos[i]) || 0;\n          }\n          // swap if bad position\n          if (pos[0] > pos[2]) {\n            temp = pos[0];\n            pos[0] = pos[2];\n            pos[2] = temp;\n          }\n          if (pos[1] > pos[3]) {\n            temp = pos[1];\n            pos[1] = pos[3];\n            pos[3] = temp;\n          }\n\n          item.rect.x = pos[0];\n          item.rect.y = pos[1];\n          item.rect.xx = pos[2];\n          item.rect.yy = pos[3];\n          item.rect.width = pos[2] - pos[0]; // width\n          item.rect.height = pos[3] - pos[1]; // height\n          item.rect.cx = item.rect.width / 2; // center\n          item.rect.cy = item.rect.height / 2;\n        }\n\n        circularMaster.items.push(item);\n        item.ImageUrl = item.ImageUrl.replace('http://', '//');\n        item.SmallImageUrl = item.ImageUrl.replace('upload.gsngrocers.com/', 'upload.brickinc.net/').replace('upload.brickinc.net/', 'cdn2.brickinc.net/rx/120/up/');\n        item.Quantity = item.Quantity || 1;\n        items.push(item);\n      });\n    }\n    //#endregion\n  }\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlAccount';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnProfile', 'gsnApi', '$timeout', 'gsnStore', '$rootScope', '$analytics', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnProfile, gsnApi, $timeout, gsnStore, $rootScope, $analytics) {\n    $scope.activate = activate;\n    $scope.profile = {\n      PrimaryStoreId: gsnApi.getSelectedStoreId(),\n      ReceiveEmail: true\n    };\n\n    $scope.hasSubmitted = false; // true when user has click the submit button\n    $scope.isValidSubmit = true; // true when result of submit is valid\n    $scope.isSubmitting = false; // true if we're waiting for result from server\n    $scope.profileStatus = {\n      profileUpdated: 0\n    };\n    $scope.disableNavigation = false;\n    $scope.profileUpdated = false;\n    $scope.isFacebook = false;\n\n    function activate() {\n      gsnStore.getStores().then(function(rsp) {\n        $scope.stores = rsp.response;\n      });\n\n      gsnProfile.getProfile().then(function(p) {\n        if (p.success) {\n          $scope.profile = angular.copy(p.response);\n          $scope.isFacebook = (gsnApi.isNull($scope.profile.FacebookUserId, '').length > 0);\n        }\n      });\n\n      $scope.profileUpdated = ($scope.currentPath === '/profile/rewardcard/updated');\n    }\n\n    $scope.updateProfile = function() {\n      $scope.$broadcast('autofill:update');\n      var profile = $scope.profile;\n      if ($scope.myForm.$valid) {\n\n        // prevent double submit\n        if ($scope.isSubmitting) return;\n\n        $scope.hasSubmitted = true;\n        $scope.isSubmitting = true;\n        gsnProfile.updateProfile(profile)\n          .then(function(result) {\n            $scope.isSubmitting = false;\n            $scope.isValidSubmit = result.success;\n            if (result.success) {\n              gsnApi.setSelectedStoreId(profile.PrimaryStoreId);\n              // trigger profile retrieval\n              gsnProfile.getProfile(true);\n\n              // Broadcast the update.\n              $rootScope.$broadcast('gsnevent:updateprofile-successful', result);\n              $analytics.eventTrack('profile-update', {\n                category: 'profile',\n                label: result.response.ReceiveEmail\n              });\n\n              // If we have the cituation where we do not want to navigate.\n              if (!$scope.disableNavigation) {\n                $scope.goUrl('/profile/rewardcardupdate');\n              }\n            }\n          });\n      }\n    };\n\n    $scope.activate();\n\n    ////\n    // Handle the event\n    ////\n    $scope.$on('gsnevent:updateprofile-successful', function(evt, result) {\n\n      // We just updated the profile; update the counter.\n      $scope.profileStatus.profileUpdated++;\n    });\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlChangePassword';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnProfile', 'gsnApi', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnProfile, gsnApi) {\n    $scope.activate = activate;\n    $scope.profile = {\n      PrimaryStoreId: gsnApi.getSelectedStoreId(),\n      ReceiveEmail: true\n    };\n\n    $scope.hasSubmitted = false; // true when user has click the submit button\n    $scope.isValidSubmit = true; // true when result of submit is valid\n    $scope.isSubmitting = false; // true if we're waiting for result from server\n\n    function activate() {\n      gsnProfile.getProfile().then(function(p) {\n        if (p.success) {\n          $scope.profile = angular.copy(p.response);\n        }\n      });\n    }\n\n    $scope.changePassword = function() {\n      var profile = $scope.profile;\n      if ($scope.myForm.$valid) {\n\n        // prevent double submit\n        if ($scope.isSubmitting) return;\n\n        $scope.hasSubmitted = true;\n        $scope.isSubmitting = true;\n        gsnProfile.changePassword(profile.UserName, profile.currentPassword, profile.newPassword)\n          .then(function(result) {\n            $scope.isSubmitting = false;\n            $scope.isValidSubmit = result.success;\n          });\n      }\n    };\n\n    $scope.activate();\n    //#region Internal Methods\n\n    //#endregion\n  }\n})(angular);\n\n(function(gsn, angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlCircular';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', '$timeout', 'gsnStore', '$rootScope', '$location', 'gsnProfile', 'gsnApi', '$analytics', '$filter', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, $timeout, gsnStore, $rootScope, $location, gsnProfile, gsnApi, $analytics, $filter) {\n    $scope.activate = activate;\n\n    $scope.pageId = 99; // it's always all items for desktop\n    $scope.loadAll = $scope.loadAll || false;\n    $scope.itemsPerPage = $scope.itemsPerPage || 10;\n    $scope.sortBy = $scope.sortBy || 'CategoryName';\n    $scope.sortByName = $scope.sortByName || 'Department';\n    $scope.actualSortBy = $scope.sortBy;\n\n    $scope.allItems = [];\n    $scope.loadMore = loadMore;\n    $scope.vm = {\n      currentPage: 1,\n      pageCount: 1,\n      loadCount: 0,\n      cacheItems: [],\n      digitalCirc: null,\n      filterBy: $location.search().q,\n      filter: {},\n      pageIdx: 0,\n      circIdx: 0,\n      circular: {\n        CircularTypeName: 'Weekly Ads',\n        Pages: [],\n        IsDummyCircular: true\n      }\n    };\n\n    function activate() {\n      if ($scope.vm.digitalCirc) {\n        return;\n      }\n\n      var config = gsnApi.getConfig();\n      if ($scope.currentPath === '/circular' && (gsnApi.isNull(config.defaultMobileListView, null) === null)) {\n        config.defaultMobileListView = true;\n        var mobileListViewUrl = gsnApi.getThemeConfigDescription('default-mobile-listview');\n        if (gsnApi.browser.isMobile && mobileListViewUrl) {\n          gsnApi.goUrl(mobileListViewUrl);\n          return;\n        }\n      }\n\n      // broadcast message\n      $rootScope.$broadcast('gsnevent:loadads');\n\n      if (gsnStore.hasCompleteCircular()) {\n        var data = gsnStore.getCircularData();\n\n        //Filter circulars\n        if (data.Circulars.length > 0) {\n          var filteredByStoreCircs = [];\n          var storeId = gsnApi.isNull(gsnApi.getSelectedStoreId(), 0);\n          angular.forEach(data.Circulars, function(circ) {\n            if (gsn.contains(circ.StoreIds, storeId)) {\n              filteredByStoreCircs.push(circ);\n            }\n          });\n          data.Circulars = filteredByStoreCircs;\n        } else {\n          return;\n        }\n\n        var myPageIdx = parseInt($location.search().p || $location.search().pg || 0);\n        var myCircIdx = parseInt($location.search().c || 0);\n        if (data.Circulars.length === 1) {\n          myCircIdx = myCircIdx || 1;\n          myPageIdx = myPageIdx || 1;\n        }\n\n        $scope.doSearchInternal();\n        $scope.vm.digitalCirc = data;\n        $scope.vm.circIdx = myCircIdx;\n        $scope.vm.pageIdx = myPageIdx;\n      }\n    }\n\n    $scope.doAddCircularItem = function(evt, tempItem) {\n      var item = gsnStore.getItem(tempItem.ItemId);\n      if (item) {\n        gsnProfile.addItem(item);\n\n        if (gsnApi.isNull(item.Varieties, null) === null) {\n          item.Varieties = [];\n        }\n\n        $scope.vm.selectedItem = item;\n        $scope.gvm.selectedItem = item;\n      }\n    };\n\n    $scope.doToggleCircularItem = function(evt, tempItem) {\n      if ($scope.isOnList(tempItem)) {\n        gsnProfile.removeItem(tempItem);\n      } else {\n        $scope.doAddCircularItem(evt, tempItem);\n      }\n    };\n\n    $scope.toggleSort = function(sortBy) {\n      $scope.sortBy = sortBy;\n      var reverse = (sortBy === $scope.actualSortBy);\n      $scope.actualSortBy = ((reverse) ? '-' : '') + sortBy;\n      $scope.doSearchInternal();\n    };\n\n    $scope.getIndex = function(step) {\n      var newIndex = parseInt($scope.vm.pageIdx || 1) + step;\n      if (newIndex > $scope.vm.pageCount) {\n        newIndex = 1;\n      } else if (newIndex < 1) {\n        newIndex = $scope.vm.pageCount;\n      }\n\n      return newIndex;\n    };\n\n    $scope.$on('gsnevent:shoppinglist-loaded', activate);\n    $scope.$on('gsnevent:digitalcircular-itemselect', $scope.doAddCircularItem);\n\n    $scope.$watch('vm.selectedItem', function(newValue, oldValue) {\n      if (newValue) {\n        if (gsnApi.isNull(newValue.Varieties, []).length > 0) return;\n        if (newValue.LinkedItemCount <= 0) return;\n\n        gsnStore.getAvailableVarieties(newValue.ItemId).then(function(result) {\n          if (result.success) {\n            // this is affecting the UI so render it on the UI thread\n            $timeout(function() {\n              newValue.Varieties = result.response;\n            }, 0);\n          }\n        });\n      }\n    });\n\n    $scope.doSearchInternal = function() {\n      var circularType = gsnStore.getCircular($scope.pageId);\n      var list = gsnProfile.getShoppingList();\n\n      // don't show circular until data and list are both loaded\n      if (gsnApi.isNull(circularType, null) === null || gsnApi.isNull(list, null) === null) return;\n\n      var result1 = $filter('filter')(circularType.items, $scope.vm.filter);\n      var result = $filter('orderBy')($filter('filter')(result1, $scope.vm.filterBy || ''), $scope.actualSortBy);\n      if (!$scope.vm.circularType) {\n        $scope.vm.circularType = circularType;\n        $scope.vm.categories = gsnApi.groupBy(circularType.items, 'CategoryName');\n        $scope.vm.brands = gsnApi.groupBy(circularType.items, 'BrandName');\n      }\n\n      $scope.vm.cacheItems = result;\n      $scope.vm.pageCount = Math.ceil(result.length / $scope.itemsPerPage);\n      $scope.allItems = [];\n      loadMore();\n    };\n\n    $scope.$watch('vm.filterBy', $scope.doSearchInternal);\n    $scope.$watch('vm.filter.BrandName', $scope.doSearchInternal);\n    $scope.$watch('vm.filter.CategoryName', $scope.doSearchInternal);\n    $scope.$watch('vm.pageIdx', setPage);\n    $scope.$watch('vm.circIdx', setPage);\n\n    $scope.$on('gsnevent:circular-loaded', function(event, data) {\n      if (data.success) {\n        $scope.vm.noCircular = false;\n        $timeout(activate, 500);\n      } else {\n        $scope.vm.noCircular = true;\n      }\n    });\n\n    $timeout(activate, 500);\n\n    // activate again in 5 seconds if not responsive\n    $timeout(function() {\n      var items = $scope.vm.cacheItems || [];\n      if (items.length <= 0) {\n        activate();\n      }\n    }, 5000);\n\n    //#region Internal Methods\n    function sortMe(a, b) {\n      if (a.rect.x <= b.rect.x) return a.rect.y - b.rect.y;\n      return a.rect.x - b.rect.x;\n    }\n\n    function setPage(oldValue, newValue) {\n      if (!$scope.vm.digitalCirc) return;\n      if (!$scope.vm.digitalCirc.Circulars) return;\n      if ($scope.vm.digitalCirc.Circulars.length <= 0) return;\n\n      $scope.vm.circular = $scope.vm.digitalCirc.Circulars[$scope.vm.circIdx - 1];\n      if ($scope.vm.circular) {\n        if ($scope.vm.pageIdx < 1) {\n          $scope.vm.pageIdx = 1;\n          return;\n        }\n\n        $scope.vm.pageCount = $scope.vm.circular.Pages.length;\n        $scope.vm.page = $scope.vm.circular.Pages[$scope.vm.pageIdx - 1];\n\n        // something went wrong, redirect to circular home\n        if (!$scope.vm.page) {\n          $scope.goUrl('/circular');\n          return;\n        }\n\n        if (!$scope.vm.page.sorted) {\n          $scope.vm.page.Items.sort(sortMe);\n          $scope.vm.page.sorted = true;\n        }\n      }\n      if (oldValue !== newValue) {\n        var pageIdx = gsnApi.isNull($scope.vm.pageIdx, 1);\n        // must use timeout to sync with UI thread\n        $timeout(function() {\n          // trigger ad refresh for circular page changed\n          $rootScope.$broadcast('gsnevent:digitalcircular-pagechanging', {\n            circularIndex: $scope.vm.circIdx,\n            pageIndex: pageIdx\n          });\n        }, 50);\n\n        var circ = $scope.vm.circular;\n        if (circ) {\n          $analytics.eventTrack('PageChange', {\n            category: 'Circular_Type' + circ.CircularTypeId + '_P' + pageIdx,\n            label: circ.CircularDescription\n          });\n        }\n      }\n    }\n\n    function loadMore() {\n      var items = $scope.vm.cacheItems || [];\n      if (items.length > 0) {\n        var itemsToLoad = $scope.itemsPerPage;\n        if ($scope.loadAll) {\n          itemsToLoad = items.length;\n        }\n\n        var last = $scope.allItems.length - 1;\n        for (var i = 1; i <= itemsToLoad; i++) {\n          var item = items[last + i];\n          if (item) {\n            $scope.allItems.push(item);\n          }\n        }\n      }\n    }\n\n    //#endregion\n  }\n})(gsn, angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlContactUs';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnProfile', 'gsnApi', '$timeout', 'gsnStore', '$interpolate', '$http', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnProfile, gsnApi, $timeout, gsnStore, $interpolate, $http) {\n\n    $scope.activate = activate;\n    $scope.vm = {\n      PrimaryStoreId: gsnApi.getSelectedStoreId()\n    };\n    $scope.masterVm = {\n      PrimaryStoreId: gsnApi.getSelectedStoreId()\n    };\n\n    $scope.hasSubmitted = false; // true when user has click the submit button\n    $scope.isValidSubmit = true; // true when result of submit is valid\n    $scope.isSubmitting = false; // true if we're waiting for result from server\n    $scope.errorResponse = null;\n    $scope.contactSuccess = false;\n    $scope.topics = [];\n    $scope.topicsByValue = {};\n    $scope.storeList = [];\n    $scope.captcha = {};\n    $scope.storesById = {};\n\n    var template;\n\n    $http.get($scope.getThemeUrl('/views/email/contact-us.html'))\n      .success(function(response) {\n        template = response.replace(/data-ctrl-email-preview/gi, '');\n      });\n\n    function activate() {\n      gsnStore.getStores().then(function(rsp) {\n        $scope.stores = rsp.response;\n\n        // make sure that it is order by state, then by name\n        $scope.storesById = gsnApi.mapObject($scope.stores, 'StoreId');\n      });\n\n      gsnProfile.getProfile().then(function(p) {\n        if (p.success) {\n          $scope.masterVm = angular.copy(p.response);\n          $scope.doReset();\n        }\n      });\n\n      $scope.topics = gsnApi.groupBy(getData(), 'ParentOption');\n      $scope.topicsByValue = gsnApi.mapObject($scope.topics, 'key');\n      $scope.parentTopics = $scope.topicsByValue[''];\n\n      $scope.topicsByValue = gsnApi.del($scope.topicsByValue['']);\n    }\n\n    $scope.getSubTopics = function() {\n      return $scope.topicsByValue[$scope.vm.Topic];\n    };\n\n    $scope.getFullStateName = function(store) {\n      return '=========' + store.LinkState.FullName + '=========';\n    };\n\n    $scope.getStoreDisplayName = function(store) {\n      return store.StoreName + ' - ' + store.PrimaryAddress;\n    };\n\n    $scope.doSubmit = function() {\n      var payload = $scope.vm;\n      if ($scope.myContactUsForm.$valid) {\n        if (!$scope.hasReceiveEmail) {\n          gsnApi.del(payload, 'ReceiveEmail');\n        }\n\n        payload.CaptchaChallenge = $scope.captcha.challenge;\n        payload.CaptchaResponse = $scope.captcha.response;\n        payload.Store = $scope.getStoreDisplayName($scope.storesById[payload.PrimaryStoreId]);\n        $scope.email = payload;\n        payload.EmailMessage = $interpolate(template)($scope);\n        // prevent double submit\n        if ($scope.isSubmitting) return;\n\n        $scope.hasSubmitted = true;\n        $scope.isSubmitting = true;\n        $scope.errorResponse = null;\n        gsnProfile.sendContactUs(payload)\n          .then(function(result) {\n            $scope.isSubmitting = false;\n            $scope.isValidSubmit = result.success;\n            if (result.success) {\n              $scope.contactSuccess = true;\n            } else if (typeof(result.response) === 'string') {\n              $scope.errorResponse = result.response;\n            } else {\n              $scope.errorResponse = gsnApi.getServiceUnavailableMessage();\n            }\n          });\n      }\n    };\n\n    $scope.doReset = function() {\n      $scope.vm = angular.copy($scope.masterVm);\n      $scope.vm.ConfirmEmail = $scope.vm.Email;\n    };\n\n    $scope.activate();\n\n    function getData() {\n      return [{\n        'Value': 'Company',\n        'Text': 'Company',\n        'ParentOption': ''\n      }, {\n        'Value': 'Store',\n        'Text': 'Store (specify store below)',\n        'ParentOption': ''\n      }, {\n        'Value': 'Other',\n        'Text': 'Other (specify below)',\n        'ParentOption': ''\n      }, {\n        'Value': 'Employment',\n        'Text': 'Employment',\n        'ParentOption': ''\n      }, {\n        'Value': 'Website',\n        'Text': 'Website',\n        'ParentOption': ''\n      }];\n    }\n  }\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlEmail';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnStore', 'gsnApi', 'gsnProfile', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnStore, gsnApi, gsnProfile) {\n    $scope.activate = activate;\n    $scope.emailShoppingList = doEmailShoppingList;\n    $scope.email = {};\n    $scope.vm = {\n      Message: ''\n    };\n\n    $scope.hasSubmitted = false; // true when user has click the submit button\n    $scope.isValidSubmit = true; // true when result of submit is valid\n    $scope.isSubmitting = false; // true if we're waiting for result from server\n\n    function activate() {\n\n      gsnProfile.getProfile().then(function(p) {\n        if (p.success) {\n          var profile = gsnApi.isNull(angular.copy(p.response), {});\n\n          var email = $scope.email;\n          email.FirstName = profile.FirstName;\n          email.ChainName = gsnApi.getChainName();\n          email.CopyrightYear = (new Date()).getFullYear();\n          email.FromEmail = gsnApi.getRegistrationFromEmailAddress();\n\n          $scope.vm = angular.copy(email, $scope.vm);\n          $scope.vm.Message = '';\n          $scope.vm.Name = (gsnApi.isNull(profile.FirstName, '') + ' ' + gsnApi.isNull(profile.LastName, '')).replace(/^\\s+/gi, '');\n          $scope.vm.EmailFrom = gsnApi.isNull(profile.Email, '');\n        }\n      });\n    }\n\n    $scope.activate();\n\n    //#region Internal Methods\n    function doEmailShoppingList() {\n      /// <summary>submit handler for sending shopping list email</summary>\n\n      var payload = angular.copy($scope.vm);\n      if ($scope.myForm.$valid) {\n        $scope.hasSubmitted = true;\n        payload.Message = 'You are receiving this message because ' + payload.EmailFrom + ' created a shopping list for you to see.<br/>' + payload.Message.replace(/\\n+/gi, '<br/>');\n        gsnProfile.sendEmail(payload).then(function(rsp) {\n          $scope.isValidSubmit = rsp.success;\n        });\n      }\n    }\n    //#endregion\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlEmailPreview';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnStore', 'gsnApi', 'gsnProfile', '$location', myController])\n    .directive(myDirectiveName, myDirective);\n\n  // directive for previewing email\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnStore, gsnApi, gsnProfile, $location) {\n    $scope.activate = activate;\n    $scope.email = {};\n\n    function activate() {\n      gsnProfile.getProfile().then(function(p) {\n        if (p.success) {\n          var profile = gsnApi.isNull(angular.copy(p.response), {});\n\n          var email = $scope.email;\n          email.FirstName = profile.FirstName;\n          email.ChainName = gsnApi.getChainName();\n          email.CopyrightYear = (new Date()).getFullYear();\n          email.FromEmail = gsnApi.getRegistrationFromEmailAddress();\n          angular.copy($location.search(), email);\n        }\n      });\n    }\n\n    $scope.activate();\n  }\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlLogin';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnApi', '$location', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnApi, $location) {\n    $scope.activate = activate;\n    $scope.fromUrl = '/';\n\n    function activate() {\n\n      $scope.fromUrl = decodeURIComponent(gsnApi.isNull($location.search().fromUrl, ''));\n      if (!$scope.isLoggedIn) {\n        $scope.gvm.loginCounter++;\n      } else {\n        $scope.goUrl($scope.fromUrl.length > 0 ? $scope.fromUrl : '/');\n      }\n    }\n\n    $scope.activate();\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlPartialContent';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnApi', 'gsnStore', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnApi, gsnStore) {\n    $scope.activate = activate;\n    $scope.notFound = false;\n    $scope.contentDetail = {\n      url: angular.lowercase(gsnApi.isNull($scope.currentPath.replace(/^\\/+/gi, ''), '').replace(/[\\-]/gi, ' ')),\n      name: '',\n      subName: ''\n    };\n    var partialData = {\n      ContentData: {},\n      ConfigData: {},\n      ContentList: []\n    };\n\n    function activate() {\n      // parse contentName by forward slash\n      var contentNames = $scope.contentDetail.url.split('/');\n      if (contentNames.length > 1) {\n        $scope.contentDetail.subName = contentNames[1];\n      }\n\n      $scope.contentDetail.name = contentNames[0];\n\n      if ($scope.contentDetail.url.indexOf('.aspx') > 0) {\n        // do nothing for aspx page\n        $scope.notFound = true;\n        return;\n      }\n\n      // attempt to retrieve static content remotely\n      gsnStore.getPartial($scope.contentDetail.name).then(function(rst) {\n        if (rst.success) {\n          processData(rst.response);\n        } else {\n          $scope.notFound = true;\n        }\n      });\n    }\n\n    $scope.getContentList = function() {\n      var result = [];\n      if (partialData.ContentList) {\n        for (var i = 0; i < partialData.ContentList.length; i++) {\n          var data = result.push(gsnApi.parseStoreSpecificContent(partialData.ContentList[i]));\n          if (data.Description) {\n            if (gsnApi.isNull($scope.contentDetail.subName, 0).length <= 0) {\n              result.push(data);\n              continue;\n            }\n\n            if (angular.lowercase(data.Headline) === $scope.contentDetail.subName || data.SortBy === $scope.contentDetail.subName) {\n              result.push(data);\n            }\n          }\n        }\n      }\n\n      return result;\n    };\n\n    $scope.getContent = function(index) {\n      var result = [];\n      result.push(gsnApi.parseStoreSpecificContent(partialData.ContentData[index]));\n      return result;\n    };\n\n    $scope.getConfig = function(name) {\n      return gsnApi.parseStoreSpecificContent(partialData.ConfigData[name]) || {};\n    };\n\n    $scope.getConfigDescription = function(name, defaultValue) {\n      var resultObj = $scope.getConfig(name).Description;\n      return gsnApi.isNull(resultObj, defaultValue);\n    };\n\n    $scope.activate();\n\n    //#region Internal Methods\n    function processData(data) {\n      partialData = gsnApi.parsePartialContentData(data);\n    }\n    //#endregion\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n\n  var myDirectiveName = 'ctrlShoppingList';\n\n  angular.module('gsn.core')\n    .controller(myDirectiveName, ['$scope', 'gsnApi', 'gsnProfile', '$timeout', '$rootScope', 'gsnStore', myController])\n    .directive(myDirectiveName, myDirective);\n\n  function myDirective() {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      controller: myDirectiveName\n    };\n\n    return directive;\n  }\n\n  function myController($scope, gsnApi, gsnProfile, $timeout, $rootScope, gsnStore) {\n    $scope.activate = activate;\n    $scope.listviewList = [];\n    $scope.selectedShoppingListId = 0;\n    $scope.hasInitializePrinter = false;\n    $scope.circular = {\n      Circulars: []\n    };\n\n    function activate() {\n      if ($scope.currentPath === '/savedlists') {\n        // refresh list\n        $scope.doInitializeForSavedLists();\n      } else {\n        $timeout(function() {\n          if (gsnProfile.getShoppingList()) {\n            $rootScope.$broadcast('gsnevent:shoppinglist-page-loaded', gsnProfile.getShoppingList());\n          }\n        }, 500);\n      }\n\n      $scope.circular = gsnStore.getCircularData();\n    }\n\n    $scope.doInitializeForSavedLists = function() {\n      $scope.listviewList.length = 0;\n      var lists = gsnApi.isNull(gsnProfile.getShoppingLists(), []);\n      if (lists.length < 1) return;\n\n      for (var i = 0; i < lists.length; i++) {\n        var list = lists[i];\n\n        if (list.getStatus() !== 2) continue;\n\n        list.text = list.getTitle();\n        $scope.listviewList.push(list);\n\n        // set first list as selected list\n        if ($scope.selectedShoppingListId < 1) {\n          $scope.selectedShoppingListId = list.ShoppingListId;\n        }\n      }\n\n    };\n\n    $scope.startNewList = function() {\n      // Get the previous list\n      var previousList = gsnProfile.getShoppingList();\n\n      // Delete the list if there are no items.\n      if (gsnApi.isNull(previousList.allItems(), []).length <= 0) {\n\n        // Delete the shopping List\n        gsnProfile.deleteShoppingList(previousList);\n      }\n\n      // Create the new list\n      gsnProfile.createNewShoppingList().then(function(rsp) {\n\n        // Activate the object\n        activate();\n\n        // Per Request: signal that the list has been deleted.\n        $scope.$broadcast('gsnevent:shopping-list-created');\n      });\n    };\n\n    ////\n    // delete Current List\n    ////\n    $scope.deleteCurrentList = function() {\n      var previousList = gsnProfile.getShoppingList();\n      gsnProfile.deleteShoppingList(previousList);\n      gsnProfile.createNewShoppingList().then(function(rsp) {\n\n        // Activate the object\n        activate();\n\n        // Per Request: signal that the list has been deleted.\n        $scope.$broadcast('gsnevent:shopping-list-deleted');\n      });\n    };\n\n    $scope.getSelectedShoppingListId = function() {\n      return $scope.selectedShoppingListId;\n    };\n\n\n    ////\n    // Can Delete List\n    ////\n    $scope.canDeleteList = function() {\n      return (($scope.selectedShoppingListId !== gsnProfile.getShoppingListId()) && (0 !== gsnProfile.getShoppingListId()));\n    };\n\n    ////\n    // set Selected Shopping List Id\n    ////\n    $scope.setSelectedShoppingListId = function(id) {\n\n      // Store the new.\n      $scope.selectedShoppingListId = id;\n\n      $scope.$broadcast('gsnevent:savedlists-selected', {\n        ShoppingListId: id\n      });\n    };\n\n    $scope.$on('gsnevent:shoppinglists-loaded', activate);\n    $scope.$on('gsnevent:shoppinglists-deleted', activate);\n    $scope.$on('gsnevent:shoppinglist-created', activate);\n    $scope.$on('gsnevent:savedlists-deleted', function() {\n      // select next list\n      $scope.doInitializeForSavedLists();\n      $scope.$broadcast('gsnevent:savedlists-selected', {\n        ShoppingListId: $scope.selectedShoppingListId\n      });\n    });\n\n    $scope.$on('gsnevent:shopping-list-saved', function() {\n      gsnProfile.refreshShoppingLists();\n    });\n\n    $scope.activate();\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  var createDirective, module, pluginName, _i, _len, _ref;\n\n  module = angular.module('gsn.core');\n\n  createDirective = function(name) {\n    return module.directive(name, ['$timeout', function($timeout) {\n      return {\n        restrict: 'AC',\n        link: function(scope, element, attrs) {\n          function loadPlugin() {\n            if (typeof FB !== 'undefined' && FB !== null) {\n              FB.XFBML.parse(element.parent()[0]);\n            } else {\n              $timeout(loadPlugin, 500);\n            }\n          }\n\n          $timeout(loadPlugin, 500);\n        }\n      };\n    }]);\n  };\n\n  _ref = ['fbActivity', 'fbComments', 'fbFacepile', 'fbLike', 'fbLikeBox', 'fbLiveStream', 'fbLoginButton', 'fbName', 'fbProfilePic', 'fbRecommendations'];\n  for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n    pluginName = _ref[_i];\n    createDirective(pluginName);\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnAdUnit', ['gsnStore', '$timeout', 'gsnApi', '$rootScope', '$http', '$templateCache', '$interpolate', function(gsnStore, $timeout, gsnApi, $rootScope, $http, $templateCache, $interpolate) {\n    // Usage: create an adunit and trigger ad refresh\n    //\n    // Creates: 2014-04-05 TomN\n    //\n    var directive = {\n      restrict: 'A',\n      link: link\n    };\n    return directive;\n\n    function link(scope, elm, attrs) {\n      scope.templateHtml = null;\n      var tileId = gsnApi.isNull(attrs.gsnAdUnit, '');\n\n      if (tileId.length > 0) {\n        var templateUrl = gsnApi.getThemeUrl('/../common/views/tile' + tileId + '.html');\n        var templateLoader = $http.get(templateUrl, {\n          cache: $templateCache\n        });\n        var hasTile = false;\n\n        templateLoader.success(function(html) {\n          scope.templateHtml = html;\n        }).then(linkTile);\n      }\n\n      function linkTile() {\n        // ignore duplicate tile\n        if (tileId === 5) {\n          return;\n        }\n\n        if (tileId.length > 0) {\n          if (scope.templateHtml) {\n            elm.html(scope.templateHtml);\n            var html = $interpolate(scope.templateHtml)(scope);\n            elm.html(html);\n\n            // broadcast message\n            $rootScope.$broadcast('gsnevent:loadads');\n          }\n        } else {\n          // find adunit\n          elm.find('.gsnadunit').addClass('brickunit');\n\n          // broadcast message\n          $rootScope.$broadcast('gsnevent:loadads');\n        }\n      }\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnAddHead', ['$window', '$timeout', 'gsnApi', function($window, $timeout, gsnApi) {\n    // Usage:   Add element to head\n    //\n    // Creates: 2014-01-06\n    //\n    /* <div gsn-add-head=\"meta\" data-attributes=\"{'content': ''}\"></div>\n     */\n    var directive = {\n      link: link,\n      restrict: 'A',\n      scope: true\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var elId = 'dynamic-' + (new Date().getTime());\n\n      function activate() {\n        var options = attrs.attributes;\n        var el = angular.element('<' + attrs.gsnAddHead + '>');\n        if (options) {\n          var myAttrs = scope.$eval(options);\n          el.attr('id', elId);\n          angular.forEach(myAttrs, function(v, k) {\n            el.attr(k, v);\n          });\n        }\n\n        angular.element('head')[0].appendChild(el[0]);\n\n        scope.$on('$destroy', function() {\n          angular.element('#' + elId).remove();\n        });\n      }\n\n      activate();\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnAutoFillSync', ['$timeout', function($timeout) {\n    // Usage: Fix syncing issue with autofill form\n    //\n    // Creates: 2014-08-28 TomN\n    //\n    var directive = {\n      restrict: 'A',\n      require: 'ngModel',\n      link: link\n    };\n    return directive;\n\n    function link(scope, elm, attrs, ngModel) {\n      scope.$on('autofill:update', function() {\n        ngModel.$setViewValue(elm.val());\n      });\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnCarousel', ['gsnApi', '$timeout', '$window', function(gsnApi, $timeout, $window) {\n    // Usage:   Display slides\n    //\n    // Creates: 2014-01-06\n    //\n    var directive = {\n      link: link,\n      restrict: 'EA',\n      scope: true\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var options = {\n          interval: attrs.interval,\n          reverse: attrs.reverse || false\n        },\n        cancelRefresh,\n        wasRunning = false,\n        isPlaying = false;\n\n      scope.$slideIndex = 0;\n      scope.activate = activate;\n      scope.slides = [];\n\n      // determine if slide show is current playing\n      scope.isPlaying = function() {\n        return isPlaying;\n      };\n\n      // play slide show\n      scope.play = function() {\n        scope.stop();\n\n        isPlaying = true;\n\n        // set new refresh interval\n        cancelRefresh = $timeout(scope.next, options.interval);\n        return scope.$slideIndex;\n      };\n\n      // pause slide show\n      scope.stop = function() {\n        if (isPlaying) {\n          if (gsnApi.isNull(cancelRefresh, null) !== null) {\n            try {\n              $timeout.cancel(cancelRefresh);\n            } catch (e) {}\n          }\n        }\n\n        isPlaying = false;\n      };\n\n      // go to next slide\n      scope.next = function() {\n        $timeout(function() {\n          scope.$slideIndex = doIncrement(scope.play(), 1);\n        }, 5);\n      };\n\n      // go to previous slide\n      scope.prev = function() {\n        $timeout(function() {\n          scope.$slideIndex = doIncrement(scope.play(), -1);\n        }, 5);\n      };\n\n      // go to specfic slide index\n      scope.selectIndex = function(slideIndex) {\n        $timeout(function() {\n          scope.$slideIndex = slideIndex;\n          return scope.play();\n        }, 5);\n      };\n\n      // get the current slide\n      scope.currentSlide = function() {\n        return scope.slides[scope.currentIndex()];\n      };\n\n      // add slide\n      scope.addSlide = function(slide) {\n        return scope.slides.push(slide);\n      };\n\n      // remove a slide\n      scope.removeSlide = function(slide) {\n        //get the index of the slide inside the carousel\n        var index = scope.indexOf(slide);\n        return scope.slides.splice(index, 1);\n      };\n\n      // get a slide index\n      scope.indexOf = function(slide) {\n        if (typeof(slide.indexOf) !== 'undefined') {\n          return slide.indexOf(slide);\n        } else if (typeof(scope.slides.length) !== 'undefined') {\n          // this is a loop because of indexOf does not work in IE\n          for (var i = 0; i < scope.slides.length; i++) {\n            if (scope.slides[i] === slide) {\n              return i;\n            }\n          }\n        }\n\n        return -1;\n      };\n\n      // get current slide index\n      scope.currentIndex = function() {\n        var reverseIndex = (scope.slides.length - scope.$slideIndex - 1) % scope.slides.length;\n        reverseIndex = (reverseIndex < 0) ? 0 : scope.slides.length - 1;\n\n        return options.reverse ? reverseIndex : scope.$slideIndex;\n      };\n\n      // watch index and make sure it doesn't get out of range\n      scope.$watch('$slideIndex', function(newValue) {\n        var checkValue = doIncrement(scope.$slideIndex, 0);\n\n        // on index change, make sure check value is correct\n        if (checkValue !== newValue) {\n          $timeout(function() {\n            scope.$slideIndex = checkValue;\n          }, 5);\n        }\n      });\n\n      // cancel timer if it is running\n      scope.$on('$destroy', scope.stop);\n\n      scope.activate();\n\n      //#region private functions\n      // initialize\n      function activate() {\n        var slides = scope.$eval(attrs.slides);\n        if (gsnApi.isNull(slides, []).length <= 0) {\n          $timeout(activate, 200);\n          return;\n        }\n\n        scope.slides = slides;\n        scope.selectIndex(0);\n        var win = angular.element($window);\n        win.blur(function() {\n          wasRunning = scope.isPlaying();\n          scope.stop();\n        });\n\n        win.focus(function() {\n          if (wasRunning) {\n            scope.play();\n          }\n        });\n\n        return;\n      }\n\n      // safe increment\n      function doIncrement(slideIndex, inc) {\n        var newValue = slideIndex + inc;\n        newValue = ((newValue < 0) ? scope.slides.length - 1 : newValue) % scope.slides.length;\n        return gsnApi.isNaN(newValue, 0);\n      }\n      //#endregion\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnDigitalCirc', ['$timeout', '$rootScope', '$analytics', 'gsnApi', '$location',\n    function($timeout, $rootScope, $analytics, gsnApi, $location) {\n      // Usage: create classic hovering digital circular\n      //\n      // Creates: 2013-12-12 TomN\n      //\n      var directive = {\n        restrict: 'EA',\n        scope: false,\n        link: link\n      };\n      return directive;\n\n      function link(scope, element, attrs) {\n        scope.$watch(attrs.gsnDigitalCirc, function(newValue) {\n          if (newValue) {\n            if (newValue.Circulars.length > 0) {\n              var el = element.find('div');\n              var plugin = el.digitalCirc({\n                data: newValue,\n                browser: gsnApi.browser,\n                onItemSelect: function(plug, evt, item) {\n                  // must use timeout to sync with UI thread\n                  $timeout(function() {\n                    $rootScope.$broadcast('gsnevent:digitalcircular-itemselect', item);\n                  }, 50);\n                },\n                onCircularDisplaying: function(plug, circIdx, pageIdx) {\n                  // must use timeout to sync with UI thread\n                  $timeout(function() {\n                    // trigger ad refresh for circular page changed\n                    $rootScope.$broadcast('gsnevent:digitalcircular-pagechanging', {\n                      plugin: plug,\n                      circularIndex: circIdx,\n                      pageIndex: pageIdx\n                    });\n                  }, 50);\n\n                  var circ = plug.getCircular(circIdx);\n                  if (circ) {\n                    $analytics.eventTrack('PageChange', {\n                      category: 'Circular_Type' + circ.CircularTypeId + '_P' + (pageIdx + 1),\n                      label: circ.CircularDescription\n                    });\n                  }\n\n                  return false;\n                }\n              });\n            }\n          }\n        });\n      }\n    }\n  ]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnDynamic', ['$compile', function($compile) {\n    var directive = {\n      restrict: 'A',\n      replace: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      scope.$watch(attrs.dynamic, function(html) {\n        element.html(html);\n        $compile(element.contents())(scope);\n      });\n    }\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  var createDirective, module, pluginName, _i, _len, _ref;\n\n  module = angular.module('gsn.core');\n\n  createDirective = function(name) {\n    return module.directive(name, ['gsnStore', 'gsnApi', function(gsnStore, gsnApi) {\n      return {\n        restrict: 'AC',\n        scope: true,\n        link: function(scope, element, attrs) {\n          var currentStoreId = gsnApi.getSelectedStoreId();\n\n          if (attrs.contentPosition) {\n            var dynamicData = gsnApi.parseStoreSpecificContent(gsnApi.getHomeData().ContentData[attrs.contentPosition]);\n            if (dynamicData && dynamicData.Description) {\n              element.html(dynamicData.Description);\n              return;\n            }\n          }\n\n          scope.item = {};\n          if (name === 'gsnFtArticle') {\n            gsnStore.getFeaturedArticle().then(function(result) {\n              if (result.success) {\n                result.response.ImageUrl = gsnApi.isNull(result.response.ImageUrl, {}).replace('http://', '//');\n                scope.item = result.response;\n              }\n            });\n          } else if (name === 'gsnFtRecipe') {\n            gsnStore.getFeaturedRecipe().then(function(result) {\n              if (result.success) {\n                result.response.ImageUrl = gsnApi.isNull(result.response.ImageUrl, {}).replace('http://', '//');\n                angular.forEach(result.response.Images, function(item) {\n                  item.RecipeImageUrl = (item.RecipeImageUrl || {}).replace('http://', '//');\n                });\n                scope.item = result.response;\n              }\n            });\n          } else if (name === 'gsnFtAskthechef') {\n            gsnStore.getAskTheChef().then(function(result) {\n              if (result.success) {\n                result.response.ImageUrl = gsnApi.isNull(result.response.ImageUrl, {}).replace('http://', '//');\n                scope.item = result.response;\n              }\n            });\n          } else if (name === 'gsnFtVideo') {\n            gsnStore.getFeaturedVideo().then(function(result) {\n              if (result.success) {\n                result.response.Thumbnail = gsnApi.isNull(result.response.Thumbnail, {}).replace('http://', '//');\n                scope.item = result.response;\n              }\n            });\n          } else if (name === 'gsnFtCookingtip') {\n            gsnStore.getCookingTip().then(function(result) {\n              if (result.success) {\n                result.response.ImageUrl = gsnApi.isNull(result.response.ImageUrl, {}).replace('http://', '//');\n                scope.item = result.response;\n              }\n            });\n          } else if (name === 'gsnFtConfig') {\n            scope.item = gsnApi.parseStoreSpecificContent(gsnApi.getHomeData().ConfigData[attrs.gsnFtConfig]);\n            if (attrs.overwrite && (gsnApi.isNull(scope.item.Description, '').length > 0)) {\n              element.html(scope.item.Description);\n            }\n          } else if (name === 'gsnFtContent') {\n            // do nothing, content already being handled by content position\n          }\n        }\n      };\n    }]);\n  };\n\n  _ref = ['gsnFtArticle', 'gsnFtRecipe', 'gsnFtAskthechef', 'gsnFtCookingtip', 'gsnFtVideo', 'gsnFtConfig', 'gsnFtContent'];\n  for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n    pluginName = _ref[_i];\n    createDirective(pluginName);\n  }\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  /**\n   * allow width to be flexible\n   */\n  myModule.directive('gsnFlexibleWidth', ['debounce', '$window', function(debounce, $window) {\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      function updateWidth() {\n        element.css({\n          width: element.parent()[0].offsetWidth + 'px'\n        });\n      }\n\n      var myUpdateWith = debounce(updateWidth, 200);\n      angular.element($window).on('resize', myUpdateWith);\n      myUpdateWith();\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnFlowPlayer', ['$timeout', 'gsnApi', '$rootScope', '$routeParams', function($timeout, gsnApi, $rootScope, $routeParams) {\n    // Usage: add 3rd party videos\n    //\n    // Creates: 2013-12-12 TomN\n    //\n    var directive = {\n      restrict: 'EA',\n      replace: true,\n      scope: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n\n      scope.play = function(url, title) {\n\n        scope.videoTitle = title;\n        scope.videoName = name;\n\n        flowplayer(attrs.gsnFlowPlayer, attrs.swf, {\n          clip: {\n            url: url,\n            autoPlay: true,\n            autoBuffering: true // <- do not place a comma here\n          }\n        });\n\n        $rootScope.$broadcast('gsnevent:loadads');\n      };\n\n      if ($routeParams.title) {\n        scope.videoTitle = $routeParams.title;\n      }\n\n      $timeout(function() {\n        var el = angular.element('a[title=\"' + scope.vm.featuredVideo.Title + '\"]');\n        el.click();\n      }, 500);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnFluidVids', ['$sce', function($sce) {\n    // Usage: add 3rd party videos\n    //\n    // Creates: 2013-12-12 TomN\n    //\n    var directive = {\n      restrict: 'EA',\n      replace: true,\n      scope: true,\n      link: link,\n      template: '<div class=\"fluidvids\">' +\n        '<iframe data-ng-src=\"{{ video }}\" allowfullscreen=\"\" frameborder=\"0\"></iframe>' +\n        '</div>'\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      element.on('scroll', function() {\n        var ratio = (attrs.height / attrs.width) * 100;\n        element[0].style.paddingTop = ratio + '%';\n      });\n\n      scope.video = $sce.trustAsResourceUrl(attrs.gsnFluidVids);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnFrame', ['$interpolate', '$http', '$templateCache', 'gsnApi', function($interpolate, $http, $templateCache, gsnApi) {\n    // Usage: add static content frame\n    //\n    // Creates: 2013-12-12 TomN\n    //\n    var directive = {\n      restrict: 'A',\n      scope: {\n        item: '='\n      },\n      link: link\n    };\n    return directive;\n\n    function link(scope, elm, attrs) {\n\n      var templateUrl = gsnApi.getThemeUrl(attrs.gsnFrame);\n      var templateLoader = $http.get(templateUrl, {\n        cache: $templateCache\n      });\n      scope.templateHtml = '';\n\n      templateLoader.success(function(html) {\n        scope.templateHtml = html;\n      }).then(function(response) {\n        var html = $interpolate(scope.templateHtml)(scope.item);\n        html = html.replace('<title></title>', '<title>' + scope.item.Title + '</title>');\n        html = html.replace('<body></body>', '<body>' + scope.item.Description + '</body>');\n        var iframe = gsnApi.loadIframe(elm, html);\n        iframe.setAttribute('width', '100%');\n        iframe.setAttribute('frameborder', '0');\n        iframe.setAttribute('scrolling', 'no');\n        iframe.setAttribute('id', 'static-content-frame');\n      });\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnHoverSync', ['$window', '$timeout', 'debounce', function($window, $timeout, debounce) {\n\n    var directive = {\n      link: link,\n      restrict: 'A',\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var doDisplay = debounce(function(e) {\n        var ppos = element.parent().offset();\n        var pos = element.offset();\n        var rect = element[0].getBoundingClientRect();\n        var el = angular.element(attrs.gsnHoverSync);\n\n        el.css({\n          top: pos.top - ppos.top,\n          left: pos.left - ppos.left,\n          width: rect.width,\n          height: rect.height\n        }).show();\n        if (rect.height < 60) {\n          el.addClass('link-inline');\n        } else {\n          el.removeClass('link-inline');\n        }\n      }, 200);\n\n      element.on('mouseover', doDisplay);\n      element.on('click', doDisplay);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnHtmlCapture', ['$window', '$timeout', function($window, $timeout) {\n    // Usage:   bind html back into some property\n    //\n    // Creates: 2014-01-06\n    //\n    var directive = {\n      link: link,\n      restrict: 'A'\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var timeout = parseInt(attrs.timeout);\n      var continousMonitor = timeout > 0;\n\n      if (timeout <= 0) {\n        timeout = 200;\n      }\n\n      var refresh = function() {\n        scope.$apply(attrs.gsnHtmlCapture + ' = \"' + element.html().replace(/\"/g, '\\\\\"') + '\"');\n        var noData = scope[attrs.gsnHtmlCapture].replace(/\\s+/gi, '').length <= 0;\n        if (noData) {\n          $timeout(refresh, timeout);\n          return;\n        }\n        if (continousMonitor) {\n          $timeout(refresh, timeout);\n        }\n      };\n\n      $timeout(refresh, timeout);\n    }\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnLogin', ['gsnApi', '$route', '$routeParams', '$location', 'gsnProfile', function(gsnApi, $route, $routeParams, $location, gsnProfile) {\n    // Usage: login capability\n    //\n    // Creates: 2013-12-12 TomN\n    //\n    var directive = {\n      restrict: 'EA',\n      controller: ['$scope', '$element', '$attrs', controller]\n    };\n    return directive;\n\n    function controller($scope, $element, $attrs) {\n      $scope.activate = activate;\n      $scope.profile = {};\n      $scope.fromUrl = null;\n\n      $scope.hasSubmitted = false; // true when user has click the submit button\n      $scope.isValidSubmit = true; // true when result of submit is valid\n      $scope.isSubmitting = false; // true if we're waiting for result from server\n\n      function activate() {\n        $scope.fromUrl = decodeURIComponent(gsnApi.isNull($routeParams.fromUrl, ''));\n      }\n\n      $scope.$on('gsnevent:login-success', function(evt, result) {\n        if ($scope.currentPath === '/signin') {\n          if ($scope.fromUrl) {\n            $location.url($scope.fromUrl);\n          } else if ($scope.isLoggedIn) {\n            $location.url('/');\n          }\n        } else {\n          // reload the page to accept the login\n          $route.reload();\n        }\n\n        $scope.$emit('gsnevent:closemodal');\n      });\n\n      $scope.$on('gsnevent:login-failed', function(evt, result) {\n        $scope.isValidSubmit = false;\n        $scope.isSubmitting = false;\n      });\n\n      $scope.login = function() {\n        $scope.isSubmitting = true;\n        $scope.hasSubmitted = true;\n        gsnProfile.login($element.find('#usernameField').val(), $element.find('#passwordField').val());\n      };\n      $scope.activate();\n\n      //#region Internal Methods\n      //#endregion\n    }\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnModal', ['$compile', '$timeout', '$location', '$http', '$templateCache', '$rootScope', 'gsnApi', '$window', function($compile, $timeout, $location, $http, $templateCache, $rootScope, gsnApi, $window) {\n\n    /***\n     * simple directive\n     * @type {Object}\n     */\n    var directive = {\n      link: link,\n      scope: true,\n      restrict: 'AE'\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var myHtml, templateLoader, tplURL, track, hideCb, startTime, endTime, timeoutOfOpen;\n      tplURL = scope.$eval(attrs.gsnModal);\n      scope.$location = $location;\n      myHtml = '';\n      templateLoader = $http.get(tplURL, {\n        cache: $templateCache\n      }).success(function(html) {\n        myHtml = '<div class=\"myModalForm\" style=\"display: block\"><div class=\"modal-dialog\">' + html + '</div></div>\"';\n        return myHtml;\n      });\n      if (attrs.track) {\n        track = scope.$eval(attrs.track);\n      }\n      hideCb = scope.$eval(attrs.hideCb);\n\n      function hideCallback() {\n        endTime = new Date();\n        if (track) {\n          if (!track.property)\n            track.property = endTime.getTime() - startTime.getTime();\n\n          $rootScope.$broadcast('gsnevent:gsnmodal-hide', element, track);\n          if (typeof(hideCb) === 'function') {\n            hideCb();\n          }\n        }\n      }\n\n      scope.closeModal = function(shouldReload) {\n        if (timeoutOfOpen)\n          $timeout.cancel(timeoutOfOpen);\n        if (shouldReload !== undefined && shouldReload)\n          window.top.location.reload();\n        return gmodal.hide();\n      };\n\n      scope.openModal = function(e) {\n        $rootScope.$broadcast('gsnevent:gsnmodal-show', element, track);\n        startTime = new Date();\n        if (e) {\n          if (e.preventDefault) {\n            e.preventDefault();\n          }\n        }\n        var forceShow = false;\n        if (attrs.forceShow) {\n          forceShow = true;\n        }\n\n        if (!gmodal.isVisible || forceShow) {\n          if (attrs.item) {\n            scope.item = scope.$eval(attrs.item);\n          }\n          templateLoader.then(function() {\n            var $modalElement = angular.element($compile(myHtml)(scope));\n            return gmodal.show({\n              content: $modalElement[0],\n              hideOn: attrs.hideOn || 'click,esc,tap',\n              cls: attrs.cls,\n              timeout: attrs.timeout,\n              closeCls: attrs.closeCls || 'close modal',\n              disableScrollTop: attrs.disableScrollTop\n            }, hideCallback);\n          });\n        }\n        return scope;\n      };\n      scope.hideModal = scope.closeModal;\n      scope.showModal = scope.openModal;\n\n      scope.goUrl = function(url, target) {\n        if (gsnApi.isNull(target, '') === '_blank') {\n          $window.open(url, '');\n          return;\n        }\n\n        $location.url(url);\n        scope.closeModal();\n      };\n\n      if (attrs.showIf) {\n        scope.$watch(attrs.showIf, function(newValue) {\n          if (newValue > 0) {\n            timeoutOfOpen = $timeout(scope.openModal, 1550);\n          }\n        });\n      }\n\n      if (attrs.show) {\n        scope.$watch(attrs.show, function(newValue) {\n          if (newValue) {\n            timeoutOfOpen = $timeout(scope.openModal, 550);\n          } else {\n            $timeout(scope.closeModal, 550);\n          }\n        });\n      }\n\n      if (attrs.eventToClose) {\n        scope.$on(attrs.eventToClose, function() {\n          $timeout(scope.closeModal, 5);\n        });\n      }\n    };\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('numbersOnly', function() {\n    return {\n      require: 'ngModel',\n      link: function(scope, element, attrs, modelCtrl) {\n        modelCtrl.$parsers.push(function(inputValue) {\n          // this next if is necessary for when using ng-required on your input.\n          // In such cases, when a letter is typed first, this parser will be called\n          // again, and the 2nd time, the value will be undefined\n          if (inputValue === undefined) return '';\n          var transformedInput = inputValue.replace(/[^0-9]/g, '');\n          if (transformedInput !== inputValue) {\n            modelCtrl.$setViewValue(transformedInput);\n            modelCtrl.$render();\n          }\n\n          return transformedInput;\n        });\n      }\n    };\n  });\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n  myModule.directive('gsnPartialContent', ['$timeout', 'gsnStore', 'gsnApi', '$location', '$anchorScroll', function($timeout, gsnStore, gsnApi, $location, $anchorScroll) {\n    // Usage:   allow for store specific partial content\n    //\n    // Creates: 2015-02-26\n    //\n    var directive = {\n      link: link,\n      restrict: 'EA',\n      scope: true,\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var currentPath = gsnApi.isNull($location.path(), '');\n      attrs.gsnPartialContent = angular.lowercase(attrs.gsnPartialContent || currentPath).replace(/^\\/+|\\/+$/, '').replace(/[\\-\\/]/gi, ' ');\n      scope.activate = activate;\n      scope.pcvm = {\n        hasScript: false,\n        notFound: false,\n        isLoading: true,\n        layout: 'default',\n        tab: $location.search().tab || 0\n      };\n      scope.partialContents = [];\n      scope.contentDetail = {\n        url: attrs.gsnPartialContent\n      };\n      var partialData = {\n        ContentData: {},\n        ConfigData: {},\n        ContentList: []\n      };\n\n      function activate() {\n        // attempt to retrieve static content remotely\n        gsnStore.getPartial(scope.contentDetail.url).then(function(rst) {\n          scope.pcvm.hasScript = false;\n          scope.pcvm.isLoading = false;\n          if (rst.success) {\n            scope.pcvm.notFound = rst.response === 'null';\n            processData(rst.response);\n          }\n        });\n      }\n      scope.getContentList = function() {\n        var result = [];\n        if (partialData.ContentList) {\n          for (var i = 0; i < partialData.ContentList.length; i++) {\n            var data = gsnApi.parseStoreSpecificContent(partialData.ContentList[i]);\n            if (data.Headline || data.SortBy) {\n              // match any script with src\n              if (/<script.+src=/gi.test(data.Description || '')) {\n                scope.pcvm.hasScript = true;\n              }\n              result.push(data);\n            }\n          }\n        }\n        return result;\n      };\n      scope.getContent = function(index) {\n        return gsnApi.parseStoreSpecificContent(partialData.ContentData[index]);\n      };\n      scope.getConfig = function(name) {\n        return gsnApi.parseStoreSpecificContent(partialData.ConfigData[name]) || {};\n      };\n      scope.getConfigDescription = function(name, defaultValue) {\n        var resultObj = scope.getConfig(name).Description;\n        return gsnApi.isNull(resultObj, defaultValue);\n      };\n      scope.activate();\n      //#region Internal Methods\n      function processData(data) {\n        partialData = gsnApi.parsePartialContentData(data);\n        scope.partialContents = scope.getContentList();\n        scope.pcvm.layout = scope.getConfig('layout').Description || 'default';\n        if ($location.hash()) {\n          $timeout(function() {\n            $anchorScroll();\n            angular.element('a[href=\"#' + $location.hash() + '\"]').click();\n          }, 1000);\n        }\n      }\n      //#endregion\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnPopover', ['$window', '$interpolate', '$timeout', 'debounce', function($window, $interpolate, $timeout, debounce) {\n    // Usage:   provide mouse hover capability\n    //\n    // Creates: 2014-01-16\n    //\n    var directive = {\n      link: link,\n      restrict: 'AE'\n    };\n    return directive;\n\n    function hidePopup() {\n      $timeout(function() {\n        angular.element('.gsn-popover').slideUp();\n      }, 1500);\n    }\n\n    function link(scope, element, attrs) {\n      var text = '',\n        title = attrs.title || '';\n\n      // wait until finish interpolation\n      $timeout(function() {\n        text = angular.element(attrs.selector).html() || '';\n      }, 50);\n\n      var popover = angular.element('.gsn-popover');\n      if (popover.length > 0) {\n        var myTimeout;\n        var myHidePopup = debounce(hidePopup, 1500);\n        element.mousemove(function(e) {\n          angular.element('.gsn-popover .popover-title').html($interpolate('<div>' + title + '</div>')(scope).replace('data-ng-src', 'src'));\n          angular.element('.gsn-popover .popover-content').html($interpolate('<div>' + text + '</div>')(scope).replace('data-ng-src', 'src'));\n\n          // reposition\n          var offset = angular.element(this).offset();\n          var height = popover.show().height();\n\n          angular.element('.gsn-popover').css({\n            top: e.clientY + 15,\n            left: e.clientX + 15\n          }).show();\n          myHidePopup();\n        }).mouseleave(myHidePopup);\n        popover.mousemove(myHidePopup);\n      } else { // fallback with qtip\n        element.qtip({\n          content: {\n            text: function() {\n              var rst = $interpolate('<div>' + text + '</div>')(scope).replace('data-ng-src', 'src');\n              return rst;\n            },\n            title: function() {\n              var rst = $interpolate('<div>' + title + '</div>')(scope).replace('data-ng-src', 'src');\n              return (rst.replace(/\\s+/gi, '').length <= 0) ? null : rst;\n            }\n          },\n          style: {\n            classes: attrs.classes || 'qtip-light qtip-rounded qtip-shadow'\n          },\n          show: {\n            event: 'click mouseover',\n            solo: true\n          },\n          hide: {\n            distance: 1500\n          },\n          position: {\n            // my: 'bottom left',\n            at: 'bottom left'\n          }\n        });\n      }\n\n      scope.$on('$destroy', function() {\n        if (popover.length <= 0) {\n          element.qtip('destroy', true); // Immediately destroy all tooltips belonging to the selected elements\n        }\n      });\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnPopoverDialog', ['gsnApi', '$localStorage', '$compile', function(gsnApi, $localStorage, $compile) {\n    return {\n      restrict: 'EA',\n      template: '<div id=\"myProductDetailsModal\" class=\"modal fade\" role=\"dialog\"><div class=\"modal-dialog\"><div class=\"modal-content\"><div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button><h4 class=\"modal-title\">{{productData.Description}}</h4> </div><div class=\"modal-body\"><div class=\"row\" style=\"border-top:0;\" ><div class=\"col-md-6\"><img ng-show=\"productData.ImageUrl\" data-ng-src=\"{{productData.ImageUrl}}\" alt=\"[Product Image]\" style=\"max-width: 200px; max-height: 200px;min-width: 200px; min-height: 200px\"/></div><div class=\"col-md-6\"><div class=\"row\" style=\"border-top:0;\"><div class=\"col-md-6 align-left\"><label>UPC:</label></div><div class=\"col-md-6 align-left\"><label>{{productData.UPC11}}</label></div></div><div class=\"row\" style=\"border-top:0;\"><div class=\"col-md-6 align-left\"><label>Size:</label></div><div class=\"col-md-6 align-left\"><label>{{productData.ItemExtendedSize}}</label></div></div><div class=\"row\" style=\"border-top:0;\"><div class=\"col-md-6 align-left\"><label>SalePrice:</label></div><div class=\"col-md-6 align-left\"><label ng-show=\"productData.SalePrice\">${{productData.SalePrice.toFixed(2)}}</label></div></div><div class=\"row\" style=\"border-top:0;\"><div class=\"col-md-6 align-left\"><label>Brand:</label></div><div class=\"col-md-6 align-left\"><label>{{productData.BrandName}}</label></div></div></div></div></div><div class=\"modal-footer\"><button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button></div></div></div></div>',\n\n      link: function(scope, element, attrs) {}\n    };\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnProfileInfo', ['gsnApi', 'gsnProfile', '$interpolate', function(gsnApi, gsnProfile, $interpolate) {\n    // Usage: add profile info\n    //\n    // Creates: 2013-12-12 TomN\n    // History:\n    //          2015-02-27 TomN - add ability to interpolate gsnProfileInfo data\n    //\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var compiledTemplate;\n\n      function setProfileData() {\n        gsnProfile.getProfile().then(function(rst) {\n          if (rst.success) {\n            scope.profile = rst.response;\n            element.html('');\n            var html = '<p>welcome, ' + scope.profile.FirstName + ' ' + scope.profile.LastName + '</p>';\n            if (attrs.gsnProfileInfo) {\n              if (compiledTemplate === undefined) {\n                compiledTemplate = $interpolate(attrs.gsnProfileInfo.replace(/\\[+/gi, '{{').replace(/\\]+/gi, '}}'));\n              }\n              html = compiledTemplate(scope);\n            } else {\n              if (scope.profile.FacebookUserId) {\n                html = '<a href=\"/profile\"><img alt=\"temp customer image\" class=\"accountImage\" src=\"https:\\/\\/graph.facebook.com\\/' + scope.profile.FacebookUserId + '\\/picture?type=small\" \\/><\\/a>' + html;\n              }\n            }\n            element.html(html);\n          }\n        });\n      }\n\n      setProfileData();\n      scope.$on('gsnevent:profile-load-success', setProfileData);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnProposeApp', ['gsnApi', '$localStorage', '$compile', function(gsnApi, $localStorage, $compile) {\n    // Usage: Propose customer download mobile app\n    //\n    // Creates: 2016-1-12 PavelD\n    //\n    var directive = {\n      restrict: 'A',\n      scope: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n\n      scope.isIOS = gsnApi.browser.isIOS;\n      scope.isAndroid = gsnApi.browser.isAndroid;\n\n      // going to show this popUp only for iOs and Android users\n      if (!gsnApi.browser.isMobile && !(scope.isIOS || scope.isAndroid))\n        return;\n\n      if ($localStorage.hasMobileApp)\n        return;\n\n      var url = '//clientapi.gsn2.com/api/v1/content/meta/' + gsnApi.getChainId() + '/?name=home%20page&meta=mobileAppPage&type=text/html&nocache=';\n      var today = new Date();\n      var nocache = today.getFullYear() + '' + today.getMonth() + '' + today.getDate() + '' + today.getHours();\n\n      gsnApi.http({}, url + nocache)\n        .then(function(response) {\n          if (response.success) {\n\n            var myHtml = '<div class=\"myModalForm\" style=\"display: block\"><div class=\"modal-dialog\">' + response.response + '</div></div>\"';\n            var $modalElement = angular.element($compile(myHtml)(scope));\n\n            // console.log( 'redirect to page or show PopUp' );\n            gmodal.show({\n              content: $modalElement[0]\n            });\n          }\n        });\n\n      scope.downloadApp = function(url) {\n        $localStorage.hasMobileApp = true;\n        gsnApi.goUrl(url, '_self');\n      };\n\n      scope.rejectApp = function() {\n        $localStorage.hasMobileApp = true;\n        return gmodal.hide();\n      };\n    }\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnRssFeed', ['FeedService', '$timeout', function(FeedService, $timeout) {\n    // Usage:   bind rss feed to some property\n    //\n    // Creates: 2014-01-06\n    //\n    var directive = {\n      link: link,\n      restrict: 'A'\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      FeedService.parseFeed(attrs.gsnRssFeed, attrs.maxResult).then(function(res) {\n        scope[attrs.ngModel] = res.data.responseData.feed;\n      });\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n\n  angular.module('gsn.core')\n    .directive('gsnShoppingList', ['gsnApi', '$timeout', 'gsnProfile', '$routeParams', '$rootScope', 'gsnStore', '$location', '$filter',\n      function(gsnApi, $timeout, gsnProfile, $routeParams, $rootScope, gsnStore, $location, $filter) {\n        // Usage:  use to manipulate a shopping list on the UI\n        //\n        // Creates: 2014-01-13 TomN\n        //\n        var directive = {\n          restrict: 'EA',\n          scope: true,\n          controller: ['$scope', '$element', '$attrs', controller],\n          link: link\n        };\n        return directive;\n\n        function link(scope, element, attrs) {\n          scope.reloadShoppingList();\n        }\n\n        function controller($scope, $element, $attrs) {\n          $scope.coupons = [];\n          $scope.instoreCoupons = [];\n          $scope.circularCoupons = [];\n          $scope.addString = '';\n          $scope.pluginItemCount = 10;\n          $scope.topitems = [];\n          $scope.hasInitializePrinter = false;\n          $scope.totalQuantity = 0;\n          $scope.mylist = null;\n          $scope.groupBy = 'CategoryName';\n          $scope.currentDate = new Date();\n          $scope.shoppinglistsaved = 0;\n          $scope.shoppinglistdeleted = 0;\n          $scope.shoppinglistcreated = 0;\n          $scope.circular = gsnStore.getCircularData();\n\n          $scope.reloadShoppingList = function(shoppingListId) {\n            $timeout(function() {\n              if ($attrs.gsnShoppingList === 'savedlists') {\n                if ($scope.getSelectedShoppingListId) {\n                  shoppingListId = $scope.getSelectedShoppingListId();\n                }\n              }\n\n              $scope.mylist = $scope.doMassageList(gsnProfile.getShoppingList(shoppingListId));\n\n              if ($scope.mylist) {\n                if (!$scope.mylist.hasLoaded()) {\n                  $scope.doRefreshList();\n                }\n              } else if (shoppingListId) {\n                // if not saved list and current shopping list, then\n                if ($attrs.gsnShoppingList !== 'savedlists' && shoppingListId === gsnApi.getShoppingListId()) {\n                  $scope.mylist = gsnProfile.getShoppingList();\n                  $scope.doRefreshList();\n                }\n              }\n\n            }, 50);\n          };\n\n          $scope.doMassageList = function(list) {\n            if (gsnApi.isNull(list, null) === null) return null;\n\n            $scope.coupons.length = 0;\n            $scope.totalQuantity = 0;\n            $scope.title = list.getTitle();\n            $scope.currentDate = new Date();\n            if (gsnApi.isNull($scope.newTitle, null) === null) {\n              if (list.getStatus() > 1) {\n                $scope.newTitle = $scope.title;\n              } else {\n                $scope.newTitle = null;\n              }\n            }\n            list.topitems = [];\n            list.items = gsnApi.isNull(list.items, []);\n            list.items.length = 0;\n\n            // calculate the grouping\n            // and make list calculation\n            var items = list.allItems(),\n              totalQuantity = 0;\n\n            if (gsnApi.isNull(list.items, []).length > 0) {\n              items = list.items;\n            } else {\n              list.items = items;\n            }\n\n            var categories = gsnStore.getCategories();\n\n            angular.forEach(items, function(item, idx) {\n              if (gsnApi.isNull(item.CategoryName, null) === null) {\n                // in javascript, null is actually != to undefined\n                var cat = categories[item.CategoryId || null];\n                if (cat) {\n                  item.CategoryName = gsnApi.isNull(cat.CategoryName, '');\n                } else {\n                  item.CategoryName = gsnApi.isNull(item.CategoryName, '');\n                }\n              }\n\n              item.BrandName = gsnApi.isNull(item.BrandName, '');\n\n              if (item.IsCoupon) {\n\n                // since the server does not return a product code, we get it from local coupon index\n                var coupon = gsnStore.getCoupon(item.ItemId, item.ItemTypeId);\n                if (coupon) {\n                  item.LinkedItem = coupon;\n                  item.ProductCode = coupon.ProductCode;\n                  item.StartDate = coupon.StartDate;\n                  item.EndDate = coupon.EndDate;\n                  item.Description2 = coupon.Description2;\n\n                  // Get the temp quantity.\n                  var tmpQuantity = gsnApi.isNaN(parseInt(coupon.Quantity), 0);\n\n                  // If the temp quantity is zero, then set one.\n                  item.Quantity = (tmpQuantity > 0) ? tmpQuantity : 1;\n\n\n                  if (item.ItemTypeId === 13) {\n                    item.CategoryName = 'Digital Coupon';\n                  }\n\n                  // Push the coupons\n                  if (item.ItemTypeId === 10) {\n                    $scope.instoreCoupons.push(coupon);\n                  }\n\n                  item.SmallImageUrl = item.SmallImageUrl || coupon.SmallImageUrl;\n                  item.ImageUrl = item.ImageUrl || coupon.ImageUrl;\n                }\n\n                $scope.coupons.push(item);\n              } else if (item.ItemTypeId === 0 && item.Meta) {\n                if (!item.LinkedItem && (item.Meta + '').indexOf('}') > 0) {\n                  item.LinkedItem = JSON.parse(item.Meta);\n                }\n                if (item.LinkedItem) {\n\n                  var quantity = parseInt(item.LinkedItem.prePriceText);\n                  if (isNaN(quantity)) {\n                    quantity = 1;\n                  }\n                  item.CategoryName = item.LinkedItem.category;\n                  item.Description = item.LinkedItem.name;\n                  item.Description2 = item.LinkedItem.description;\n                  item.PriceString = item.LinkedItem.prePriceText + ' ' + item.LinkedItem.priceText + ' ' + item.LinkedItem.postPriceText;\n                  item.ImageUrl = item.LinkedItem.imageUrl;\n                  item.SmallImageUrl = item.LinkedItem.imageUrl;\n                  item.StartDate = item.LinkedItem.validFrom;\n                  item.EndDate = item.LinkedItem.validTo;\n                }\n              } else {\n                // determine if circular item is a coupon\n                var circCoupon = gsnStore.getItem(item.ItemId);\n                item.LinkedItem = circCoupon || {};\n                if (circCoupon) {\n                  if (circCoupon.CouponImageUrl) {\n                    item.CouponImageUrl = circCoupon.CouponImageUrl;\n                    item.Description2 = circCoupon.ItemDescription;\n                    item.EndDate = $scope.circular.Circulars[0].EndDate;\n                    $scope.circularCoupons.push(item);\n                  }\n\n                  // repopulate image url\n                  item.SmallImageUrl = item.SmallImageUrl || circCoupon.SmallImageUrl;\n                  item.ImageUrl = item.ImageUrl || circCoupon.ImageUrl;\n\n                  // repopulate price string\n                  item.PriceString = circCoupon.PriceString;\n                }\n\n              }\n\n              if (gsnApi.isNull(item.PriceString, '').length <= 0) {\n                if (item.Price) {\n                  item.PriceString = '$' + parseFloat(item.Price).toFixed(2);\n                }\n              }\n\n              totalQuantity += gsnApi.isNaN(parseInt(item.Quantity), 0);\n              item.NewQuantity = item.Quantity;\n              item.selected = false;\n              item.zIndex = 900 - idx;\n\n              // resolve circular reference\n              if (item.LinkedItem === item) {\n                var newItem = angular.copy(item);\n                gsnApi.del(newItem, 'LinkedItem');\n                item.LinkedItem = newItem;\n              }\n            });\n\n            $scope.totalQuantity = totalQuantity;\n            // only get topN for current list\n            if (list.ShoppingListId === gsnApi.getShoppingListId()) {\n              // get top N items\n              gsnApi.sortOn(items, 'Order');\n              list.topitems = angular.copy(items);\n\n              if (items.length > $scope.pluginItemCount) {\n                list.topitems = list.topitems.splice(items.length - $scope.pluginItemCount);\n              }\n\n              list.topitems.reverse();\n              $scope.topitems = list.topitems;\n              $rootScope.$broadcast('gsnevent:shoppinglist-itemtops', $scope.topitems);\n            }\n\n            var newAllItems = [];\n            if (gsnApi.isNull($scope.groupBy, '').length <= 0) {\n              newAllItems = [{\n                key: '',\n                items: items\n              }];\n            } else {\n              newAllItems = gsnApi.groupBy(items, $scope.groupBy, function(item) {\n                gsnApi.sortOn(item.items, 'Description');\n              });\n            }\n\n            for (var i = 0; i < newAllItems.length; i++) {\n\n              var fitems = newAllItems[i].items;\n\n              // use scope search because it might have changed during timeout\n              if (gsnApi.isNull($scope.listSearch, '').length <= 0) {\n                fitems = $filter('filter')(fitems, $scope.listSearch);\n              }\n\n              newAllItems[i].fitems = fitems;\n            }\n\n            $scope.allItems = newAllItems;\n            $rootScope.$broadcast('gsnevent:gsnshoppinglist-itemavailable');\n            return list;\n          };\n\n          $scope.doUpdateQuantity = function(item) {\n            var list = $scope.mylist;\n            item.OldQuantity = item.Quantity;\n            item.Quantity = parseInt(item.NewQuantity);\n            list.syncItem(item);\n          };\n\n          $scope.doAddSelected = function() {\n            var list = $scope.mylist;\n            var toAdd = [];\n            angular.forEach(list.items, function(item, k) {\n              if (true === item.selected) {\n                toAdd.push(item);\n              }\n            });\n\n            //  Issue: The previous version of this code was adding to the list regardless of if it was previously added. Causing the count to be off.\n            angular.forEach(toAdd, function(item, k) {\n              if (false === gsnProfile.isOnList(item)) {\n                gsnProfile.addItem(item);\n              } else {\n                // Remove the selection state from the item, it was already on the list.\n                item.selected = false;\n              }\n            });\n          };\n\n          $scope.doDeleteList = function() {\n            gsnProfile.deleteShoppingList($scope.mylist);\n\n            // cause this list to refresh\n            $scope.$emit('gsnevent:savedlists-deleted', $scope.mylist);\n          };\n\n          $scope.doAddOwnItem = function() {\n            var list = $scope.mylist;\n            var addString = gsnApi.isNull($scope.addString, '');\n            if (addString.length < 1) {\n              return;\n            }\n\n            gsnProfile.addItem({\n              ItemId: null,\n              Description: $scope.addString,\n              ItemTypeId: 6,\n              Quantity: 1\n            });\n            $scope.addString = '';\n\n            // refresh list\n            $scope.doMassageList(list);\n          };\n\n          $scope.doSaveList = function(newTitle) {\n            // save list just means to change the title\n            if (!gsnApi.isLoggedIn()) {\n              // fallback message\n              $rootScope.$broadcast('gsnevent:login-required');\n              return;\n            }\n\n            var list = $scope.mylist;\n            list.setTitle(newTitle).then(function(response) {});\n          };\n\n          $scope.doSelectAll = function() {\n            var list = $scope.mylist;\n            if (list.items[0]) {\n              var selected = (list.items[0].selected) ? false : true;\n              angular.forEach(list.items, function(v, k) {\n                v.selected = selected;\n              });\n            }\n          };\n\n          /* begin item menu actions */\n          $scope.doItemRemove = function(item) {\n            var list = $scope.mylist;\n            list.removeItem(item);\n            $scope.doMassageList(list);\n          };\n\n          $scope.doItemAddToCurrentList = function(item) {\n            if (gsn.isNull(item, null) !== null) {\n\n              //var mainList = gsnProfile.getShoppingList();\n              gsnProfile.addItem(item);\n            }\n          };\n\n          $scope.doRefreshList = function() {\n            if ($scope.mylist) {\n              $scope.mylist.updateShoppingList().then(function(response) {\n                if (response.success) {\n                  // refresh\n                  $scope.doMassageList($scope.mylist);\n                }\n              });\n            }\n          };\n\n          function handleShoppingListEvent(event, shoppingList) {\n            // ignore bad events\n            if (gsnApi.isNull(shoppingList, null) === null) {\n              return;\n            }\n\n            if (gsnApi.isNull($scope.mylist) || ($attrs.gsnShoppingList === 'savedlists')) {\n              // current list is null, reload\n              $scope.reloadShoppingList();\n              return;\n            }\n\n            if (gsnApi.isNull($scope.mylist, null) === null) {\n              $scope.reloadShoppingList(shoppingList.ShoppingListId);\n              return;\n            }\n\n            // detect list changed, update the list\n            if (shoppingList.ShoppingListId === $scope.mylist.ShoppingListId) {\n              $scope.reloadShoppingList($scope.mylist.ShoppingListId);\n            }\n          }\n\n          $scope.$on('gsnevent:shoppinglist-changed', handleShoppingListEvent);\n          $scope.$on('gsnevent:shoppinglist-loaded', handleShoppingListEvent);\n          $scope.$on('gsnevent:shoppinglist-page-loaded', handleShoppingListEvent);\n          $scope.$on('gsnevent:savedlists-selected', handleShoppingListEvent);\n\n          $scope.$on('gsnevent:circular-loaded', function(event, data) {\n            if (data.success) {\n              $scope.reloadShoppingList();\n            }\n\n            $scope.circular = gsnStore.getCircularData();\n          });\n\n          // Events for modal confirmation.\n          $scope.$on('gsnevent:shopping-list-saved', function() {\n            $scope.shoppinglistsaved++;\n          });\n\n          $scope.$on('gsnevent:shopping-list-deleted', function() {\n            $scope.shoppinglistdeleted++;\n          });\n\n          // Per Request: signal that the list has been created.\n          $scope.$on('gsnevent:shopping-list-created', function(event, data) {\n            $scope.shoppinglistcreated++;\n          });\n        }\n      }\n    ]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnSpinner', ['$window', '$timeout', 'gsnApi', function($window, $timeout, gsnApi) {\n    // Usage:   Display spinner\n    //\n    // Creates: 2014-01-06\n    //\n    /*var opts = {\n          lines: 13, // The number of lines to draw\n          length: 20, // The length of each line\n          width: 10, // The line thickness\n          radius: 30, // The radius of the inner circle\n          corners: 1, // Corner roundness (0..1)\n          rotate: 0, // The rotation offset\n          direction: 1, // 1: clockwise, -1: counterclockwise\n          color: '#000', // #rgb or #rrggbb or array of colors\n          speed: 1, // Rounds per second\n          trail: 60, // Afterglow percentage\n          shadow: false, // Whether to render a shadow\n          hwaccel: false, // Whether to use hardware acceleration\n          className: 'spinner', // The CSS class to assign to the spinner\n          zIndex: 2e9, // The z-index (defaults to 2000000000)\n          top: 'auto', // Top position relative to parent in px\n          left: 'auto', // Left position relative to parent in px\n          stopDelay: 200 // delay before matching ng-show-if\n        };\n    */\n    var directive = {\n      link: link,\n      restrict: 'A',\n      scope: true\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      function activate() {\n        if (typeof(Spinner) === 'undefined') {\n          $timeout(activate, 200);\n\n          if (scope.loadingScript) return;\n          scope.loadingScript = true;\n\n          // dynamically load google\n          var src = '//cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.min.js';\n\n          gsnApi.loadScripts([src], activate);\n          return;\n        }\n\n        var options = scope.$eval(attrs.gsnSpinner);\n        options.stopDelay = options.stopDelay || 200;\n\n        function stopSpinner() {\n          if (scope.gsnSpinner) {\n            scope.gsnSpinner.stop();\n            scope.gsnSpinner = null;\n          }\n        }\n\n        scope.$watch(attrs.showIf, function(newValue) {\n          stopSpinner();\n          if (newValue) {\n            scope.gsnSpinner = new $window.Spinner(options);\n            scope.gsnSpinner.spin(element[0]);\n\n            if (options.timeout) {\n              $timeout(function() {\n                var val = scope[attrs.showIf];\n                if (typeof(val) === 'boolean') {\n                  // this should cause it to stop spinner\n                  scope[attrs.showIf] = false;\n                } else {\n                  $timeout(stopSpinner, options.stopDelay);\n                }\n              }, options.timeout);\n            }\n          }\n        }, true);\n\n        scope.$on('$destroy', function() {\n          $timeout(stopSpinner, options.stopDelay);\n        });\n      }\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnSticky', ['$window', '$timeout', 'debounce', function($window, $timeout, debounce) {\n\n    var directive = {\n      link: link,\n      restrict: 'A',\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var anchor = angular.element('<div class=\"sticky-anchor\"></div>');\n      element.before(anchor);\n      element.css({\n        bottom: 'auto',\n        top: 'auto'\n      });\n\n      function checkSticky() {\n        var scrollTop = angular.element($window).scrollTop();\n        var screenHeight = angular.element($window).height();\n        var anchorTop = anchor.offset().top;\n        var elementHeight = element.height();\n        var top = parseInt(attrs.top) || 0;\n        var bottom = parseInt(attrs.bottom);\n        var isStuck = false;\n\n\n        if (!isNaN(bottom)) {\n          // only sticky to bottom if scroll beyond anchor or it's beyound bottom of screen\n          isStuck = (scrollTop > anchorTop + elementHeight) || (scrollTop + screenHeight < anchorTop + bottom);\n          if (isStuck) {\n            element.css({\n              bottom: bottom,\n              top: 'auto'\n            });\n          }\n        } else if (!isNaN(top)) {\n          isStuck = scrollTop > anchorTop + top + elementHeight;\n          if (isStuck) {\n            element.css({\n              bottom: 'auto',\n              top: top\n            });\n          }\n        }\n\n        // if screen is too small, don't do sticky\n        if (screenHeight < (top + (bottom || 0) + elementHeight)) {\n          isStuck = false;\n        }\n\n        if (isStuck) {\n          element.addClass('stuck');\n        } else {\n          element.css({\n            bottom: 'auto',\n            top: 'auto'\n          });\n          element.removeClass('stuck');\n        }\n\n        // probagate\n        return true;\n      }\n\n      var myCheckSticky = debounce(checkSticky, 200);\n\n      angular.element($window).on('scroll', myCheckSticky);\n      scope.$watch(attrs.reloadOnChange, myCheckSticky);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnStoreInfo', ['gsnApi', 'gsnStore', '$interpolate', function(gsnApi, gsnStore, $interpolate) {\n    // Usage: optimize store info binding for better IE8 support\n    //\n    // Creates: 2014-01-30 TomN\n    //\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var compiledTemplate = $interpolate(attrs.gsnStoreInfo.replace(/\\[+/gi, '{{').replace(/\\]+/gi, '}}'));\n\n      function setStoreData() {\n        var storeId = gsnApi.isNull(gsnApi.getSelectedStoreId(), 0);\n        if (storeId > 0) {\n          gsnStore.getStore().then(function(store) {\n            if (store) {\n              scope.store = store;\n\n              var data = compiledTemplate(scope);\n\n              element.html(data);\n            }\n          });\n        }\n      }\n\n      setStoreData();\n      scope.$on('gsnevent:store-setid', setStoreData);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnSvgImage', ['$window', '$timeout', 'debounce', 'gsnApi', function($window, $timeout, debounce, gsnApi) {\n\n    var directive = {\n      link: link,\n      restrict: 'A',\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var src = attrs.src,\n        svg;\n      var width = 0,\n        height = 0;\n\n      function doLoadImage() {\n        var $win = angular.element($window);\n        if (attrs.src === '') {\n          $timeout(doLoadImage, 200);\n          return;\n        }\n        element.html('');\n\n        gsnApi.loadImage(attrs.src, function(img) {\n          width = img.w;\n          height = img.h;\n\n          // set viewBox\n          img = angular.element(attrs.gsnSvgImage);\n          svg = img.parent('svg');\n          // append Image\n          svg[0].setAttributeNS('', 'viewBox', '0 0 ' + width + ' ' + height + '');\n          img.attr('width', width).attr('height', height).attr('xlink:href', attrs.src);\n          img.show();\n          var isIE = /Trident.*rv:11\\.0/.test(navigator.userAgent) || /msie/gi.test(navigator.userAgent);\n\n          if (isIE && attrs.syncHeight) {\n            var resizer = debounce(function() {\n              var actualWidth = element.parent().width();\n              var ratio = actualWidth / (width || actualWidth || 1);\n              var newHeight = ratio * height;\n\n              angular.element(attrs.syncHeight).height(newHeight);\n\n            }, 200);\n\n            resizer();\n            $win.on('resize', resizer);\n          }\n\n          // re-adjust\n          var reAdjust = debounce(function() {\n            // click activate to re-arrange item\n            angular.element('.onlist').click();\n\n            // remove active item\n            $timeout(function() {\n              scope.vm.activeItem = null;\n              scope.vm.loadCount++;\n            }, 200);\n          }, 200);\n          reAdjust();\n\n          $win.on('resize', reAdjust);\n          $win.on('orientationchange', reAdjust);\n\n        }, element);\n      }\n      var myLoadImage = debounce(doLoadImage, 100);\n      scope.$watch(attrs.watch || 'vm.page', myLoadImage);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnTextCapture', ['$window', '$timeout', function($window, $timeout) {\n    // Usage:   bind text back into some property\n    //\n    // Creates: 2014-01-06\n    //\n    var directive = {\n      link: link,\n      restrict: 'A'\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var timeout = parseInt(attrs.timeout);\n      var continousMonitor = timeout > 0;\n\n      if (timeout <= 0) {\n        timeout = 200;\n      }\n\n      var refresh = function() {\n        scope.$apply(attrs.gsnTextCapture + ' = \"' + element.text().replace(/\"/g, '\\\\\"').replace(/(ie8newlinehack)/g, '\\r\\n') + '\"');\n        var val = scope.$eval(attrs.gsnTextCapture);\n        var noData = val.replace(/\\s+/gi, '').length <= 0;\n        if (noData) {\n          $timeout(refresh, timeout);\n          return;\n        }\n\n        if (continousMonitor) {\n          $timeout(refresh, timeout);\n        }\n      };\n\n      $timeout(refresh, timeout);\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnValidUser', ['$http', '$timeout', 'gsnApi', function($http, $timeout, gsnApi) {\n    // Usage: for validating if email is taken.  gsn-valid-email attribute\n    //\n    // Creates: 2013-12-25\n    //\n    var directive = {\n      link: link,\n      restrict: 'A',\n      require: 'ngModel'\n    };\n    return directive;\n\n    function link(scope, element, attrs, ctrl) {\n      var toId;\n\n      element.blur(function(evt) {\n        var value = ctrl.$viewValue;\n        if (gsnApi.isNull(value, '').length <= 0) {\n          ctrl.$setValidity('gsnValidUser', gsnApi.isNull(attrs.gsnValidUser, '') !== 'required');\n          return;\n        }\n\n        // if there was a previous attempt, stop it.\n        if (toId) {\n          if (toId.$$timeoutId) {\n            $timeout.cancel(toId.$$timeoutId);\n          }\n        }\n\n        // if this is an email field, validate that email is valid\n        // true mean that there is an error\n        if (ctrl.$error.email) {\n          ctrl.$setValidity('gsnValidUser', false);\n          return;\n        }\n\n        // start a new attempt with a delay to keep it from\n        // getting too \"chatty\".\n        toId = $timeout(function() {\n\n          gsnApi.getAccessToken().then(function() {\n            var url = gsnApi.getProfileApiUrl() + '/HasUsername?username=' + encodeURIComponent(value);\n            // call to some API that returns { isValid: true } or { isValid: false }\n            $http.get(url, {\n              headers: gsnApi.getApiHeaders()\n            }).success(function(data) {\n              toId = null;\n              //set the validity of the field\n              ctrl.$setValidity('gsnValidUser', data !== 'true');\n            }).error(function(response) {\n              toId = null;\n            });\n          });\n        }, 200);\n      });\n    }\n  }]);\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('gsnWatch', [function() {\n    // Usage: add monitoring capability\n    //\n    // Creates: 2013-12-12 TomN\n    //\n    var directive = {\n      restrict: 'EA',\n      scope: true,\n      link: link\n    };\n    return directive;\n\n    function link(scope, element, attrs) {\n      var modelVal = attrs.model;\n      if (typeof(modelVal) === 'undefined') {\n        modelVal = '{}';\n      }\n\n      scope.model = scope.$eval(modelVal);\n      var data = scope.$eval(attrs.gsnWatch);\n      angular.forEach(data, function(item, key) {\n        scope.$watch(item, function(newValue) {\n          scope.model[key] = newValue;\n        });\n      });\n    }\n  }]);\n\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  var ngModifyElementDirective = function(opt) {\n    // Usage: add meta dynamically\n    //\n    // Creates: 2013-12-12 TomN\n    // 2014-06-22 TomN - fix global variable\n    var options = angular.copy(opt);\n\n    return myModule.directive(options.name, ['$timeout', 'gsnApi',\n      function($timeout, gsnApi) {\n        return {\n          restrict: 'A',\n          link: function(scope, e, attrs) {\n            options.$timeout = $timeout;\n            options.gsnApi = gsnApi;\n            var modifierName = '$' + options.name;\n\n            // Disable parent modifier so that it doesn't\n            // overwrite our changes.\n            var parentModifier = scope[modifierName];\n            var parentModifierWasEnabled;\n            if (parentModifier) {\n              parentModifierWasEnabled = parentModifier.isEnabled;\n              parentModifier.isEnabled = false;\n            }\n\n            // Make sure we haven't attached this directive\n            // to this scope yet.\n            if (scope.hasOwnProperty(modifierName)) {\n              throw {\n                name: 'ScopeError',\n                message: 'Multiple copies of ' + options.name + ' modifier in same scope'\n              };\n            }\n\n            // Attach to the current scope.\n            var currentModifier = {\n              isEnabled: true\n            };\n            scope[modifierName] = currentModifier;\n\n            var $element = angular.element('head > ' + options.selector);\n            if ($element.length <= 0 && typeof(options.html) === 'string') {\n              angular.element('head > title').before(options.html);\n              $element = angular.element('head > ' + options.selector);\n            }\n\n            // Keep track of the original value, so that it\n            // can be restored later.\n            var originalValue = options.get($element);\n\n            // Watch for changes to the interpolation, and reflect\n            // them into the DOM.\n            var currentValue = originalValue;\n            attrs.$observe(options.name, function(newValue, oldValue) {\n              // Don't stomp on child modifications if *we* disabled.\n              if (currentModifier.isEnabled) {\n                currentValue = newValue;\n                options.set($element, newValue, oldValue);\n              }\n            });\n\n            // When we go out of scope restore the original value.\n            scope.$on('$destroy', function() {\n              options.set($element, originalValue, currentValue);\n\n              // Turn the parent back on, if it indeed was on.\n              if (parentModifier) {\n                parentModifier.isEnabled = parentModifierWasEnabled;\n              }\n            });\n\n          }\n        };\n      }\n    ]);\n  };\n\n  // page title\n  ngModifyElementDirective({\n    name: 'gsnTitle',\n    selector: 'meta[itemprop=\"title\"]',\n    html: '<meta itemprop=\"title\" name=\"twitter:title\" property=\"og:title\"/>',\n    get: function(e) {\n      return e.attr('content');\n    },\n    set: function(e, v) {\n      angular.element('title').text(v);\n      return e.attr('content', v);\n    }\n  });\n\n  // page title\n  ngModifyElementDirective({\n    name: 'gsnMetaType',\n    selector: 'meta[itemprop=\"type\"]',\n    html: '<meta content=\"article\" itemprop=\"type\" property=\"og:type\"/>',\n    get: function(e) {\n      return e.attr('content');\n    },\n    set: function(e, v) {\n      return e.attr('content', v || 'article');\n    }\n  });\n\n\n  // description\n  ngModifyElementDirective({\n    name: 'gsnMetaDescription',\n    selector: 'meta[itemprop=\"description\"]',\n    html: '<meta itemprop=\"description\" name=\"twitter:description\" property=\"og:description\"/>',\n    get: function(e) {\n      return e.attr('content');\n    },\n    set: function(e, v) {\n      return e.attr('content', v);\n    }\n  });\n\n  // image\n  ngModifyElementDirective({\n    name: 'gsnMetaImage',\n    selector: 'meta[itemprop=\"image\"]',\n    html: '<meta itemprop=\"image\" name=\"twitter:image\" property=\"og:image\"/><meta content=\"300\" property=\"og:image:width\"/><meta content=\"300\" property=\"og:image:height\"/>',\n    get: function(e) {\n      return e.attr('content');\n    },\n    set: function(e, v) {\n      if (v) {\n        if (v.indexOf('//') === 0) {\n          v = 'https:' + v;\n        }\n\n        var $that = this;\n        var iw = angular.element('head > meta[property=\"og:image:width\"]').attr('content', '300');\n        var ih = angular.element('head > meta[property=\"og:image:height\"]').attr('content', '300');\n\n        var setImageDimension = function(rst) {\n          iw.attr('content', rst.w || 300);\n          ih.attr('content', rst.h || 300);\n        };\n\n        $that.gsnApi.loadImage(v, setImageDimension);\n      }\n\n      return e.attr('content', v);\n    }\n  });\n\n  // google site verification\n  ngModifyElementDirective({\n    name: 'gsnMetaGoogleSiteVerification',\n    selector: 'meta[name=\"google-site-verification\"]',\n    html: '<meta name=\"google-site-verification\" />',\n    get: function(e) {\n      return e.attr('content');\n    },\n    set: function(e, v) {\n      return e.attr('content', v);\n    }\n  });\n})(angular);\n\n(function(angular, undefined) {\n  'use strict';\n  var myModule = angular.module('gsn.core');\n\n  myModule.directive('placeholder', ['$timeout', 'gsnApi', function($timeout, gsnApi) {\n    return function(scope, el, attrs) {\n      var settings = {\n          cssClass: 'placeholder',\n          excludedAttrs: ['placeholder', 'name', 'id', 'ng-model', 'type']\n        },\n        placeholderText = attrs.placeholder,\n        isPassword = attrs.type === 'password',\n        hasNativeSupport = 'placeholder' in document.createElement('input') && 'placeholder' in document.createElement('textarea'),\n        setPlaceholder, removePlaceholder, copyAttrs, fakePassword;\n\n      if (hasNativeSupport) return;\n\n      copyAttrs = function() {\n        var a = {};\n        angular.forEach(attrs.$attr, function(i, attrName) {\n          if (!gsn.contains(settings.excludedAttrs, attrName)) {\n            a[attrName] = attrs[attrName];\n          }\n        });\n        return a;\n      };\n\n      var createFakePassword = function() {\n        return angular.element('<input>', angular.extend(copyAttrs(), {\n            'type': 'text',\n            'value': placeholderText\n          }))\n          .addClass(settings.cssClass)\n          .bind('focus', function() {\n            removePlaceholder();\n          })\n          .insertBefore(el);\n      };\n\n      if (isPassword) {\n        fakePassword = createFakePassword();\n        setPlaceholder = function() {\n          if (!el.val()) {\n            fakePassword.show();\n            el.hide();\n          }\n        };\n        removePlaceholder = function() {\n          if (fakePassword.is(':visible')) {\n            fakePassword.hide();\n            el.show().focus();\n          }\n        };\n      } else {\n        setPlaceholder = function() {\n          if (!el.val()) {\n            el.val(placeholderText);\n\n            $timeout(function() {\n              el.addClass(settings.cssClass); /*hint, IE does not aplly style without timeout*/\n            }, 0);\n          }\n        };\n\n        removePlaceholder = function() {\n          if (el.hasClass(settings.cssClass)) {\n            el.val('').select(); /*trick IE, because after tabbing focus to input, there is no cursor in it*/\n            el.removeClass(settings.cssClass);\n          }\n        };\n      }\n\n      el.on('focus', removePlaceholder).on('blur', setPlaceholder);\n      $timeout(function() {\n        el.trigger('blur');\n      }, 0);\n\n\n      scope.$watch(attrs.ngModel, function(value) {\n        if (gsnApi.isNull(value).length <= 0) {\n          if (!el.is(':focus')) el.trigger('blur');\n        } else {\n          if (el.hasClass(settings.cssClass)) el.removeClass(settings.cssClass);\n        }\n      });\n\n    };\n  }]);\n})(angular);\n\n/*\n---\nname: Facebook Angularjs\n\ndescription: Provides an easier way to make use of Facebook API with Angularjs\n\nlicense: MIT-style license\n\nauthors:\n  - Ciul\n\nrequires: [angular]\nprovides: [facebook]\n\n...\n*/\n(function(window, angular, undefined) {\n  'use strict';\n\n  // Module global settings.\n  var settings = {};\n\n  // Module global flags.\n  var flags = {\n    sdk: false,\n    ready: false\n  };\n\n  // Module global loadDeferred\n  var loadDeferred;\n\n  /**\n   * Facebook module\n   */\n  angular.module('facebook', []).\n\n    // Declare module settings value\n    value('settings', settings).\n\n    // Declare module flags value\n    value('flags', flags).\n\n    /**\n     * Facebook provider\n     */\n    provider('Facebook', [\n      function() {\n\n        /**\n         * Facebook appId\n         * @type {Number}\n         */\n        settings.appId = null;\n\n        this.setAppId = function(appId) {\n          settings.appId = appId;\n        };\n\n        this.getAppId = function() {\n          return settings.appId;\n        };\n\n        /**\n         * Locale language, english by default\n         * @type {String}\n         */\n        settings.locale = 'en_US';\n\n        this.setLocale = function(locale) {\n          settings.locale = locale;\n        };\n\n        this.getLocale = function() {\n          return settings.locale;\n        };\n\n        /**\n         * Set if you want to check the authentication status\n         * at the start up of the app\n         * @type {Boolean}\n         */\n        settings.status = true;\n\n        this.setStatus = function(status) {\n          settings.status = status;\n        };\n\n        this.getStatus = function() {\n          return settings.status;\n        };\n\n        /**\n         * Adding a Channel File improves the performance of the javascript SDK,\n         * by addressing issues with cross-domain communication in certain browsers.\n         * @type {String}\n         */\n        settings.channelUrl = null;\n\n        this.setChannel = function(channel) {\n          settings.channelUrl = channel;\n        };\n\n        this.getChannel = function() {\n          return settings.channelUrl;\n        };\n\n        /**\n         * Enable cookies to allow the server to access the session\n         * @type {Boolean}\n         */\n        settings.cookie = true;\n\n        this.setCookie = function(cookie) {\n          settings.cookie = cookie;\n        };\n\n        this.getCookie = function() {\n          return settings.cookie;\n        };\n\n        /**\n         * Parse XFBML\n         * @type {Boolean}\n         */\n        settings.xfbml = true;\n\n        this.setXfbml = function(enable) {\n          settings.xfbml = enable;\n        };\n\n        this.getXfbml = function() {\n          return settings.xfbml;\n        };\n\n        /**\n         * Auth Response\n         * @type {Object}\n         */\n        settings.authResponse = true;\n\n        this.setAuthResponse = function(obj) {\n          settings.authResponse = obj || true;\n        };\n\n        this.getAuthResponse = function() {\n          return settings.authResponse;\n        };\n\n        /**\n         * Frictionless Requests\n         * @type {Boolean}\n         */\n        settings.frictionlessRequests = false;\n\n        this.setFrictionlessRequests = function(enable) {\n          settings.frictionlessRequests = enable;\n        };\n\n        this.getFrictionlessRequests = function() {\n          return settings.frictionlessRequests;\n        };\n\n        /**\n         * HideFlashCallback\n         * @type {Object}\n         */\n        settings.hideFlashCallback = null;\n\n        this.setHideFlashCallback = function(obj) {\n          settings.hideFlashCallback = obj || null;\n        };\n\n        this.getHideFlashCallback = function() {\n          return settings.hideFlashCallback;\n        };\n\n        /**\n         * Custom option setting\n         * key @type {String}\n         * value @type {*}\n         * @return {*}\n         */\n        this.setInitCustomOption = function(key, value) {\n          if (!angular.isString(key)) {\n            return false;\n          }\n\n          settings[key] = value;\n          return settings[key];\n        };\n\n        /**\n         * get init option\n         * @param  {String} key\n         * @return {*}\n         */\n        this.getInitOption = function(key) {\n          // If key is not String or If non existing key return null\n          if (!angular.isString(key) || !settings.hasOwnProperty(key)) {\n            return false;\n          }\n\n          return settings[key];\n        };\n\n        /**\n         * load SDK\n         */\n        settings.loadSDK = true;\n\n        this.setLoadSDK = function(a) {\n          settings.loadSDK = !!a;\n        };\n\n        this.getLoadSDK = function() {\n          return settings.loadSDK;\n        };\n\n        /**\n         * Init Facebook API required stuff\n         * This will prepare the app earlier (on settingsuration)\n         * @arg {Object/String} initSettings\n         * @arg {Boolean} _loadSDK (optional, true by default)\n         */\n        this.init = function(initSettings, _loadSDK) {\n          // If string is passed, set it as appId\n          if (angular.isString(initSettings)) {\n            settings.appId = initSettings || settings.appId;\n          }\n\n          // If object is passed, merge it with app settings\n          if (angular.isObject(initSettings)) {\n            angular.extend(settings, initSettings);\n          }\n\n          // Set if Facebook SDK should be loaded automatically or not.\n          if (angular.isDefined(_loadSDK)) {\n            settings.loadSDK = !!_loadSDK;\n          }\n        };\n\n        /**\n         * This defined the Facebook service\n         */\n        this.$get = [\n          '$q',\n          '$rootScope',\n          '$timeout',\n          '$window',\n          function($q, $rootScope, $timeout, $window) {\n            /**\n             * This is the NgFacebook class to be retrieved on Facebook Service request.\n             */\n            function NgFacebook() {\n              this.appId = settings.appId;\n            }\n\n            /**\n             * Ready state method\n             * @return {Boolean}\n             */\n            NgFacebook.prototype.isReady = function() {\n              return flags.ready;\n            };\n\n            /**\n             * Map some asynchronous Facebook sdk methods to NgFacebook\n             */\n            angular.forEach([\n              'login',\n              'logout',\n              'api',\n              'ui',\n              'getLoginStatus'\n            ], function(name) {\n              NgFacebook.prototype[name] = function() {\n\n                var d = $q.defer(),\n                    args = Array.prototype.slice.call(arguments), // Converts arguments passed into an array\n                    userFn,\n                    userFnIndex;\n\n                // Get user function and it's index in the arguments array, to replace it with custom function, allowing the usage of promises\n                angular.forEach(args, function(arg, index) {\n                  if (angular.isFunction(arg)) {\n                    userFn = arg;\n                    userFnIndex = index;\n                  }\n                });\n\n                // Replace user function intended to be passed to the Facebook API with a custom one\n                // for being able to use promises.\n                if (angular.isFunction(userFn) && angular.isNumber(userFnIndex)) {\n                  args.splice(userFnIndex, 1, function(response) {\n                    $timeout(function() {\n                      if (angular.isUndefined(response.error)) {\n                        d.resolve(response);\n                      } else {\n                        d.reject(response);\n                      }\n\n                      if (angular.isFunction(userFn)) {\n                        userFn(response);\n                      }\n                    });\n                  });\n                }\n\n                $timeout(function() {\n                  // Call when loadDeferred be resolved, meaning Service is ready to be used.\n                  loadDeferred.promise.then(function() {\n                    $window.FB[name].apply(FB, args);\n                  }, function() {\n                    throw 'Facebook API could not be initialized properly';\n                  });\n                });\n\n                return d.promise;\n              };\n            });\n\n            /**\n             * Map Facebook sdk XFBML.parse() to NgFacebook.\n             */\n            NgFacebook.prototype.parseXFBML = function() {\n\n              var d = $q.defer();\n\n              $timeout(function() {\n                // Call when loadDeferred be resolved, meaning Service is ready to be used\n                loadDeferred.promise.then(function() {\n                  $window.FB.parse();\n                  d.resolve();\n                }, function() {\n                  throw 'Facebook API could not be initialized properly';\n                });\n              });\n\n              return d.promise;\n            };\n\n            /**\n             * Map Facebook sdk subscribe method to NgFacebook. Renamed as subscribe\n             * Thus, use it as Facebook.subscribe in the service.\n             */\n            NgFacebook.prototype.subscribe = function() {\n\n              var d = $q.defer(),\n                  args = Array.prototype.slice.call(arguments), // Get arguments passed into an array\n                  userFn,\n                  userFnIndex;\n\n              // Get user function and it's index in the arguments array, to replace it with custom function, allowing the usage of promises\n              angular.forEach(args, function(arg, index) {\n                if (angular.isFunction(arg)) {\n                  userFn = arg;\n                  userFnIndex = index;\n                }\n              });\n\n              // Replace user function intended to be passed to the Facebook API with a custom one\n              // for being able to use promises.\n              if (angular.isFunction(userFn) && angular.isNumber(userFnIndex)) {\n                args.splice(userFnIndex, 1, function(response) {\n                  $timeout(function() {\n                    if (angular.isUndefined(response.error)) {\n                      d.resolve(response);\n                    } else {\n                      d.reject(response);\n                    }\n\n                    if (angular.isFunction(userFn)) {\n                      userFn(response);\n                    }\n                  });\n                });\n              }\n\n              $timeout(function() {\n                // Call when loadDeferred be resolved, meaning Service is ready to be used\n                loadDeferred.promise.then(function() {\n                  $window.FB.Event.subscribe.apply(FB, args);\n                }, function() {\n                  throw 'Facebook API could not be initialized properly';\n                });\n              });\n\n              return d.promise;\n            };\n\n            /**\n             * Map Facebook sdk unsubscribe method to NgFacebook. Renamed as unsubscribe\n             * Thus, use it as Facebook.unsubscribe in the service.\n             */\n            NgFacebook.prototype.unsubscribe = function() {\n\n              var d = $q.defer(),\n                  args = Array.prototype.slice.call(arguments), // Get arguments passed into an array\n                  userFn,\n                  userFnIndex;\n\n              // Get user function and it's index in the arguments array, to replace it with custom function, allowing the usage of promises\n              angular.forEach(args, function(arg, index) {\n                if (angular.isFunction(arg)) {\n                  userFn = arg;\n                  userFnIndex = index;\n                }\n              });\n\n              // Replace user function intended to be passed to the Facebook API with a custom one\n              // for being able to use promises.\n              if (angular.isFunction(userFn) && angular.isNumber(userFnIndex)) {\n                args.splice(userFnIndex, 1, function(response) {\n                  $timeout(function() {\n                    if (angular.isUndefined(response.error)) {\n                      d.resolve(response);\n                    } else {\n                      d.reject(response);\n                    }\n\n                    if (angular.isFunction(userFn)) {\n                      userFn(response);\n                    }\n                  });\n                });\n              }\n\n              $timeout(function() {\n                // Call when loadDeferred be resolved, meaning Service is ready to be used\n                loadDeferred.promise.then(\n                  function() {\n                    $window.FB.Event.unsubscribe.apply(FB, args);\n                  },\n                  function() {\n                    throw 'Facebook API could not be initialized properly';\n                  }\n                );\n              });\n\n              return d.promise;\n            };\n\n            return new NgFacebook(); // Singleton\n          }\n        ];\n\n      }\n    ]).\n\n    /**\n     * Module initialization\n     */\n    run([\n      '$rootScope',\n      '$q',\n      '$window',\n      '$timeout',\n      function($rootScope, $q, $window, $timeout) {\n        // Define global loadDeffered to notify when Service callbacks are safe to use\n        loadDeferred = $q.defer();\n\n        var loadSDK = settings.loadSDK;\n        delete(settings['loadSDK']); // Remove loadSDK from settings since this isn't part from Facebook API.\n\n        /**\n         * Define fbAsyncInit required by Facebook API\n         */\n        $window.fbAsyncInit = function() {\n          // Initialize our Facebook app\n          $timeout(function() {\n            if (!settings.appId) {\n              throw 'Missing appId setting.';\n            }\n\n            FB.init(settings);\n\n            // Set ready global flag\n            flags.ready = true;\n\n\n            /**\n             * Subscribe to Facebook API events and broadcast through app.\n             */\n            angular.forEach({\n              'auth.login': 'login',\n              'auth.logout': 'logout',\n              'auth.prompt': 'prompt',\n              'auth.sessionChange': 'sessionChange',\n              'auth.statusChange': 'statusChange',\n              'auth.authResponseChange': 'authResponseChange',\n              'xfbml.render': 'xfbmlRender',\n              'edge.create': 'like',\n              'edge.remove': 'unlike',\n              'comment.create': 'comment',\n              'comment.remove': 'uncomment'\n            }, function(mapped, name) {\n              FB.Event.subscribe(name, function(response) {\n                $timeout(function() {\n                  $rootScope.$broadcast('Facebook:' + mapped, response);\n                });\n              });\n            });\n\n            // Broadcast Facebook:load event\n            $rootScope.$broadcast('Facebook:load');\n\n            loadDeferred.resolve(FB);\n\n          });\n        };\n\n        /**\n         * Inject Facebook root element in DOM\n         */\n        (function addFBRoot() {\n          var fbroot = document.getElementById('fb-root');\n\n          if (!fbroot) {\n            fbroot = document.createElement('div');\n            fbroot.id = 'fb-root';\n            document.body.insertBefore(fbroot, document.body.childNodes[0]);\n          }\n\n          return fbroot;\n        })();\n\n        /**\n         * SDK script injecting\n         */\n         if(loadSDK) {\n          (function injectScript() {\n            var src           = '//connect.facebook.net/' + settings.locale + '/all.js',\n                script        = document.createElement('script');\n                script.id     = 'facebook-jssdk';\n                script.async  = true;\n\n            // Prefix protocol\n            if ($window.location.protocol === 'file') {\n              src = 'https:' + src;\n            }\n\n            script.src = src;\n            script.onload = function() {\n              flags.sdk = true; // Set sdk global flag\n            };\n\n            document.getElementsByTagName('head')[0].appendChild(script); // // Fix for IE < 9, and yet supported by lattest browsers\n          })();\n        }\n      }\n    ]);\n\n})(window, angular);\n/**\n * @license Angulartics v0.19.2\n * (c) 2013 Luis Farzati http://luisfarzati.github.io/angulartics\n * License: MIT\n */\n!function(a, b) {\n  \"use strict\";\n  var c = window.angulartics || (window.angulartics = {});\n  c.waitForVendorCount = 0, c.waitForVendorApi = function(a, b, d, e, f) {\n    f || c.waitForVendorCount++, e || (e = d, d = void 0), !Object.prototype.hasOwnProperty.call(window, a) || void 0 !== d && void 0 === window[a][d] ? setTimeout(function() {\n      c.waitForVendorApi(a, b, d, e, !0)\n    }, b) : (c.waitForVendorCount--, e(window[a]))\n  }, a.module(\"angulartics\", []).provider(\"$analytics\", function() {\n    var b = {\n        pageTracking: {\n          autoTrackFirstPage: !0,\n          autoTrackVirtualPages: !0,\n          trackRelativePath: !1,\n          autoBasePath: !1,\n          basePath: \"\"\n        },\n        eventTracking: {},\n        bufferFlushDelay: 1e3,\n        developerMode: !1\n      },\n      d = [\"pageTrack\", \"eventTrack\", \"setAlias\", \"setUsername\", \"setUserProperties\", \"setUserPropertiesOnce\", \"setSuperProperties\", \"setSuperPropertiesOnce\"],\n      e = {},\n      f = {},\n      g = function(a) {\n        return function() {\n          c.waitForVendorCount && (e[a] || (e[a] = []), e[a].push(arguments))\n        }\n      },\n      h = function(b, c) {\n        return f[b] || (f[b] = []), f[b].push(c), function() {\n            var c = arguments;\n            a.forEach(f[b], function(a) {\n              a.apply(this, c)\n            }, this)\n          }\n      },\n      i = {\n        settings: b\n      },\n      j = function(a, b) {\n        b ? setTimeout(a, b) : a()\n      },\n      k = {\n        $get: function() {\n          return i\n        },\n        api: i,\n        settings: b,\n        virtualPageviews: function(a) {\n          this.settings.pageTracking.autoTrackVirtualPages = a\n        },\n        firstPageview: function(a) {\n          this.settings.pageTracking.autoTrackFirstPage = a\n        },\n        withBase: function(b) {\n          this.settings.pageTracking.basePath = b ? a.element(document).find(\"base\").attr(\"href\") : \"\"\n        },\n        withAutoBase: function(a) {\n          this.settings.pageTracking.autoBasePath = a\n        },\n        developerMode: function(a) {\n          this.settings.developerMode = a\n        }\n      },\n      l = function(c, d) {\n        i[c] = h(c, d);\n        var f = b[c],\n          g = f ? f.bufferFlushDelay : null,\n          k = null !== g ? g : b.bufferFlushDelay;\n        a.forEach(e[c], function(a, b) {\n          j(function() {\n            d.apply(this, a)\n          }, b * k)\n        })\n      },\n      m = function(a) {\n        return a.replace(/^./, function(a) {\n          return a.toUpperCase()\n        })\n      },\n      n = function(a) {\n        var b = \"register\" + m(a);\n        k[b] = function(b) {\n          l(a, b)\n        }, i[a] = h(a, g(a))\n      };\n    return a.forEach(d, n), k\n  }).run([\"$rootScope\", \"$window\", \"$analytics\", \"$injector\", function(b, c, d, e) {\n    d.settings.pageTracking.autoTrackFirstPage && e.invoke([\"$location\", function(a) {\n      var b = !0;\n      if (e.has(\"$route\")) {\n        var f = e.get(\"$route\");\n        for (var g in f.routes) {\n          b = !1;break\n        }\n      } else if (e.has(\"$state\")) {\n        var h = e.get(\"$state\");\n        for (var i in h.get()) {\n          b = !1;break\n        }\n      }\n      if (b)\n        if (d.settings.pageTracking.autoBasePath && (d.settings.pageTracking.basePath = c.location.pathname), d.settings.pageTracking.trackRelativePath) {\n          var j = d.settings.pageTracking.basePath + a.url();\n          d.pageTrack(j, a)\n        } else d.pageTrack(a.absUrl(), a)\n    }]), d.settings.pageTracking.autoTrackVirtualPages && e.invoke([\"$location\", function(a) {\n      d.settings.pageTracking.autoBasePath && (d.settings.pageTracking.basePath = c.location.pathname + \"#\"), e.has(\"$route\") && b.$on(\"$routeChangeSuccess\", function(b, c) {\n        if (!c || !(c.$$route || c).redirectTo) {\n          var e = d.settings.pageTracking.basePath + a.url();\n          d.pageTrack(e, a)\n        }\n      }), e.has(\"$state\") && b.$on(\"$stateChangeSuccess\", function(b, c) {\n        var e = d.settings.pageTracking.basePath + a.url();\n        d.pageTrack(e, a)\n      })\n    }]), d.settings.developerMode && a.forEach(d, function(a, b) {\n      \"function\" == typeof a && (d[b] = function() {})\n    })\n  }]).directive(\"analyticsOn\", [\"$analytics\", function(b) {\n    function c(a) {\n      return [\"a:\", \"button:\", \"button:button\", \"button:submit\", \"input:button\", \"input:submit\"].indexOf(a.tagName.toLowerCase() + \":\" + (a.type || \"\")) >= 0\n    }\n    function d(a) {\n      return c(a), \"click\"\n    }\n    function e(a) {\n      return c(a) ? a.innerText || a.value : a.id || a.name || a.tagName\n    }\n    function f(a) {\n      return \"analytics\" === a.substr(0, 9) && -1 === [\"On\", \"Event\", \"If\", \"Properties\", \"EventType\"].indexOf(a.substr(9))\n    }\n    function g(a) {\n      var b = a.slice(9);return \"undefined\" != typeof b && null !== b && b.length > 0 ? b.substring(0, 1).toLowerCase() + b.substring(1) : b\n    }\n    return {\n      restrict: \"A\",\n      link: function(c, h, i) {\n        var j = i.analyticsOn || d(h[0]),\n          k = {};\n        a.forEach(i.$attr, function(a, b) {\n          f(b) && (k[g(b)] = i[b], i.$observe(b, function(a) {\n            k[g(b)] = a\n          }))\n        }), a.element(h[0]).bind(j, function(d) {\n          var f = i.analyticsEvent || e(h[0]);\n          k.eventType = d.type, (!i.analyticsIf || c.$eval(i.analyticsIf)) && (i.analyticsProperties && a.extend(k, c.$eval(i.analyticsProperties)), b.eventTrack(f, k))\n        })\n      }\n    }\n  }])\n}(angular);\n\n/**\n * @license Angulartics v0.19.2\n * (c) 2013 Luis Farzati http://luisfarzati.github.io/angulartics\n * Google Tag Manager Plugin Contributed by http://github.com/danrowe49\n * License: MIT\n */\n!function(a) {\n  \"use strict\";a.module(\"angulartics\").config([\"$analyticsProvider\", function(a) {\n    a.registerPageTrack(function(a) {\n      var b = window.dataLayer = window.dataLayer || [];\n      b.push({\n        event: \"content-view\",\n        \"content-name\": a\n      })\n    }), a.registerEventTrack(function(a, b) {\n      var c = window.dataLayer = window.dataLayer || [];\n      c.push({\n        event: \"interaction\",\n        target: b.category,\n        action: a,\n        \"target-properties\": b.label,\n        value: b.value,\n        \"interaction-type\": b.noninteraction\n      })\n    })\n  }])\n}(angular);\n\n(function(angular) {\n  'use strict';\n\n  /**\n   * @ngdoc overview\n   * @name angulartics.clicky\n   * Adds support for Clicky analytics (http://clicky.com/).\n   * Custom logging is a premium Clicky feature. To use this plugin,\n   * clicky needs to be configured to disable automatic pageview logging\n   * and history logging:\n   *\n   * ````\n   * var clicky_custom = { pageview_disable : 1, history_disable : 1 };\n   * ````\n   */\n  angular.module('angulartics').config([\n    '$analyticsProvider', '$documentProvider', function($analyticsProvider, $documentProvider) {\n\n      var clickyApi;\n      var $document = $documentProvider.$get;\n\n      $analyticsProvider.settings.pageTracking.trackRelativePath = true;\n\n      angulartics.waitForVendorApi('clicky', 100, registerEvents);\n\n      /**\n       * Register Clicky page and event tracking\n       * @param {function} clicky - the clicky API function\n       */\n      function registerEvents(clicky) {\n\n        clickyApi = clicky;\n\n        if (clickyApi) {\n          $analyticsProvider.registerPageTrack(pageTrack);\n          $analyticsProvider.registerEventTrack(eventTrack);\n        }\n\n      }\n\n      /**\n       * Track pageview with Clicky\n       * @param {string} path\n       */\n      function pageTrack(path, properties) {\n        var title = properties.title || $document[0].title;\n        var type = validateType(properties.type);\n        clickyApi.log(path, title, type);\n      }\n\n      /**\n       * registerEventTrack handler. If `properties.goal` is defined, a clicky.goal() is logged,\n       * otherwise the clicky.log() is used.\n       * @param action\n       * @param properties\n       */\n      function eventTrack(action, properties) {\n\n        // goals parameters\n        var goalId, revenue, noQueue;\n\n        // log parameters\n        var title, type;\n\n        // if a goal is sent, use the Clicky goal method, otherwise reroute to log\n        if (angular.isDefined(properties.goal)) {\n\n          goalId = properties.goal;\n          revenue = validateNumber(properties.revenue) ? properties.revenue : undefined;\n          noQueue = !!properties.noQueue;\n          clickyApi.goal(goalId, revenue, noQueue);\n\n        } else {\n          // since `type` is a Clicky keyword, prefer `preoperties.type` over the eventType\n          type = (validateType(properties.type) === properties.type) ? properties.type : 'click';\n\n          // use the title if set, otherwise default to value\n          title = properties.title || properties.value;\n          var data = '';\n          if (properties.category) {\n            data += \"&ec=\" + properties.category; //encodeURIComponent(properties.category);\n          }\n\n          if (properties.label) {\n            data += \"&el=\" + properties.label; //encodeURIComponent(properties.label);\n          }\n\n          if (data) {\n            action = '/evt/' + action + data.replace('&', '?');\n          }\n\n          clickyApi.log(action, title, type);\n        }\n      }\n\n      /**\n       * Validates against Clicky's enumerated values for the page type.\n       * The default type is `click`, but we're choosing a default of\n       * `pageview` since pageTrack happens during route change\n       * @param type\n       * @returns {boolean|string}\n       * @link http://clicky.com/help/customization/manual#log\n       */\n      function validateType(type) {\n        var TYPE_ENUM = ['click', 'download', 'outbound', 'pageview'];\n\n        return (TYPE_ENUM.indexOf(type) >= 0) ? type : 'pageview';\n      }\n\n      /**\n       * Returns true if a finite number\n       * @param number\n       * @returns {boolean}\n       */\n      function validateNumber(number) {\n        return typeof number === 'number' && isFinite(number);\n      }\n\n    }\n  ]);\n\n})(angular);\n;(function () {\n\t'use strict';\n\n\t/**\n\t * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.\n\t *\n\t * @codingstandard ftlabs-jsv2\n\t * @copyright The Financial Times Limited [All Rights Reserved]\n\t * @license MIT License (see LICENSE.txt)\n\t */\n\n\t/*jslint browser:true, node:true*/\n\t/*global define, Event, Node*/\n\n\n\t/**\n\t * Instantiate fast-clicking listeners on the specified layer.\n\t *\n\t * @constructor\n\t * @param {Element} layer The layer to listen on\n\t * @param {Object} [options={}] The options to override the defaults\n\t */\n\tfunction FastClick(layer, options) {\n\t\tvar oldOnClick;\n\n\t\toptions = options || {};\n\n\t\t/**\n\t\t * Whether a click is currently being tracked.\n\t\t *\n\t\t * @type boolean\n\t\t */\n\t\tthis.trackingClick = false;\n\n\n\t\t/**\n\t\t * Timestamp for when click tracking started.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.trackingClickStart = 0;\n\n\n\t\t/**\n\t\t * The element being tracked for a click.\n\t\t *\n\t\t * @type EventTarget\n\t\t */\n\t\tthis.targetElement = null;\n\n\n\t\t/**\n\t\t * X-coordinate of touch start event.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchStartX = 0;\n\n\n\t\t/**\n\t\t * Y-coordinate of touch start event.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchStartY = 0;\n\n\n\t\t/**\n\t\t * ID of the last touch, retrieved from Touch.identifier.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.lastTouchIdentifier = 0;\n\n\n\t\t/**\n\t\t * Touchmove boundary, beyond which a click will be cancelled.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchBoundary = options.touchBoundary || 10;\n\n\n\t\t/**\n\t\t * The FastClick layer.\n\t\t *\n\t\t * @type Element\n\t\t */\n\t\tthis.layer = layer;\n\n\t\t/**\n\t\t * The minimum time between tap(touchstart and touchend) events\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.tapDelay = options.tapDelay || 200;\n\n\t\t/**\n\t\t * The maximum time for a tap\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.tapTimeout = options.tapTimeout || 700;\n\n\t\tif (FastClick.notNeeded(layer)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Some old versions of Android don't have Function.prototype.bind\n\t\tfunction bind(method, context) {\n\t\t\treturn function() { return method.apply(context, arguments); };\n\t\t}\n\n\n\t\tvar methods = ['onMouse', 'onClick', 'onTouchStart', 'onTouchMove', 'onTouchEnd', 'onTouchCancel'];\n\t\tvar context = this;\n\t\tfor (var i = 0, l = methods.length; i < l; i++) {\n\t\t\tcontext[methods[i]] = bind(context[methods[i]], context);\n\t\t}\n\n\t\t// Set up event handlers as required\n\t\tif (deviceIsAndroid) {\n\t\t\tlayer.addEventListener('mouseover', this.onMouse, true);\n\t\t\tlayer.addEventListener('mousedown', this.onMouse, true);\n\t\t\tlayer.addEventListener('mouseup', this.onMouse, true);\n\t\t}\n\n\t\tlayer.addEventListener('click', this.onClick, true);\n\t\tlayer.addEventListener('touchstart', this.onTouchStart, false);\n\t\tlayer.addEventListener('touchmove', this.onTouchMove, false);\n\t\tlayer.addEventListener('touchend', this.onTouchEnd, false);\n\t\tlayer.addEventListener('touchcancel', this.onTouchCancel, false);\n\n\t\t// Hack is required for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)\n\t\t// which is how FastClick normally stops click events bubbling to callbacks registered on the FastClick\n\t\t// layer when they are cancelled.\n\t\tif (!Event.prototype.stopImmediatePropagation) {\n\t\t\tlayer.removeEventListener = function(type, callback, capture) {\n\t\t\t\tvar rmv = Node.prototype.removeEventListener;\n\t\t\t\tif (type === 'click') {\n\t\t\t\t\trmv.call(layer, type, callback.hijacked || callback, capture);\n\t\t\t\t} else {\n\t\t\t\t\trmv.call(layer, type, callback, capture);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tlayer.addEventListener = function(type, callback, capture) {\n\t\t\t\tvar adv = Node.prototype.addEventListener;\n\t\t\t\tif (type === 'click') {\n\t\t\t\t\tadv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {\n\t\t\t\t\t\tif (!event.propagationStopped) {\n\t\t\t\t\t\t\tcallback(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t}), capture);\n\t\t\t\t} else {\n\t\t\t\t\tadv.call(layer, type, callback, capture);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// If a handler is already declared in the element's onclick attribute, it will be fired before\n\t\t// FastClick's onClick handler. Fix this by pulling out the user-defined handler function and\n\t\t// adding it as listener.\n\t\tif (typeof layer.onclick === 'function') {\n\n\t\t\t// Android browser on at least 3.2 requires a new reference to the function in layer.onclick\n\t\t\t// - the old one won't work if passed to addEventListener directly.\n\t\t\toldOnClick = layer.onclick;\n\t\t\tlayer.addEventListener('click', function(event) {\n\t\t\t\toldOnClick(event);\n\t\t\t}, false);\n\t\t\tlayer.onclick = null;\n\t\t}\n\t}\n\n\t/**\n\t* Windows Phone 8.1 fakes user agent string to look like Android and iPhone.\n\t*\n\t* @type boolean\n\t*/\n\tvar deviceIsWindowsPhone = navigator.userAgent.indexOf(\"Windows Phone\") >= 0;\n\n\t/**\n\t * Android requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsAndroid = navigator.userAgent.indexOf('Android') > 0 && !deviceIsWindowsPhone;\n\n\n\t/**\n\t * iOS requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOS = /iP(ad|hone|od)/.test(navigator.userAgent) && !deviceIsWindowsPhone;\n\n\n\t/**\n\t * iOS 4 requires an exception for select elements.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOS4 = deviceIsIOS && (/OS 4_\\d(_\\d)?/).test(navigator.userAgent);\n\n\n\t/**\n\t * iOS 6.0-7.* requires the target element to be manually derived\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOSWithBadTarget = deviceIsIOS && (/OS [6-7]_\\d/).test(navigator.userAgent);\n\n\t/**\n\t * BlackBerry requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsBlackBerry10 = navigator.userAgent.indexOf('BB10') > 0;\n\n\t/**\n\t * Determine whether a given element requires a native click.\n\t *\n\t * @param {EventTarget|Element} target Target DOM element\n\t * @returns {boolean} Returns true if the element needs a native click\n\t */\n\tFastClick.prototype.needsClick = function(target) {\n\t\tswitch (target.nodeName.toLowerCase()) {\n\n\t\t// Don't send a synthetic click to disabled inputs (issue #62)\n\t\tcase 'button':\n\t\tcase 'select':\n\t\tcase 'textarea':\n\t\t\tif (target.disabled) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'input':\n\n\t\t\t// File inputs need real clicks on iOS 6 due to a browser bug (issue #68)\n\t\t\tif ((deviceIsIOS && target.type === 'file') || target.disabled) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'label':\n\t\tcase 'iframe': // iOS8 homescreen apps can prevent events bubbling into frames\n\t\tcase 'video':\n\t\t\treturn true;\n\t\t}\n\n\t\treturn (/\\bneedsclick\\b/).test(target.className);\n\t};\n\n\n\t/**\n\t * Determine whether a given element requires a call to focus to simulate click into element.\n\t *\n\t * @param {EventTarget|Element} target Target DOM element\n\t * @returns {boolean} Returns true if the element requires a call to focus to simulate native click.\n\t */\n\tFastClick.prototype.needsFocus = function(target) {\n\t\tswitch (target.nodeName.toLowerCase()) {\n\t\tcase 'textarea':\n\t\t\treturn true;\n\t\tcase 'select':\n\t\t\treturn !deviceIsAndroid;\n\t\tcase 'input':\n\t\t\tswitch (target.type) {\n\t\t\tcase 'button':\n\t\t\tcase 'checkbox':\n\t\t\tcase 'file':\n\t\t\tcase 'image':\n\t\t\tcase 'radio':\n\t\t\tcase 'submit':\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// No point in attempting to focus disabled inputs\n\t\t\treturn !target.disabled && !target.readOnly;\n\t\tdefault:\n\t\t\treturn (/\\bneedsfocus\\b/).test(target.className);\n\t\t}\n\t};\n\n\n\t/**\n\t * Send a click event to the specified element.\n\t *\n\t * @param {EventTarget|Element} targetElement\n\t * @param {Event} event\n\t */\n\tFastClick.prototype.sendClick = function(targetElement, event) {\n\t\tvar clickEvent, touch;\n\n\t\t// On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect (#24)\n\t\tif (document.activeElement && document.activeElement !== targetElement) {\n\t\t\tdocument.activeElement.blur();\n\t\t}\n\n\t\ttouch = event.changedTouches[0];\n\n\t\t// Synthesise a click event, with an extra attribute so it can be tracked\n\t\tclickEvent = document.createEvent('MouseEvents');\n\t\tclickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\n\t\tclickEvent.forwardedTouchEvent = true;\n\t\ttargetElement.dispatchEvent(clickEvent);\n\t};\n\n\tFastClick.prototype.determineEventType = function(targetElement) {\n\n\t\t//Issue #159: Android Chrome Select Box does not open with a synthetic click event\n\t\tif (deviceIsAndroid && targetElement.tagName.toLowerCase() === 'select') {\n\t\t\treturn 'mousedown';\n\t\t}\n\n\t\treturn 'click';\n\t};\n\n\n\t/**\n\t * @param {EventTarget|Element} targetElement\n\t */\n\tFastClick.prototype.focus = function(targetElement) {\n\t\tvar length;\n\n\t\t// Issue #160: on iOS 7, some input elements (e.g. date datetime month) throw a vague TypeError on setSelectionRange. These elements don't have an integer value for the selectionStart and selectionEnd properties, but unfortunately that can't be used for detection because accessing the properties also throws a TypeError. Just check the type instead. Filed as Apple bug #15122724.\n\t\tif (deviceIsIOS && targetElement.setSelectionRange && targetElement.type.indexOf('date') !== 0 && targetElement.type !== 'time' && targetElement.type !== 'month') {\n\t\t\tlength = targetElement.value.length;\n\t\t\ttargetElement.setSelectionRange(length, length);\n\t\t} else {\n\t\t\ttargetElement.focus();\n\t\t}\n\t};\n\n\n\t/**\n\t * Check whether the given target element is a child of a scrollable layer and if so, set a flag on it.\n\t *\n\t * @param {EventTarget|Element} targetElement\n\t */\n\tFastClick.prototype.updateScrollParent = function(targetElement) {\n\t\tvar scrollParent, parentElement;\n\n\t\tscrollParent = targetElement.fastClickScrollParent;\n\n\t\t// Attempt to discover whether the target element is contained within a scrollable layer. Re-check if the\n\t\t// target element was moved to another parent.\n\t\tif (!scrollParent || !scrollParent.contains(targetElement)) {\n\t\t\tparentElement = targetElement;\n\t\t\tdo {\n\t\t\t\tif (parentElement.scrollHeight > parentElement.offsetHeight) {\n\t\t\t\t\tscrollParent = parentElement;\n\t\t\t\t\ttargetElement.fastClickScrollParent = parentElement;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tparentElement = parentElement.parentElement;\n\t\t\t} while (parentElement);\n\t\t}\n\n\t\t// Always update the scroll top tracker if possible.\n\t\tif (scrollParent) {\n\t\t\tscrollParent.fastClickLastScrollTop = scrollParent.scrollTop;\n\t\t}\n\t};\n\n\n\t/**\n\t * @param {EventTarget} targetElement\n\t * @returns {Element|EventTarget}\n\t */\n\tFastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) {\n\n\t\t// On some older browsers (notably Safari on iOS 4.1 - see issue #56) the event target may be a text node.\n\t\tif (eventTarget.nodeType === Node.TEXT_NODE) {\n\t\t\treturn eventTarget.parentNode;\n\t\t}\n\n\t\treturn eventTarget;\n\t};\n\n\n\t/**\n\t * On touch start, record the position and scroll offset.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchStart = function(event) {\n\t\tvar targetElement, touch, selection;\n\n\t\t// Ignore multiple touches, otherwise pinch-to-zoom is prevented if both fingers are on the FastClick element (issue #111).\n\t\tif (event.targetTouches.length > 1) {\n\t\t\treturn true;\n\t\t}\n\n\t\ttargetElement = this.getTargetElementFromEventTarget(event.target);\n\t\ttouch = event.targetTouches[0];\n\n\t\tif (deviceIsIOS) {\n\n\t\t\t// Only trusted events will deselect text on iOS (issue #49)\n\t\t\tselection = window.getSelection();\n\t\t\tif (selection.rangeCount && !selection.isCollapsed) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!deviceIsIOS4) {\n\n\t\t\t\t// Weird things happen on iOS when an alert or confirm dialog is opened from a click event callback (issue #23):\n\t\t\t\t// when the user next taps anywhere else on the page, new touchstart and touchend events are dispatched\n\t\t\t\t// with the same identifier as the touch event that previously triggered the click that triggered the alert.\n\t\t\t\t// Sadly, there is an issue on iOS 4 that causes some normal touch events to have the same identifier as an\n\t\t\t\t// immediately preceeding touch event (issue #52), so this fix is unavailable on that platform.\n\t\t\t\t// Issue 120: touch.identifier is 0 when Chrome dev tools 'Emulate touch events' is set with an iOS device UA string,\n\t\t\t\t// which causes all touch events to be ignored. As this block only applies to iOS, and iOS identifiers are always long,\n\t\t\t\t// random integers, it's safe to to continue if the identifier is 0 here.\n\t\t\t\tif (touch.identifier && touch.identifier === this.lastTouchIdentifier) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.lastTouchIdentifier = touch.identifier;\n\n\t\t\t\t// If the target element is a child of a scrollable layer (using -webkit-overflow-scrolling: touch) and:\n\t\t\t\t// 1) the user does a fling scroll on the scrollable layer\n\t\t\t\t// 2) the user stops the fling scroll with another tap\n\t\t\t\t// then the event.target of the last 'touchend' event will be the element that was under the user's finger\n\t\t\t\t// when the fling scroll was started, causing FastClick to send a click event to that layer - unless a check\n\t\t\t\t// is made to ensure that a parent layer was not scrolled before sending a synthetic click (issue #42).\n\t\t\t\tthis.updateScrollParent(targetElement);\n\t\t\t}\n\t\t}\n\n\t\tthis.trackingClick = true;\n\t\tthis.trackingClickStart = event.timeStamp;\n\t\tthis.targetElement = targetElement;\n\n\t\tthis.touchStartX = touch.pageX;\n\t\tthis.touchStartY = touch.pageY;\n\n\t\t// Prevent phantom clicks on fast double-tap (issue #36)\n\t\tif ((event.timeStamp - this.lastClickTime) < this.tapDelay) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Based on a touchmove event object, check whether the touch has moved past a boundary since it started.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.touchHasMoved = function(event) {\n\t\tvar touch = event.changedTouches[0], boundary = this.touchBoundary;\n\n\t\tif (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * Update the last position.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchMove = function(event) {\n\t\tif (!this.trackingClick) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// If the touch has moved, cancel the click tracking\n\t\tif (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) {\n\t\t\tthis.trackingClick = false;\n\t\t\tthis.targetElement = null;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Attempt to find the labelled control for the given label element.\n\t *\n\t * @param {EventTarget|HTMLLabelElement} labelElement\n\t * @returns {Element|null}\n\t */\n\tFastClick.prototype.findControl = function(labelElement) {\n\n\t\t// Fast path for newer browsers supporting the HTML5 control attribute\n\t\tif (labelElement.control !== undefined) {\n\t\t\treturn labelElement.control;\n\t\t}\n\n\t\t// All browsers under test that support touch events also support the HTML5 htmlFor attribute\n\t\tif (labelElement.htmlFor) {\n\t\t\treturn document.getElementById(labelElement.htmlFor);\n\t\t}\n\n\t\t// If no for attribute exists, attempt to retrieve the first labellable descendant element\n\t\t// the list of which is defined here: http://www.w3.org/TR/html5/forms.html#category-label\n\t\treturn labelElement.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea');\n\t};\n\n\n\t/**\n\t * On touch end, determine whether to send a click event at once.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchEnd = function(event) {\n\t\tvar forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement;\n\n\t\tif (!this.trackingClick) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Prevent phantom clicks on fast double-tap (issue #36)\n\t\tif ((event.timeStamp - this.lastClickTime) < this.tapDelay) {\n\t\t\tthis.cancelNextClick = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif ((event.timeStamp - this.trackingClickStart) > this.tapTimeout) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Reset to prevent wrong click cancel on input (issue #156).\n\t\tthis.cancelNextClick = false;\n\n\t\tthis.lastClickTime = event.timeStamp;\n\n\t\ttrackingClickStart = this.trackingClickStart;\n\t\tthis.trackingClick = false;\n\t\tthis.trackingClickStart = 0;\n\n\t\t// On some iOS devices, the targetElement supplied with the event is invalid if the layer\n\t\t// is performing a transition or scroll, and has to be re-detected manually. Note that\n\t\t// for this to function correctly, it must be called *after* the event target is checked!\n\t\t// See issue #57; also filed as rdar://13048589 .\n\t\tif (deviceIsIOSWithBadTarget) {\n\t\t\ttouch = event.changedTouches[0];\n\n\t\t\t// In certain cases arguments of elementFromPoint can be negative, so prevent setting targetElement to null\n\t\t\ttargetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement;\n\t\t\ttargetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent;\n\t\t}\n\n\t\ttargetTagName = targetElement.tagName.toLowerCase();\n\t\tif (targetTagName === 'label') {\n\t\t\tforElement = this.findControl(targetElement);\n\t\t\tif (forElement) {\n\t\t\t\tthis.focus(targetElement);\n\t\t\t\tif (deviceIsAndroid) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\ttargetElement = forElement;\n\t\t\t}\n\t\t} else if (this.needsFocus(targetElement)) {\n\n\t\t\t// Case 1: If the touch started a while ago (best guess is 100ms based on tests for issue #36) then focus will be triggered anyway. Return early and unset the target element reference so that the subsequent click will be allowed through.\n\t\t\t// Case 2: Without this exception for input elements tapped when the document is contained in an iframe, then any inputted text won't be visible even though the value attribute is updated as the user types (issue #37).\n\t\t\tif ((event.timeStamp - trackingClickStart) > 100 || (deviceIsIOS && window.top !== window && targetTagName === 'input')) {\n\t\t\t\tthis.targetElement = null;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.focus(targetElement);\n\t\t\tthis.sendClick(targetElement, event);\n\n\t\t\t// Select elements need the event to go through on iOS 4, otherwise the selector menu won't open.\n\t\t\t// Also this breaks opening selects when VoiceOver is active on iOS6, iOS7 (and possibly others)\n\t\t\tif (!deviceIsIOS || targetTagName !== 'select') {\n\t\t\t\tthis.targetElement = null;\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (deviceIsIOS && !deviceIsIOS4) {\n\n\t\t\t// Don't send a synthetic click event if the target element is contained within a parent layer that was scrolled\n\t\t\t// and this tap is being used to stop the scrolling (usually initiated by a fling - issue #42).\n\t\t\tscrollParent = targetElement.fastClickScrollParent;\n\t\t\tif (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Prevent the actual click from going though - unless the target node is marked as requiring\n\t\t// real clicks or if it is in the whitelist in which case only non-programmatic clicks are permitted.\n\t\tif (!this.needsClick(targetElement)) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.sendClick(targetElement, event);\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * On touch cancel, stop tracking the click.\n\t *\n\t * @returns {void}\n\t */\n\tFastClick.prototype.onTouchCancel = function() {\n\t\tthis.trackingClick = false;\n\t\tthis.targetElement = null;\n\t};\n\n\n\t/**\n\t * Determine mouse events which should be permitted.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onMouse = function(event) {\n\n\t\t// If a target element was never set (because a touch event was never fired) allow the event\n\t\tif (!this.targetElement) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (event.forwardedTouchEvent) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Programmatically generated events targeting a specific element should be permitted\n\t\tif (!event.cancelable) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Derive and check the target element to see whether the mouse event needs to be permitted;\n\t\t// unless explicitly enabled, prevent non-touch click events from triggering actions,\n\t\t// to prevent ghost/doubleclicks.\n\t\tif (!this.needsClick(this.targetElement) || this.cancelNextClick) {\n\n\t\t\t// Prevent any user-added listeners declared on FastClick element from being fired.\n\t\t\tif (event.stopImmediatePropagation) {\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t} else {\n\n\t\t\t\t// Part of the hack for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)\n\t\t\t\tevent.propagationStopped = true;\n\t\t\t}\n\n\t\t\t// Cancel the event\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// If the mouse event is permitted, return true for the action to go through.\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * On actual clicks, determine whether this is a touch-generated click, a click action occurring\n\t * naturally after a delay after a touch (which needs to be cancelled to avoid duplication), or\n\t * an actual click which should be permitted.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onClick = function(event) {\n\t\tvar permitted;\n\n\t\t// It's possible for another FastClick-like library delivered with third-party code to fire a click event before FastClick does (issue #44). In that case, set the click-tracking flag back to false and return early. This will cause onTouchEnd to return early.\n\t\tif (this.trackingClick) {\n\t\t\tthis.targetElement = null;\n\t\t\tthis.trackingClick = false;\n\t\t\treturn true;\n\t\t}\n\n\t\t// Very odd behaviour on iOS (issue #18): if a submit element is present inside a form and the user hits enter in the iOS simulator or clicks the Go button on the pop-up OS keyboard the a kind of 'fake' click event will be triggered with the submit-type input element as the target.\n\t\tif (event.target.type === 'submit' && event.detail === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tpermitted = this.onMouse(event);\n\n\t\t// Only unset targetElement if the click is not permitted. This will ensure that the check for !targetElement in onMouse fails and the browser's click doesn't go through.\n\t\tif (!permitted) {\n\t\t\tthis.targetElement = null;\n\t\t}\n\n\t\t// If clicks are permitted, return true for the action to go through.\n\t\treturn permitted;\n\t};\n\n\n\t/**\n\t * Remove all FastClick's event listeners.\n\t *\n\t * @returns {void}\n\t */\n\tFastClick.prototype.destroy = function() {\n\t\tvar layer = this.layer;\n\n\t\tif (deviceIsAndroid) {\n\t\t\tlayer.removeEventListener('mouseover', this.onMouse, true);\n\t\t\tlayer.removeEventListener('mousedown', this.onMouse, true);\n\t\t\tlayer.removeEventListener('mouseup', this.onMouse, true);\n\t\t}\n\n\t\tlayer.removeEventListener('click', this.onClick, true);\n\t\tlayer.removeEventListener('touchstart', this.onTouchStart, false);\n\t\tlayer.removeEventListener('touchmove', this.onTouchMove, false);\n\t\tlayer.removeEventListener('touchend', this.onTouchEnd, false);\n\t\tlayer.removeEventListener('touchcancel', this.onTouchCancel, false);\n\t};\n\n\n\t/**\n\t * Check whether FastClick is needed.\n\t *\n\t * @param {Element} layer The layer to listen on\n\t */\n\tFastClick.notNeeded = function(layer) {\n\t\tvar metaViewport;\n\t\tvar chromeVersion;\n\t\tvar blackberryVersion;\n\t\tvar firefoxVersion;\n\n\t\t// Devices that don't support touch don't need FastClick\n\t\tif (typeof window.ontouchstart === 'undefined') {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Chrome version - zero for other browsers\n\t\tchromeVersion = +(/Chrome\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];\n\n\t\tif (chromeVersion) {\n\n\t\t\tif (deviceIsAndroid) {\n\t\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\n\t\t\t\tif (metaViewport) {\n\t\t\t\t\t// Chrome on Android with user-scalable=\"no\" doesn't need FastClick (issue #89)\n\t\t\t\t\tif (metaViewport.content.indexOf('user-scalable=no') !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// Chrome 32 and above with width=device-width or less don't need FastClick\n\t\t\t\t\tif (chromeVersion > 31 && document.documentElement.scrollWidth <= window.outerWidth) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Chrome desktop doesn't need FastClick (issue #15)\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (deviceIsBlackBerry10) {\n\t\t\tblackberryVersion = navigator.userAgent.match(/Version\\/([0-9]*)\\.([0-9]*)/);\n\n\t\t\t// BlackBerry 10.3+ does not require Fastclick library.\n\t\t\t// https://github.com/ftlabs/fastclick/issues/251\n\t\t\tif (blackberryVersion[1] >= 10 && blackberryVersion[2] >= 3) {\n\t\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\n\t\t\t\tif (metaViewport) {\n\t\t\t\t\t// user-scalable=no eliminates click delay.\n\t\t\t\t\tif (metaViewport.content.indexOf('user-scalable=no') !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// width=device-width (or less than device-width) eliminates click delay.\n\t\t\t\t\tif (document.documentElement.scrollWidth <= window.outerWidth) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// IE10 with -ms-touch-action: none or manipulation, which disables double-tap-to-zoom (issue #97)\n\t\tif (layer.style.msTouchAction === 'none' || layer.style.touchAction === 'manipulation') {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Firefox version - zero for other browsers\n\t\tfirefoxVersion = +(/Firefox\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];\n\n\t\tif (firefoxVersion >= 27) {\n\t\t\t// Firefox 27+ does not have tap delay if the content is not zoomable - https://bugzilla.mozilla.org/show_bug.cgi?id=922896\n\n\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\t\t\tif (metaViewport && (metaViewport.content.indexOf('user-scalable=no') !== -1 || document.documentElement.scrollWidth <= window.outerWidth)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// IE11: prefixed -ms-touch-action is no longer supported and it's recomended to use non-prefixed version\n\t\t// http://msdn.microsoft.com/en-us/library/windows/apps/Hh767313.aspx\n\t\tif (layer.style.touchAction === 'none' || layer.style.touchAction === 'manipulation') {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * Factory method for creating a FastClick object\n\t *\n\t * @param {Element} layer The layer to listen on\n\t * @param {Object} [options={}] The options to override the defaults\n\t */\n\tFastClick.attach = function(layer, options) {\n\t\treturn new FastClick(layer, options);\n\t};\n\n\n\tif (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine(function() {\n\t\t\treturn FastClick;\n\t\t});\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = FastClick.attach;\n\t\tmodule.exports.FastClick = FastClick;\n\t} else {\n\t\twindow.FastClick = FastClick;\n\t}\n}());\n\n;(function(){\"use strict\";angular.module(\"angular-loading-bar\",[\"chieffancypants.loadingBar\"]);angular.module(\"chieffancypants.loadingBar\",[]).config([\"$httpProvider\",function(e){var t=[\"$q\",\"$cacheFactory\",\"$timeout\",\"$rootScope\",\"cfpLoadingBar\",function(t,n,r,i,s){function l(){r.cancel(f);s.complete();u=0;o=0}function c(t){var r;var i=e.defaults;if(t.method!==\"GET\"||t.cache===false){t.cached=false;return false}if(t.cache===true&&i.cache===undefined){r=n.get(\"$http\")}else if(i.cache!==undefined){r=i.cache}else{r=t.cache}var s=r!==undefined?r.get(t.url)!==undefined:false;if(t.cached!==undefined&&s!==t.cached){return t.cached}t.cached=s;return s}var o=0;var u=0;var a=s.latencyThreshold;var f;return{request:function(e){if(!e.ignoreLoadingBar&&!c(e)){i.$broadcast(\"cfpLoadingBar:loading\",{url:e.url});if(o===0){f=r(function(){s.start()},a)}o++;s.set(u/o)}return e},response:function(e){if(!c(e.config)){u++;i.$broadcast(\"cfpLoadingBar:loaded\",{url:e.config.url});if(u>=o){l()}else{s.set(u/o)}}return e},responseError:function(e){if(!c(e.config)){u++;i.$broadcast(\"cfpLoadingBar:loaded\",{url:e.config.url});if(u>=o){l()}else{s.set(u/o)}}return t.reject(e)}}}];e.interceptors.push(t)}]).provider(\"cfpLoadingBar\",function(){this.includeSpinner=true;this.includeBar=true;this.latencyThreshold=100;this.parentSelector=\"body\";this.$get=[\"$document\",\"$timeout\",\"$animate\",\"$rootScope\",function(e,t,n,r){function v(){t.cancel(l);if(c){return}r.$broadcast(\"cfpLoadingBar:started\");c=true;if(d){n.enter(o,s)}if(p){n.enter(a,s)}m(.02)}function m(e){if(!c){return}var n=e*100+\"%\";u.css(\"width\",n);h=e;t.cancel(f);f=t(function(){g()},250)}function g(){if(y()>=1){return}var e=0;var t=y();if(t>=0&&t<.25){e=(Math.random()*(5-3+1)+3)/100}else if(t>=.25&&t<.65){e=Math.random()*3/100}else if(t>=.65&&t<.9){e=Math.random()*2/100}else if(t>=.9&&t<.99){e=.005}else{e=0}var n=y()+e;m(n)}function y(){return h}function b(){r.$broadcast(\"cfpLoadingBar:completed\");m(1);l=t(function(){n.leave(o,function(){h=0;c=false});n.leave(a)},500)}var i=this.parentSelector,s=e.find(i),o=angular.element('<div id=\"loading-bar\"><div class=\"bar\"><div class=\"peg\"></div></div></div>'),u=o.find(\"div\").eq(0),a=angular.element('<div id=\"loading-bar-spinner\"><img src=\"//cdn.brickinc.net/script/images/loading.gif\" alt=\"loading spinner\" class=\"spinner-icon\" /></div>');var f,l,c=false,h=0;var p=this.includeSpinner;var d=this.includeBar;return{start:v,set:m,status:y,inc:g,complete:b,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector}}]})})();\n\n/* ng-infinite-scroll - v1.0.0 - 2013-02-23 */\nvar mod;mod=angular.module(\"infinite-scroll\",[]),mod.directive(\"infiniteScroll\",[\"$rootScope\",\"$window\",\"$timeout\",function(i,n,e){return{link:function(t,l,o){var r,c,f,a;return n=angular.element(n),f=0,null!=o.infiniteScrollDistance&&t.$watch(o.infiniteScrollDistance,function(i){return f=parseInt(i,10)}),a=!0,r=!1,null!=o.infiniteScrollDisabled&&t.$watch(o.infiniteScrollDisabled,function(i){return a=!i,a&&r?(r=!1,c()):void 0}),c=function(){var e,c,u,d;return d=n.height()+n.scrollTop(),e=l.offset().top+l.height(),c=e-d,u=n.height()*f>=c,u&&a?i.$$phase?t.$eval(o.infiniteScroll):t.$apply(o.infiniteScroll):u?r=!0:void 0},n.on(\"scroll\",c),t.$on(\"$destroy\",function(){return n.off(\"scroll\",c)}),e(function(){return o.infiniteScrollImmediateCheck?t.$eval(o.infiniteScrollImmediateCheck)?c():void 0:c()},0)}}}]);\n/**\n * angular-ui-utils - Swiss-Army-Knife of AngularJS tools (with no external dependencies!)\n * @version v0.1.0 - 2013-12-30\n * @link http://angular-ui.github.com\n * @license MIT License, http://www.opensource.org/licenses/MIT\n */\n\"use strict\";angular.module(\"ui.alias\",[]).config([\"$compileProvider\",\"uiAliasConfig\",function(a,b){b=b||{},angular.forEach(b,function(b,c){angular.isString(b)&&(b={replace:!0,template:b}),a.directive(c,function(){return b})})}]),angular.module(\"ui.event\",[]).directive(\"uiEvent\",[\"$parse\",function(a){return function(b,c,d){var e=b.$eval(d.uiEvent);angular.forEach(e,function(d,e){var f=a(d);c.bind(e,function(a){var c=Array.prototype.slice.call(arguments);c=c.splice(1),f(b,{$event:a,$params:c}),b.$$phase||b.$apply()})})}}]),angular.module(\"ui.format\",[]).filter(\"format\",function(){return function(a,b){var c=a;if(angular.isString(c)&&void 0!==b)if(angular.isArray(b)||angular.isObject(b)||(b=[b]),angular.isArray(b)){var d=b.length,e=function(a,c){return c=parseInt(c,10),c>=0&&d>c?b[c]:a};c=c.replace(/\\$([0-9]+)/g,e)}else angular.forEach(b,function(a,b){c=c.split(\":\"+b).join(a)});return c}}),angular.module(\"ui.highlight\",[]).filter(\"highlight\",function(){return function(a,b,c){return b||angular.isNumber(b)?(a=a.toString(),b=b.toString(),c?a.split(b).join('<span class=\"ui-match\">'+b+\"</span>\"):a.replace(new RegExp(b,\"gi\"),'<span class=\"ui-match\">$&</span>')):a}}),angular.module(\"ui.include\",[]).directive(\"uiInclude\",[\"$http\",\"$templateCache\",\"$anchorScroll\",\"$compile\",function(a,b,c,d){return{restrict:\"ECA\",terminal:!0,compile:function(e,f){var g=f.uiInclude||f.src,h=f.fragment||\"\",i=f.onload||\"\",j=f.autoscroll;return function(e,f){function k(){var k=++m,o=e.$eval(g),p=e.$eval(h);o?a.get(o,{cache:b}).success(function(a){if(k===m){l&&l.$destroy(),l=e.$new();var b;b=p?angular.element(\"<div/>\").html(a).find(p):angular.element(\"<div/>\").html(a).contents(),f.html(b),d(b)(l),!angular.isDefined(j)||j&&!e.$eval(j)||c(),l.$emit(\"$includeContentLoaded\"),e.$eval(i)}}).error(function(){k===m&&n()}):n()}var l,m=0,n=function(){l&&(l.$destroy(),l=null),f.html(\"\")};e.$watch(h,k),e.$watch(g,k)}}}}]),angular.module(\"ui.indeterminate\",[]).directive(\"uiIndeterminate\",[function(){return{compile:function(a,b){return b.type&&\"checkbox\"===b.type.toLowerCase()?function(a,b,c){a.$watch(c.uiIndeterminate,function(a){b[0].indeterminate=!!a})}:angular.noop}}}]),angular.module(\"ui.inflector\",[]).filter(\"inflector\",function(){function a(a){return a.replace(/^([a-z])|\\s+([a-z])/g,function(a){return a.toUpperCase()})}function b(a,b){return a.replace(/[A-Z]/g,function(a){return b+a})}var c={humanize:function(c){return a(b(c,\" \").split(\"_\").join(\" \"))},underscore:function(a){return a.substr(0,1).toLowerCase()+b(a.substr(1),\"_\").toLowerCase().split(\" \").join(\"_\")},variable:function(b){return b=b.substr(0,1).toLowerCase()+a(b.split(\"_\").join(\" \")).substr(1).split(\" \").join(\"\")}};return function(a,b){return b!==!1&&angular.isString(a)?(b=b||\"humanize\",c[b](a)):a}}),angular.module(\"ui.jq\",[]).value(\"uiJqConfig\",{}).directive(\"uiJq\",[\"uiJqConfig\",\"$timeout\",function(a,b){return{restrict:\"A\",compile:function(c,d){if(!angular.isFunction(c[d.uiJq]))throw new Error('ui-jq: The \"'+d.uiJq+'\" function does not exist');var e=a&&a[d.uiJq];return function(a,c,d){function f(){b(function(){c[d.uiJq].apply(c,g)},0,!1)}var g=[];d.uiOptions?(g=a.$eval(\"[\"+d.uiOptions+\"]\"),angular.isObject(e)&&angular.isObject(g[0])&&(g[0]=angular.extend({},e,g[0]))):e&&(g=[e]),d.ngModel&&c.is(\"select,input,textarea\")&&c.bind(\"change\",function(){c.trigger(\"input\")}),d.uiRefresh&&a.$watch(d.uiRefresh,function(){f()}),f()}}}}]),angular.module(\"ui.keypress\",[]).factory(\"keypressHelper\",[\"$parse\",function(a){var b={8:\"backspace\",9:\"tab\",13:\"enter\",27:\"esc\",32:\"space\",33:\"pageup\",34:\"pagedown\",35:\"end\",36:\"home\",37:\"left\",38:\"up\",39:\"right\",40:\"down\",45:\"insert\",46:\"delete\"},c=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};return function(d,e,f,g){var h,i=[];h=e.$eval(g[\"ui\"+c(d)]),angular.forEach(h,function(b,c){var d,e;e=a(b),angular.forEach(c.split(\" \"),function(a){d={expression:e,keys:{}},angular.forEach(a.split(\"-\"),function(a){d.keys[a]=!0}),i.push(d)})}),f.bind(d,function(a){var c=!(!a.metaKey||a.ctrlKey),f=!!a.altKey,g=!!a.ctrlKey,h=!!a.shiftKey,j=a.keyCode;\"keypress\"===d&&!h&&j>=97&&122>=j&&(j-=32),angular.forEach(i,function(d){var i=d.keys[b[j]]||d.keys[j.toString()],k=!!d.keys.meta,l=!!d.keys.alt,m=!!d.keys.ctrl,n=!!d.keys.shift;i&&k===c&&l===f&&m===g&&n===h&&e.$apply(function(){d.expression(e,{$event:a})})})})}}]),angular.module(\"ui.keypress\").directive(\"uiKeydown\",[\"keypressHelper\",function(a){return{link:function(b,c,d){a(\"keydown\",b,c,d)}}}]),angular.module(\"ui.keypress\").directive(\"uiKeypress\",[\"keypressHelper\",function(a){return{link:function(b,c,d){a(\"keypress\",b,c,d)}}}]),angular.module(\"ui.keypress\").directive(\"uiKeyup\",[\"keypressHelper\",function(a){return{link:function(b,c,d){a(\"keyup\",b,c,d)}}}]),angular.module(\"ui.mask\",[]).value(\"uiMaskConfig\",{maskDefinitions:{9:/\\d/,A:/[a-zA-Z]/,\"*\":/[a-zA-Z0-9]/}}).directive(\"uiMask\",[\"uiMaskConfig\",function(a){return{priority:100,require:\"ngModel\",restrict:\"A\",compile:function(){var b=a;return function(a,c,d,e){function f(a){return angular.isDefined(a)?(s(a),N?(k(),l(),!0):j()):j()}function g(a){angular.isDefined(a)&&(D=a,N&&w())}function h(a){return N?(G=o(a||\"\"),I=n(G),e.$setValidity(\"mask\",I),I&&G.length?p(G):void 0):a}function i(a){return N?(G=o(a||\"\"),I=n(G),e.$viewValue=G.length?p(G):\"\",e.$setValidity(\"mask\",I),\"\"===G&&void 0!==e.$error.required&&e.$setValidity(\"required\",!1),I?G:void 0):a}function j(){return N=!1,m(),angular.isDefined(P)?c.attr(\"placeholder\",P):c.removeAttr(\"placeholder\"),angular.isDefined(Q)?c.attr(\"maxlength\",Q):c.removeAttr(\"maxlength\"),c.val(e.$modelValue),e.$viewValue=e.$modelValue,!1}function k(){G=K=o(e.$modelValue||\"\"),H=J=p(G),I=n(G);var a=I&&G.length?H:\"\";d.maxlength&&c.attr(\"maxlength\",2*B[B.length-1]),c.attr(\"placeholder\",D),c.val(a),e.$viewValue=a}function l(){O||(c.bind(\"blur\",t),c.bind(\"mousedown mouseup\",u),c.bind(\"input keyup click focus\",w),O=!0)}function m(){O&&(c.unbind(\"blur\",t),c.unbind(\"mousedown\",u),c.unbind(\"mouseup\",u),c.unbind(\"input\",w),c.unbind(\"keyup\",w),c.unbind(\"click\",w),c.unbind(\"focus\",w),O=!1)}function n(a){return a.length?a.length>=F:!0}function o(a){var b=\"\",c=C.slice();return a=a.toString(),angular.forEach(E,function(b){a=a.replace(b,\"\")}),angular.forEach(a.split(\"\"),function(a){c.length&&c[0].test(a)&&(b+=a,c.shift())}),b}function p(a){var b=\"\",c=B.slice();return angular.forEach(D.split(\"\"),function(d,e){a.length&&e===c[0]?(b+=a.charAt(0)||\"_\",a=a.substr(1),c.shift()):b+=d}),b}function q(a){var b=d.placeholder;return\"undefined\"!=typeof b&&b[a]?b[a]:\"_\"}function r(){return D.replace(/[_]+/g,\"_\").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,\"$1$2_$3\").split(\"_\")}function s(a){var b=0;if(B=[],C=[],D=\"\",\"string\"==typeof a){F=0;var c=!1,d=a.split(\"\");angular.forEach(d,function(a,d){R.maskDefinitions[a]?(B.push(b),D+=q(d),C.push(R.maskDefinitions[a]),b++,c||F++):\"?\"===a?c=!0:(D+=a,b++)})}B.push(B.slice().pop()+1),E=r(),N=B.length>1?!0:!1}function t(){L=0,M=0,I&&0!==G.length||(H=\"\",c.val(\"\"),a.$apply(function(){e.$setViewValue(\"\")}))}function u(a){\"mousedown\"===a.type?c.bind(\"mouseout\",v):c.unbind(\"mouseout\",v)}function v(){M=A(this),c.unbind(\"mouseout\",v)}function w(b){b=b||{};var d=b.which,f=b.type;if(16!==d&&91!==d){var g,h=c.val(),i=J,j=o(h),k=K,l=!1,m=y(this)||0,n=L||0,q=m-n,r=B[0],s=B[j.length]||B.slice().shift(),t=M||0,u=A(this)>0,v=t>0,w=h.length>i.length||t&&h.length>i.length-t,C=h.length<i.length||t&&h.length===i.length-t,D=d>=37&&40>=d&&b.shiftKey,E=37===d,F=8===d||\"keyup\"!==f&&C&&-1===q,G=46===d||\"keyup\"!==f&&C&&0===q&&!v,H=(E||F||\"click\"===f)&&m>r;if(M=A(this),!D&&(!u||\"click\"!==f&&\"keyup\"!==f)){if(\"input\"===f&&C&&!v&&j===k){for(;F&&m>r&&!x(m);)m--;for(;G&&s>m&&-1===B.indexOf(m);)m++;var I=B.indexOf(m);j=j.substring(0,I)+j.substring(I+1),l=!0}for(g=p(j),J=g,K=j,c.val(g),l&&a.$apply(function(){e.$setViewValue(j)}),w&&r>=m&&(m=r+1),H&&m--,m=m>s?s:r>m?r:m;!x(m)&&m>r&&s>m;)m+=H?-1:1;(H&&s>m||w&&!x(n))&&m++,L=m,z(this,m)}}}function x(a){return B.indexOf(a)>-1}function y(a){if(!a)return 0;if(void 0!==a.selectionStart)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();return b.moveStart(\"character\",-a.value.length),b.text.length}return 0}function z(a,b){if(!a)return 0;if(0!==a.offsetWidth&&0!==a.offsetHeight)if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd(\"character\",b),c.moveStart(\"character\",b),c.select()}}function A(a){return a?void 0!==a.selectionStart?a.selectionEnd-a.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var B,C,D,E,F,G,H,I,J,K,L,M,N=!1,O=!1,P=d.placeholder,Q=d.maxlength,R={};d.uiOptions?(R=a.$eval(\"[\"+d.uiOptions+\"]\"),angular.isObject(R[0])&&(R=function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]?angular.extend(b[c],a[c]):b[c]=angular.copy(a[c]));return b}(b,R[0]))):R=b,d.$observe(\"uiMask\",f),d.$observe(\"placeholder\",g),e.$formatters.push(h),e.$parsers.push(i),c.bind(\"mousedown mouseup\",u),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&1/0!==d&&d!==-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1})}}}}]),angular.module(\"ui.reset\",[]).value(\"uiResetConfig\",null).directive(\"uiReset\",[\"uiResetConfig\",function(a){var b=null;return void 0!==a&&(b=a),{require:\"ngModel\",link:function(a,c,d,e){var f;f=angular.element('<a class=\"ui-reset\" />'),c.wrap('<span class=\"ui-resetwrap\" />').after(f),f.bind(\"click\",function(c){c.preventDefault(),a.$apply(function(){d.uiReset?e.$setViewValue(a.$eval(d.uiReset)):e.$setViewValue(b),e.$render()})})}}}]),angular.module(\"ui.route\",[]).directive(\"uiRoute\",[\"$location\",\"$parse\",function(a,b){return{restrict:\"AC\",scope:!0,compile:function(c,d){var e;if(d.uiRoute)e=\"uiRoute\";else if(d.ngHref)e=\"ngHref\";else{if(!d.href)throw new Error(\"uiRoute missing a route or href property on \"+c[0]);e=\"href\"}return function(c,d,f){function g(b){var d=b.indexOf(\"#\");d>-1&&(b=b.substr(d+1)),(j=function(){i(c,a.path().indexOf(b)>-1)})()}function h(b){var d=b.indexOf(\"#\");d>-1&&(b=b.substr(d+1)),(j=function(){var d=new RegExp(\"^\"+b+\"$\",[\"i\"]);i(c,d.test(a.path()))})()}var i=b(f.ngModel||f.routeModel||\"$uiRoute\").assign,j=angular.noop;switch(e){case\"uiRoute\":f.uiRoute?h(f.uiRoute):f.$observe(\"uiRoute\",h);break;case\"ngHref\":f.ngHref?g(f.ngHref):f.$observe(\"ngHref\",g);break;case\"href\":g(f.href)}c.$on(\"$routeChangeSuccess\",function(){j()}),c.$on(\"$stateChangeSuccess\",function(){j()})}}}}]),angular.module(\"ui.scroll.jqlite\",[\"ui.scroll\"]).service(\"jqLiteExtras\",[\"$log\",\"$window\",function(a,b){return{registerFor:function(a){var c,d,e,f,g,h,i;return d=angular.element.prototype.css,a.prototype.css=function(a,b){var c,e;return e=this,c=e[0],c&&3!==c.nodeType&&8!==c.nodeType&&c.style?d.call(e,a,b):void 0},h=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},i=function(a,b,c){var d,e,f,g,i;return d=a[0],i={top:[\"scrollTop\",\"pageYOffset\",\"scrollLeft\"],left:[\"scrollLeft\",\"pageXOffset\",\"scrollTop\"]}[b],e=i[0],g=i[1],f=i[2],h(d)?angular.isDefined(c)?d.scrollTo(a[f].call(a),c):g in d?d[g]:d.document.documentElement[e]:angular.isDefined(c)?d[e]=c:d[e]},b.getComputedStyle?(f=function(a){return b.getComputedStyle(a,null)},c=function(a,b){return parseFloat(b)}):(f=function(a){return a.currentStyle},c=function(a,b){var c,d,e,f,g,h,i;return c=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,f=new RegExp(\"^(\"+c+\")(?!px)[a-z%]+$\",\"i\"),f.test(b)?(i=a.style,d=i.left,g=a.runtimeStyle,h=g&&g.left,g&&(g.left=i.left),i.left=b,e=i.pixelLeft,i.left=d,h&&(g.left=h),e):parseFloat(b)}),e=function(a,b){var d,e,g,i,j,k,l,m,n,o,p,q,r;return h(a)?(d=document.documentElement[{height:\"clientHeight\",width:\"clientWidth\"}[b]],{base:d,padding:0,border:0,margin:0}):(r={width:[a.offsetWidth,\"Left\",\"Right\"],height:[a.offsetHeight,\"Top\",\"Bottom\"]}[b],d=r[0],l=r[1],m=r[2],k=f(a),p=c(a,k[\"padding\"+l])||0,q=c(a,k[\"padding\"+m])||0,e=c(a,k[\"border\"+l+\"Width\"])||0,g=c(a,k[\"border\"+m+\"Width\"])||0,i=k[\"margin\"+l],j=k[\"margin\"+m],n=c(a,i)||0,o=c(a,j)||0,{base:d,padding:p+q,border:e+g,margin:n+o})},g=function(a,b,c){var d,g,h;return g=e(a,b),g.base>0?{base:g.base-g.padding-g.border,outer:g.base,outerfull:g.base+g.margin}[c]:(d=f(a),h=d[b],(0>h||null===h)&&(h=a.style[b]||0),h=parseFloat(h)||0,{base:h-g.padding-g.border,outer:h,outerfull:h+g.padding+g.border+g.margin}[c])},angular.forEach({before:function(a){var b,c,d,e,f,g,h;if(f=this,c=f[0],e=f.parent(),b=e.contents(),b[0]===c)return e.prepend(a);for(d=g=1,h=b.length-1;h>=1?h>=g:g>=h;d=h>=1?++g:--g)if(b[d]===c)return angular.element(b[d-1]).after(a),void 0;throw new Error(\"invalid DOM structure \"+c.outerHTML)},height:function(a){var b;return b=this,angular.isDefined(a)?(angular.isNumber(a)&&(a+=\"px\"),d.call(b,\"height\",a)):g(this[0],\"height\",\"base\")},outerHeight:function(a){return g(this[0],\"height\",a?\"outerfull\":\"outer\")},offset:function(a){var b,c,d,e,f,g;return f=this,arguments.length?void 0===a?f:a:(b={top:0,left:0},e=f[0],(c=e&&e.ownerDocument)?(d=c.documentElement,e.getBoundingClientRect&&(b=e.getBoundingClientRect()),g=c.defaultView||c.parentWindow,{top:b.top+(g.pageYOffset||d.scrollTop)-(d.clientTop||0),left:b.left+(g.pageXOffset||d.scrollLeft)-(d.clientLeft||0)}):void 0)},scrollTop:function(a){return i(this,\"top\",a)},scrollLeft:function(a){return i(this,\"left\",a)}},function(b,c){return a.prototype[c]?void 0:a.prototype[c]=b})}}}]).run([\"$log\",\"$window\",\"jqLiteExtras\",function(a,b,c){return b.jQuery?void 0:c.registerFor(angular.element)}]),angular.module(\"ui.scroll\",[]).directive(\"ngScrollViewport\",[\"$log\",function(){return{controller:[\"$scope\",\"$element\",function(a,b){return b}]}}]).directive(\"ngScroll\",[\"$log\",\"$injector\",\"$rootScope\",\"$timeout\",function(a,b,c,d){return{require:[\"?^ngScrollViewport\"],transclude:\"element\",priority:1e3,terminal:!0,compile:function(e,f,g){return function(f,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;if(H=i.ngScroll.match(/^\\s*(\\w+)\\s+in\\s+(\\w+)\\s*$/),!H)throw new Error('Expected ngScroll in form of \"item_ in _datasource_\" but got \"'+i.ngScroll+'\"');if(F=H[1],v=H[2],D=function(a){return angular.isObject(a)&&a.get&&angular.isFunction(a.get)},u=f[v],!D(u)&&(u=b.get(v),!D(u)))throw new Error(v+\" is not a valid datasource\");return r=Math.max(3,+i.bufferSize||10),q=function(){return T.height()*Math.max(.1,+i.padding||.1)},O=function(a){return a[0].scrollHeight||a[0].document.documentElement.scrollHeight},k=null,g(R=f.$new(),function(a){var b,c,d,f,g,h;if(f=a[0].localName,\"dl\"===f)throw new Error(\"ng-scroll directive does not support <\"+a[0].localName+\"> as a repeating tag: \"+a[0].outerHTML);return\"li\"!==f&&\"tr\"!==f&&(f=\"div\"),h=j[0]||angular.element(window),h.css({\"overflow-y\":\"auto\",display:\"block\"}),d=function(a){var b,c,d;switch(a){case\"tr\":return d=angular.element(\"<table><tr><td><div></div></td></tr></table>\"),b=d.find(\"div\"),c=d.find(\"tr\"),c.paddingHeight=function(){return b.height.apply(b,arguments)},c;default:return c=angular.element(\"<\"+a+\"></\"+a+\">\"),c.paddingHeight=c.height,c}},c=function(a,b,c){return b[{top:\"before\",bottom:\"after\"}[c]](a),{paddingHeight:function(){return a.paddingHeight.apply(a,arguments)},insert:function(b){return a[{top:\"after\",bottom:\"before\"}[c]](b)}}},g=c(d(f),e,\"top\"),b=c(d(f),e,\"bottom\"),R.$destroy(),k={viewport:h,topPadding:g.paddingHeight,bottomPadding:b.paddingHeight,append:b.insert,prepend:g.insert,bottomDataPos:function(){return O(h)-b.paddingHeight()},topDataPos:function(){return g.paddingHeight()}}}),T=k.viewport,B=1,I=1,p=[],J=[],x=!1,n=!1,G=u.loading||function(){},E=!1,L=function(a,b){var c,d;for(c=d=a;b>=a?b>d:d>b;c=b>=a?++d:--d)p[c].scope.$destroy(),p[c].element.remove();return p.splice(a,b-a)},K=function(){return B=1,I=1,L(0,p.length),k.topPadding(0),k.bottomPadding(0),J=[],x=!1,n=!1,l(!1)},o=function(){return T.scrollTop()+T.height()},S=function(){return T.scrollTop()},P=function(){return!x&&k.bottomDataPos()<o()+q()},s=function(){var b,c,d,e,f,g;for(b=0,e=0,c=f=g=p.length-1;(0>=g?0>=f:f>=0)&&(d=p[c].element.outerHeight(!0),k.bottomDataPos()-b-d>o()+q());c=0>=g?++f:--f)b+=d,e++,x=!1;return e>0?(k.bottomPadding(k.bottomPadding()+b),L(p.length-e,p.length),I-=e,a.log(\"clipped off bottom \"+e+\" bottom padding \"+k.bottomPadding())):void 0},Q=function(){return!n&&k.topDataPos()>S()-q()},t=function(){var b,c,d,e,f,g;for(e=0,d=0,f=0,g=p.length;g>f&&(b=p[f],c=b.element.outerHeight(!0),k.topDataPos()+e+c<S()-q());f++)e+=c,d++,n=!1;return d>0?(k.topPadding(k.topPadding()+e),L(0,d),B+=d,a.log(\"clipped off top \"+d+\" top padding \"+k.topPadding())):void 0},w=function(a,b){return E||(E=!0,G(!0)),1===J.push(a)?z(b):void 0},C=function(a,b){var c,d,e;return c=f.$new(),c[F]=b,d=a>B,c.$index=a,d&&c.$index--,e={scope:c},g(c,function(b){return e.element=b,d?a===I?(k.append(b),p.push(e)):(p[a-B].element.after(b),p.splice(a-B+1,0,e)):(k.prepend(b),p.unshift(e))}),{appended:d,wrapper:e}},m=function(a,b){var c;return a?k.bottomPadding(Math.max(0,k.bottomPadding()-b.element.outerHeight(!0))):(c=k.topPadding()-b.element.outerHeight(!0),c>=0?k.topPadding(c):T.scrollTop(T.scrollTop()+b.element.outerHeight(!0)))},l=function(b,c,e){var f;return f=function(){return a.log(\"top {actual=\"+k.topDataPos()+\" visible from=\"+S()+\" bottom {visible through=\"+o()+\" actual=\"+k.bottomDataPos()+\"}\"),P()?w(!0,b):Q()&&w(!1,b),e?e():void 0},c?d(function(){var a,b,d;for(b=0,d=c.length;d>b;b++)a=c[b],m(a.appended,a.wrapper);return f()}):f()},A=function(a,b){return l(a,b,function(){return J.shift(),0===J.length?(E=!1,G(!1)):z(a)})},z=function(b){var c;return c=J[0],c?p.length&&!P()?A(b):u.get(I,r,function(c){var d,e,f,g;if(e=[],0===c.length)x=!0,k.bottomPadding(0),a.log(\"appended: requested \"+r+\" records starting from \"+I+\" recieved: eof\");else{for(t(),f=0,g=c.length;g>f;f++)d=c[f],e.push(C(++I,d));a.log(\"appended: requested \"+r+\" received \"+c.length+\" buffer size \"+p.length+\" first \"+B+\" next \"+I)}return A(b,e)}):p.length&&!Q()?A(b):u.get(B-r,r,function(c){var d,e,f,g;if(e=[],0===c.length)n=!0,k.topPadding(0),a.log(\"prepended: requested \"+r+\" records starting from \"+(B-r)+\" recieved: bof\");else{for(s(),d=f=g=c.length-1;0>=g?0>=f:f>=0;d=0>=g?++f:--f)e.unshift(C(--B,c[d]));a.log(\"prepended: requested \"+r+\" received \"+c.length+\" buffer size \"+p.length+\" first \"+B+\" next \"+I)}return A(b,e)})},M=function(){return c.$$phase||E?void 0:(l(!1),f.$apply())},T.bind(\"resize\",M),N=function(){return c.$$phase||E?void 0:(l(!0),f.$apply())},T.bind(\"scroll\",N),f.$watch(u.revision,function(){return K()}),y=u.scope?u.scope.$new():f.$new(),f.$on(\"$destroy\",function(){return y.$destroy(),T.unbind(\"resize\",M),T.unbind(\"scroll\",N)}),y.$on(\"update.items\",function(a,b,c){var d,e,f,g,h;if(angular.isFunction(b))for(e=function(a){return b(a.scope)},f=0,g=p.length;g>f;f++)d=p[f],e(d);else 0<=(h=b-B-1)&&h<p.length&&(p[b-B-1].scope[F]=c);return null}),y.$on(\"delete.items\",function(a,b){var c,d,e,f,g,h,i,j,k,m,n,o;if(angular.isFunction(b)){for(e=[],h=0,k=p.length;k>h;h++)d=p[h],e.unshift(d);for(g=function(a){return b(a.scope)?(L(e.length-1-c,e.length-c),I--):void 0},c=i=0,m=e.length;m>i;c=++i)f=e[c],g(f)}else 0<=(o=b-B-1)&&o<p.length&&(L(b-B-1,b-B),I--);for(c=j=0,n=p.length;n>j;c=++j)d=p[c],d.scope.$index=B+c;return l(!1)}),y.$on(\"insert.item\",function(a,b,c){var d,e,f,g,h,i,j,k,m,n,o,q;if(e=[],angular.isFunction(b)){for(f=[],i=0,m=p.length;m>i;i++)c=p[i],f.unshift(c);for(h=function(a){var f,g,h,i,j;if(g=b(a.scope)){if(C=function(a,b){return C(a,b),I++},angular.isArray(g)){for(j=[],f=h=0,i=g.length;i>h;f=++h)c=g[f],j.push(e.push(C(d+f,c)));return j}return e.push(C(d,g))}},d=j=0,n=f.length;n>j;d=++j)g=f[d],h(g)}else 0<=(q=b-B-1)&&q<p.length&&(e.push(C(b,c)),I++);for(d=k=0,o=p.length;o>k;d=++k)c=p[d],c.scope.$index=B+d;return l(!1,e)})}}}}]),angular.module(\"ui.scrollfix\",[]).directive(\"uiScrollfix\",[\"$window\",function(a){return{require:\"^?uiScrollfixTarget\",link:function(b,c,d,e){function f(){var b;if(angular.isDefined(a.pageYOffset))b=a.pageYOffset;else{var e=document.compatMode&&\"BackCompat\"!==document.compatMode?document.documentElement:document.body;b=e.scrollTop}!c.hasClass(\"ui-scrollfix\")&&b>d.uiScrollfix?c.addClass(\"ui-scrollfix\"):c.hasClass(\"ui-scrollfix\")&&b<d.uiScrollfix&&c.removeClass(\"ui-scrollfix\")}var g=c[0].offsetTop,h=e&&e.$element||angular.element(a);d.uiScrollfix?\"string\"==typeof d.uiScrollfix&&(\"-\"===d.uiScrollfix.charAt(0)?d.uiScrollfix=g-parseFloat(d.uiScrollfix.substr(1)):\"+\"===d.uiScrollfix.charAt(0)&&(d.uiScrollfix=g+parseFloat(d.uiScrollfix.substr(1)))):d.uiScrollfix=g,h.on(\"scroll\",f),b.$on(\"$destroy\",function(){h.off(\"scroll\",f)})}}}]).directive(\"uiScrollfixTarget\",[function(){return{controller:[\"$element\",function(a){this.$element=a}]}}]),angular.module(\"ui.showhide\",[]).directive(\"uiShow\",[function(){return function(a,b,c){a.$watch(c.uiShow,function(a){a?b.addClass(\"ui-show\"):b.removeClass(\"ui-show\")})}}]).directive(\"uiHide\",[function(){return function(a,b,c){a.$watch(c.uiHide,function(a){a?b.addClass(\"ui-hide\"):b.removeClass(\"ui-hide\")})}}]).directive(\"uiToggle\",[function(){return function(a,b,c){a.$watch(c.uiToggle,function(a){a?b.removeClass(\"ui-hide\").addClass(\"ui-show\"):b.removeClass(\"ui-show\").addClass(\"ui-hide\")})}}]),angular.module(\"ui.unique\",[]).filter(\"unique\",[\"$parse\",function(a){return function(b,c){if(c===!1)return b;if((c||angular.isUndefined(c))&&angular.isArray(b)){var d=[],e=angular.isString(c)?a(c):function(a){return a},f=function(a){return angular.isObject(a)?e(a):a};angular.forEach(b,function(a){for(var b=!1,c=0;c<d.length;c++)if(angular.equals(f(d[c]),f(a))){b=!0;break}b||d.push(a)}),b=d}return b}}]),angular.module(\"ui.validate\",[]).directive(\"uiValidate\",function(){return{restrict:\"A\",require:\"ngModel\",link:function(a,b,c,d){function e(b){return angular.isString(b)?(a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})}),void 0):angular.isArray(b)?(angular.forEach(b,function(b){a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})})}),void 0):(angular.isObject(b)&&angular.forEach(b,function(b,c){angular.isString(b)&&a.$watch(b,function(){g[c](d.$modelValue)}),angular.isArray(b)&&angular.forEach(b,function(b){a.$watch(b,function(){g[c](d.$modelValue)})})}),void 0)}var f,g={},h=a.$eval(c.uiValidate);h&&(angular.isString(h)&&(h={validator:h}),angular.forEach(h,function(b,c){f=function(e){var f=a.$eval(b,{$value:e});return angular.isObject(f)&&angular.isFunction(f.then)?(f.then(function(){d.$setValidity(c,!0)},function(){d.$setValidity(c,!1)}),e):f?(d.$setValidity(c,!0),e):(d.$setValidity(c,!1),void 0)},g[c]=f,d.$formatters.push(f),d.$parsers.push(f)}),c.uiValidateWatch&&e(a.$eval(c.uiValidateWatch)))}}}),angular.module(\"ui.utils\",[\"ui.event\",\"ui.format\",\"ui.highlight\",\"ui.include\",\"ui.indeterminate\",\"ui.inflector\",\"ui.jq\",\"ui.keypress\",\"ui.mask\",\"ui.reset\",\"ui.route\",\"ui.scrollfix\",\"ui.scroll\",\"ui.scroll.jqlite\",\"ui.showhide\",\"ui.unique\",\"ui.validate\"]);"]}